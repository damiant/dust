import{a as ct}from"./chunk-VBSH35Y7.js";import{a as mt}from"./chunk-3XK6QQO3.js";import{a as dt}from"./chunk-YNP25RQU.js";import{a as st}from"./chunk-TRRH6YG6.js";import"./chunk-W4BNGQYG.js";import{A as at,I as rt,Z as lt,a as nt,f as ot}from"./chunk-2G3SQA7K.js";import{G as tt,H as it,e as Z,j as b}from"./chunk-FZZYZTAK.js";import{a as et}from"./chunk-XMQYHBKU.js";import{$ as m,$a as B,Ac as Y,G as n,I as w,L as T,Ra as E,Sb as V,Tb as L,Ub as N,V as d,Va as D,Vb as R,W as c,Y as F,Z as I,_ as S,_b as $,aa as o,ab as O,ba as a,ca as p,db as U,ea as y,ec as j,fa as x,fc as H,ga as s,gc as z,hc as W,ic as q,oc as J,p as M,pc as K,qc as Q,s as g,sb as G,t as C,ta as l,ua as v,wc as X,xa as k}from"./chunk-LVKFIXIJ.js";import"./chunk-JORYF43P.js";import"./chunk-7KGURMOZ.js";import"./chunk-R7LHOHUY.js";import"./chunk-HUOLUIW7.js";import"./chunk-CCK7OWI7.js";import"./chunk-LIBYTRNP.js";import"./chunk-3MK77LPM.js";import"./chunk-4U6PRYVA.js";import"./chunk-CZ4AHVKD.js";import"./chunk-Z4V4M3ZT.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{a as P,b as A,h}from"./chunk-LNJ3S2LQ.js";function _t(i,e){i&1&&(o(0,"ion-button",2),p(1,"ion-icon",6),a())}function ht(i,e){i&1&&p(0,"app-spinner")}function vt(i,e){if(i&1){let t=y();o(0,"ion-toolbar")(1,"ion-searchbar",11),x("ionInput",function(_){g(t);let u=s(2);return C(u.handleSearch(_))}),a(),o(2,"ion-button",12),x("click",function(){g(t);let _=s(2);return C(_.toggleGrid())}),p(3,"ion-icon",13),a()()}if(i&2){let t=s(2);n(),m("debounce",600)("placeholder","Search burns"),n(2),m("name",t.isGrid?"list-outline":"grid-outline")}}function ft(i,e){i&1&&(o(0,"div",9)(1,"h1"),l(2,"Getting Started"),a(),o(3,"h4",14),l(4," As a regional organizer you can click the button below to create a new regional burn. "),a()())}function ut(i,e){if(i&1&&p(0,"app-img",17),i&2){let t=s().$implicit;m("height","100%")("src",t.imageUrl)}}function gt(i,e){if(i&1){let t=y();o(0,"div",15)(1,"ion-card",16),x("click",function(){let _=g(t).$implicit,u=s(3);return C(u.open("/"+_.vanity))}),d(2,ut,1,2,"app-img",17),o(3,"ion-card-content",18)(4,"h1"),l(5),a()()(),o(6,"ion-text",19),l(7),a()()}if(i&2){let t=e.$implicit;n(2),c(t.imageUrl?2:-1),n(3),v(t.name),n(2),v(t.name)}}function Ct(i,e){if(i&1&&I(0,gt,8,3,"div",15,F),i&2){let t=s(2);S(t.festivals)}}function xt(i,e){i&1&&(o(0,"p"),l(1,"Dates are not known"),a())}function yt(i,e){if(i&1&&(o(0,"p"),l(1),a()),i&2){let t=s().$implicit;n(),k(" ",t.start," - ",t.end," (in ",t.daysUntil," days) ")}}function bt(i,e){if(i&1){let t=y();o(0,"ion-item",21),x("click",function(){let _=g(t).$implicit,u=s(3);return C(u.open("/"+_.vanity))}),p(1,"app-img",22),o(2,"ion-label")(3,"span"),l(4),a(),d(5,xt,2,0,"p")(6,yt,2,3,"p"),a(),o(7,"ion-note",1),l(8),a(),o(9,"ion-note",1),l(10),a()()}if(i&2){let t=e.$implicit,r=s(3);m("ngClass",r.classFor(t)),n(),m("width","45px")("height","45px")("src",t.imageUrl),n(3),v(t.name),n(),c(t.unknown_dates?5:6),n(3),v(t.note),n(2),v(t.active?"In Dust":"Hidden")}}function wt(i,e){if(i&1&&(o(0,"div",10)(1,"ion-card")(2,"ion-list"),I(3,bt,11,8,"ion-item",20,F),a()()()),i&2){let t=s(2);m("ngClass",t.festivals.length>0?"":"pad-vertical"),n(3),S(t.festivals)}}function Ft(i,e){if(i&1&&(d(0,vt,4,3,"ion-toolbar"),o(1,"div",7)(2,"div",8),d(3,ft,5,0,"div",9),d(4,Ct,2,0)(5,wt,5,1,"div",10),a()()),i&2){let t=s();c(t.festivals.length>1||t.filteredBySearch?0:-1),n(3),c(t.noData?3:-1),n(),c(t.isGrid?4:5)}}function It(i,e){i&1&&p(0,"app-footer",5)}var f=class f{constructor(e,t){this.api=e;this.router=t;this.store=M(tt);this.publishing=!1;this.busy=!0;this.addAllowed=!1;this.noData=!1;this.isGrid=!0;this.listArchived=!1;this.buttons=[];this.isNative=et.isNativePlatform();this.filteredBySearch=!1;this.festivals=[];lt({add:nt,listOutline:rt,gridOutline:at,bookOutline:ot})}ngOnInit(){this.isGrid=this.store.get("isFestivalList")!=="false"}ionViewWillEnter(){return h(this,null,function*(){if(!this.api.signedIn()){this.router.navigateByUrl("/auth");return}try{this.busy=!0;let e=sessionStorage.openburn;if(!Z(e)){this.router.navigateByUrl(`/${e}`);return}let t=this.api.getAccessInfo(void 0);this.addAllowed=!1,t.hasAdmin&&(this.addAllowed=!0),!t.hasAdmin&&!t.hasCamps&&!t.hasMusic&&!t.hasArt&&!t.hasCamps&&(this.addAllowed=!0),this.buttons=t.hasAdmin&&!this.listArchived?[{title:"Show Archived",method:this.showArchived(),icon:"book-outline"}]:[],yield this.getData(),this.sort(),this.noData=this.addAllowed&&this.festivals.length==0}finally{this.busy=!1}})}showArchived(){return()=>h(this,null,function*(){this.listArchived=!0,this.buttons=[],yield this.getData(),this.sort()})}handleSearch(e){return h(this,null,function*(){let t=e.target.value.toLowerCase();yield this.getData(t),this.filteredBySearch=t.length>0,this.sort()})}getData(e){return h(this,null,function*(){let t=!this.isGrid;this.festivals=this.asFestivalModels(yield this.api.getFestivals(t)),e&&(this.festivals=this.festivals.filter(r=>r.name.toLowerCase().includes(e))),this.listArchived||(this.festivals=this.festivals.filter(r=>!r.archived)),this.festivals.map(r=>{r.imageUrl=this.api.imageURL(r.imageUrl)}),this.addAllowed})}toggleGrid(){return h(this,null,function*(){this.isGrid=!this.isGrid,this.store.set("isFestivalList",this.isGrid.toString()),yield this.getData(),this.sort()})}open(e){if(e=="new"){this.router.navigateByUrl("../new");return}this.api.clearCache(),this.router.navigateByUrl(e)}asFestivalModels(e){return e.map(t=>A(P({},t),{daysUntil:b(t.start_time),start:this.niceFormat(t.start_time),end:this.niceFormat(t.end_time),note:b(t.start_time)>0?b(t.start_time)+" days":t.archived?"Archived":"Past"}))}niceFormat(e){return new Date(e).toLocaleDateString()}classFor(e){return e.active?"":e.daysUntil<0?"past":"hidden"}sort(){this.isGrid?this.filteredBySearch?this.festivals.sort((e,t)=>e.name.localeCompare(t.name)):this.festivals.sort((e,t)=>e.distance-t.distance):this.festivals.sort((e,t)=>new Date(e.start_time)>new Date(t.start_time)?-1:1)}};f.\u0275fac=function(t){return new(t||f)(w(it),w(B))},f.\u0275cmp=T({type:f,selectors:[["app-festivals"]],decls:11,vars:5,consts:[["color","primary"],["slot","end"],["routerLink","../new"],[3,"buttons"],[3,"fullscreen"],["title","New Regional Burn","routeTo","../new"],["name","add"],[1,"large-border"],[1,"container"],[2,"display","flex","align-items","center","flex-direction","column","justify-content","center","height","70vh"],[1,"ion-text-center",3,"ngClass"],["mode","ios","search-icon","none","show-clear-button","always",3,"ionInput","debounce","placeholder"],["color","dark","fill","clear","slot","end",3,"click"],[3,"name"],[1,"ion-padding","ion-text-center"],[1,"ion-text-center","ion-padding"],["color","light",1,"card",3,"click"],[3,"height","src"],[1,"xcenter"],["color","medium"],[1,"clickable","hoverable",3,"ngClass"],[1,"clickable","hoverable",3,"click","ngClass"],[2,"min-width","45px",3,"width","height","src"]],template:function(t,r){t&1&&(o(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),l(3,"dust"),a(),o(4,"ion-buttons",1),d(5,_t,2,0,"ion-button",2),p(6,"app-side",3),a()()(),o(7,"ion-content",4),d(8,ht,1,0,"app-spinner")(9,Ft,6,3),d(10,It,1,0,"app-footer",5),a()),t&2&&(n(5),c(r.isNative?-1:5),n(),m("buttons",r.buttons),n(),m("fullscreen",!0),n(),c(r.busy?8:9),n(2),c(r.addAllowed?10:-1))},dependencies:[Y,z,q,H,W,J,D,E,mt,st,dt,G,U,O,j,Q,K,L,V,$,X,N,R,ct],styles:[".container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;flex-wrap:wrap}.card[_ngcontent-%COMP%]{width:300px;height:300px;border-radius:10px;flex-basis:40%;cursor:pointer}.hoverable[_ngcontent-%COMP%]:hover{--background: var(--ion-color-light)}.xcenter[_ngcontent-%COMP%]{text-align:center;display:flex;justify-content:center;align-items:center;height:300px}app-img[_ngcontent-%COMP%]{--border-radius: 5px;padding-right:1rem;width:60px}ion-item[_ngcontent-%COMP%]{width:600px;max-width:100vw}.hidden[_ngcontent-%COMP%]{opacity:.5}.past[_ngcontent-%COMP%]{opacity:.75}app-footer[_ngcontent-%COMP%]{--footer-width: 130px}"]});var pt=f;export{pt as FestivalsPage};
