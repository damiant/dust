import{a as $}from"./chunk-VDXUCHAY.js";import{a as Z}from"./chunk-VVJA7NBV.js";import{a as Y}from"./chunk-WRLAXAJB.js";import{Y as Q,g as K,ja as X}from"./chunk-LIWDDRYP.js";import{H as L,K as G,l as q}from"./chunk-5GFD3MFK.js";import"./chunk-PFLI22GG.js";import{Aa as l,Ba as I,Db as V,Ec as z,Fa as x,Fc as R,Ga as v,H as s,Ha as w,Mc as j,Nc as H,P as S,Ua as P,Wb as N,X as g,Y as y,Za as T,ba as f,ca as o,cc as O,da as t,dc as B,ea as p,ec as U,fc as W,ja as C,la as u,lc as J,na as c,p as b,rc as D,s as d,sc as A,t as m,tb as E,vc as F,wb as M}from"./chunk-FDEJMFAU.js";import"./chunk-JORYF43P.js";import"./chunk-7KGURMOZ.js";import"./chunk-UT2PGJWE.js";import"./chunk-6Y2ASLSF.js";import"./chunk-XRJ4SE6F.js";import"./chunk-LIBYTRNP.js";import"./chunk-3MK77LPM.js";import"./chunk-4U6PRYVA.js";import"./chunk-CZ4AHVKD.js";import"./chunk-Z4V4M3ZT.js";import"./chunk-LLZYEWEK.js";import"./chunk-Z2GS73PT.js";import"./chunk-LF5XB4YN.js";import{h}from"./chunk-LNJ3S2LQ.js";function ie(k,a){if(k&1){let e=C();o(0,"app-tooltip",11)(1,"ion-button",12),u("click",function(){d(e);let i=c(2);return m(i.moveUp())}),p(2,"ion-icon",13),l(3,"Move Up"),t(),l(4,"\xA0 "),t(),o(5,"ion-button",14),u("click",function(){d(e);let i=c(2);return m(i.delete())}),l(6,"Delete"),t(),l(7,"\xA0 ")}if(k&2){let e=c(2);s(),f("disabled",e.busy)}}function te(k,a){if(k&1){let e=C();o(0,"div",5)(1,"ion-card")(2,"ion-card-content")(3,"ion-list")(4,"ion-item",6)(5,"ion-input",7),w("ngModelChange",function(i){d(e);let r=c();return v(r.link.title,i)||(r.link.title=i),m(i)}),t()(),o(6,"app-link-input",8),w("modelChange",function(i){d(e);let r=c();return v(r.link.url,i)||(r.link.url=i),m(i)}),u("iconClick",function(){d(e);let i=c();return m(i.openLink())}),t(),o(7,"ion-item")(8,"app-note")(9,"b"),l(10,"Examples"),t(),p(11,"br"),o(12,"code"),l(13,"tel:702100200"),t(),l(14," to call a phone number."),p(15,"br"),o(16,"code"),l(17,"mailto:address"),t(),l(18," to open an email client."),p(19,"br"),o(20,"code"),l(21,"https://google.com"),t(),l(22," to open a browser."),t()()(),o(23,"div",9),g(24,ie,8,1),o(25,"ion-button",10),u("click",function(){d(e);let i=c();return m(i.save())}),l(26,"Save"),t()()()()()}if(k&2){let e=c();s(5),x("ngModel",e.link.title),s(),x("model",e.link.url),s(18),y(e.id?24:-1),s(),f("disabled",e.busy)}}var _=class _{constructor(){this.api=b(G);this.location=b(T);this.vanity=P();this.busy=!0;this.link={id:void 0,title:"",url:""};X({arrowUpOutline:K,openOutline:Q})}ionViewWillEnter(){return h(this,null,function*(){yield this.api.setFestivalByVanity(this.vanity()),this.id=q(this.id),this.link=yield this.api.getLink(this.id),this.busy=!1})}delete(){return h(this,null,function*(){yield this.api.deleteLink(this.link.id),this.api.clearCache(),this.location.back()})}save(){return h(this,null,function*(){if(this.link.title.length<3){this.api.sendMessage("The link title must be set");return}if(this.link.url.length<3){this.api.sendMessage("The link url must be set");return}this.link.url=L(this.link.url),this.busy=!0;try{let a=yield this.api.addLink(this.link);a.message?this.api.sendMessage(a.message):this.location.back()}finally{this.busy=!1}})}moveUp(){return h(this,null,function*(){this.busy=!0;let a=yield this.api.links();console.log("moveup",a);let e=a.findIndex(n=>n.id===this.link.id);if(e!==-1){if(e==0){this.api.sendMessage("The link is the first in the list"),this.busy=!1;return}let n=JSON.parse(JSON.stringify(a[e-1])),i=JSON.parse(JSON.stringify(a[e-1])),r=JSON.parse(JSON.stringify(this.link));n.title=r.title,n.url=r.url,r.title=i.title,r.url=i.url,yield this.api.addLink(r),yield this.api.addLink(n),this.busy=!1,this.location.back()}})}openLink(){if(this.link.url){let a=L(this.link.url);window.open(a,"_blank")}}};_.\u0275fac=function(e){return new(e||_)},_.\u0275cmp=S({type:_,selectors:[["app-link"]],inputs:{vanity:[1,"vanity"],id:"id"},decls:11,vars:3,consts:[["color","primary"],["slot","start"],["slot","end"],[3,"click"],[3,"fullscreen"],[1,"border"],["lines","none"],["label","Title","labelPlacement","stacked","placeholder","Text of the link",3,"ngModelChange","ngModel"],["label","URL","placeholder","URL for the link",3,"modelChange","iconClick","model"],[1,"center"],[3,"click","disabled"],["text","Move higher in the list"],["color","secondary",3,"click","disabled"],["size","small","name","arrow-up-outline"],["color","secondary",3,"click"]],template:function(e,n){e&1&&(o(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),p(3,"ion-back-button"),t(),o(4,"ion-title"),l(5),t(),o(6,"ion-buttons",2)(7,"ion-button",3),u("click",function(){return n.save()}),l(8,"Save"),t()()()(),o(9,"ion-content",4),g(10,te,27,4,"div",5),t()),e&2&&(s(5),I(n.id?"Link":"Add Link"),s(4),f("fullscreen",!0),s(),y(n.busy?-1:10))},dependencies:[j,Y,V,E,M,$,D,R,B,N,z,J,U,W,F,A,H,O,Z],styles:["code[_ngcontent-%COMP%]{color:var(--ion-color-primary)}"]});var ee=_;export{ee as LinkPage};
