import{a as xi}from"./chunk-RSLAJ4X7.js";import{a as fi}from"./chunk-3PGTX6TC.js";import{b as L}from"./chunk-YLPHNW7F.js";import{a as vi}from"./chunk-Q7SRVC5Z.js";import{a as gi}from"./chunk-NIJZXRAZ.js";import{a as hi}from"./chunk-6XV5C437.js";import{a as Ci}from"./chunk-OIMHMYK4.js";import{a as _i}from"./chunk-LKPHKBDT.js";import{a as mi}from"./chunk-5B2MUMUK.js";import"./chunk-OZ2IKH4J.js";import"./chunk-DUKSTT3K.js";import{G as ci,P as pi,R as di,a as si,c as li,ja as ui}from"./chunk-LIWDDRYP.js";import{F as A,J as ri,K as y,e as ai}from"./chunk-5GFD3MFK.js";import"./chunk-PFLI22GG.js";import{$ as I,Aa as m,Ca as x,Db as G,Dc as ii,Ec as ti,Fc as ei,H as o,Ma as v,Mc as ni,P as R,Qc as oi,Ua as V,Wb as $,X as p,Y as d,_a as B,aa as w,ba as a,ca as r,cc as D,da as s,db as O,dc as Y,ea as l,ec as q,fc as j,gc as H,ic as K,ja as F,jb as N,kb as U,l as M,la as k,lc as Q,na as c,nb as z,p as g,rc as J,s as E,sc as W,t as T,vc as X,w as P,yc as Z}from"./chunk-FDEJMFAU.js";import"./chunk-JORYF43P.js";import"./chunk-7KGURMOZ.js";import"./chunk-UT2PGJWE.js";import"./chunk-6Y2ASLSF.js";import"./chunk-XRJ4SE6F.js";import"./chunk-LIBYTRNP.js";import"./chunk-3MK77LPM.js";import"./chunk-4U6PRYVA.js";import"./chunk-CZ4AHVKD.js";import"./chunk-Z4V4M3ZT.js";import"./chunk-LLZYEWEK.js";import"./chunk-Z2GS73PT.js";import"./chunk-LF5XB4YN.js";import{h as _}from"./chunk-LNJ3S2LQ.js";var h=class h{constructor(){this.api=g(y)}exportCampsToCSV(e,i){let n=[];for(let u of i)n.push({id:u.id,name:u.name,description:u.description,email:u.contact_email,placed:u.pin!=""?"Yes":"No"});let C=A(e.toLowerCase()," ","-");L(`${C}-camps.csv`,n)}exportCampsEmail(e,i){let n=[];for(let u of i)ai(u.contact_email)||n.push({email:u.contact_email});if(n.length==0){this.api.sendMessage("No Camps have email addresses to be exported.");return}let C=A(e.toLowerCase()," ","-");L(`${C}-camp-email.txt`,n,{stripQuotes:!0,hideHeaders:!0})}};h.\u0275fac=function(i){return new(i||h)},h.\u0275prov=M({token:h,factory:h.\u0275fac,providedIn:"root"});var b=h;var Ei=t=>[t],S=t=>({camp:t}),bi=(t,e)=>e.id;function Ti(t,e){if(t&1&&l(0,"app-progress-overlay",8),t&2){let i=c();a("title","Inviting...")("progress",i.progress())}}function Pi(t,e){if(t&1){let i=F();r(0,"ion-toolbar")(1,"ion-searchbar",12),k("ionInput",function(C){E(i);let u=c();return T(u.handleSearch(C))}),s(),r(2,"ion-button",13),k("click",function(){E(i);let C=c();return T(C.toggleGrid())}),l(3,"ion-icon",14),s()()}if(t&2){let i=c();o(),a("debounce",600)("placeholder","Search camps at "+i.title),o(2),a("name",i.isGrid?"list-outline":"grid-outline")}}function Ii(t,e){if(t&1&&l(0,"ion-progress-bar",9),t&2){let i=c();a("value",i.progress())}}function wi(t,e){if(t&1&&l(0,"app-card",16),t&2){let i=c(3);a("title",i.filteredBySearch?"No Camps Found":"No Camps")("description",i.filteredBySearch?"No camps found matching that search":"There are no theme camps registered for "+i.festivalTitle)}}function ki(t,e){if(t&1&&p(0,wi,1,2,"app-card",16),t&2){let i=c(2);d(i.camps.length===0?0:-1)}}function Ai(t,e){if(t&1&&(r(0,"app-card",17),l(1,"app-img",19),r(2,"ion-button",20),m(3," Register Camp "),s()()),t&2){let i=c(3);a("description","Camp registration for "+i.festivalTitle+" is open."),o(),a("width","100px")("height","100px")("src",i.imageUrl),o(),a("routerLink",i.newRoute())}}function Li(t,e){if(t&1&&l(0,"app-card",18),t&2){let i=c(3);a("description",i.camps.length===0?"Registration for camps at "+i.festivalTitle+" have been disabled. You cannot register a camp at this time.":"Changes to camps at "+i.festivalTitle+" have been disabled. You cannot make any changes at this time.")}}function Mi(t,e){if(t&1&&p(0,Ai,4,5,"app-card",17)(1,Li,1,1,"app-card",18),t&2){let i=c(2);d(i.camps.length===0&&i.api.campRegistration()?0:!i.api.campRegistration()&&!i.api.campEditing()?1:-1)}}function Ri(t,e){t&1&&(r(0,"ion-button",26),l(1,"ion-icon",31),s())}function Fi(t,e){t&1&&(r(0,"ion-button",27),l(1,"ion-icon",32),s())}function Vi(t,e){if(t&1&&(r(0,"div",22)(1,"ion-card",23),l(2,"app-img",24),r(3,"ion-card-header",25)(4,"ion-card-title"),m(5),p(6,Ri,2,0,"ion-button",26),p(7,Fi,2,0,"ion-button",27),s()(),r(8,"ion-card-content"),m(9),r(10,"div",28)(11,"ion-button",29),m(12,"Edit"),s(),r(13,"ion-button",30),m(14,"Events"),s(),r(15,"ion-button",30),m(16,"Music"),s()()()()()),t&2){let i=e.$implicit,n=c(4);o(2),a("routerLink",n.editRoute(i))("src",n.image(i)),o(),a("routerLink",n.editRoute(i)),o(2),x("",i.name," "),o(),d(i.pin?6:-1),o(),d(n.isAdmin&&i.status===n.ApprovalStatus.Unapproved?7:-1),o(2),x(" ",i.description," "),o(2),a("disabled",!n.canEditCamp)("routerLink","../camp/"+v(15,Ei,i.id)),o(2),a("disabled",!n.canEditEvent)("routerLink","../events")("queryParams",v(17,S,i.id)),o(2),a("disabled",!n.canEditEvent)("routerLink","../music")("queryParams",v(19,S,i.id))}}function Bi(t,e){if(t&1&&(r(0,"div",21),I(1,Vi,17,21,"div",22,bi),s()),t&2){let i=c(3);a("ngClass",i.camps.length>1?"grid":"grid1"),o(),w(i.camps)}}function Oi(t,e){t&1&&l(0,"ion-icon",31)}function Ni(t,e){t&1&&l(0,"ion-icon",37)}function Ui(t,e){if(t&1&&(r(0,"ion-item"),l(1,"app-img",35),r(2,"ion-text",36),m(3),p(4,Oi,1,0,"ion-icon",31),p(5,Ni,1,0,"ion-icon",37),s(),r(6,"div",3)(7,"ion-button",30),m(8,"Events"),s(),r(9,"ion-button",30),m(10,"Music"),s()()()),t&2){let i=e.$implicit,n=c(4);o(),a("width","45px")("height","45px")("routerLink",n.editRoute(i))("src",n.image(i)),o(),a("routerLink",n.editRoute(i)),o(),x(" ",i.name," "),o(),d(i.pin?4:-1),o(),d(n.isAdmin&&i.status===n.ApprovalStatus.Unapproved?5:-1),o(2),a("disabled",!n.canEditEvent)("routerLink","../events")("queryParams",v(14,S,i.id)),o(2),a("disabled",!n.canEditEvent)("routerLink","../music")("queryParams",v(16,S,i.id))}}function zi(t,e){if(t&1&&(r(0,"div",33)(1,"ion-card")(2,"ion-list"),I(3,Ui,11,18,"ion-item",null,bi),s()()(),l(5,"div",34)(6,"div",34)),t&2){let i=c(3);o(3),w(i.camps)}}function Gi(t,e){if(t&1&&p(0,Bi,3,1,"div",21)(1,zi,7,0),t&2){let i=c(2);d(i.isGrid?0:1)}}function $i(t,e){if(t&1&&(r(0,"div",10)(1,"div",15),p(2,ki,1,1)(3,Mi,2,1),s(),p(4,Gi,2,1),s()),t&2){let i=c();o(),a("ngClass",i.camps.length>0?"":"pad-vertical"),o(),d(i.isAdmin?2:3),o(2),d(i.camps.length>0?4:-1)}}function Di(t,e){t&1&&l(0,"app-spinner")}function Yi(t,e){if(t&1&&l(0,"app-footer",11),t&2){let i=c();a("routeTo",i.newRoute())}}var f=class f{constructor(){this.api=g(y);this.router=g(N);this.campService=g(b);this.store=g(ri);this.inviteEmailService=g(xi);this.ApprovalStatus=_i;this.vanity=V();this.camps=[];this.busy=!0;this.isAdmin=!1;this.title="";this.festivalTitle="";this.canRegister=!1;this.canEditCamp=!1;this.canAddCamp=!1;this.canEditEvent=!1;this.filteredBySearch=!1;this.imageUrl="";this.isGrid=!1;this.buttons=[];this.progress=P(0);this.overlayTitle=P("");ui({add:si,locationSharp:di,listOutline:pi,gridOutline:ci,alertCircleSharp:li})}message(e){setTimeout(()=>{this.api.sendMessage(e)},1)}importCSV(){return()=>_(this,null,function*(){if(!this.isAdmin){this.message("You do not have access rights to this feature.");return}this.router.navigateByUrl("./import")})}importKML(){return()=>_(this,null,function*(){if(!this.isAdmin){this.message("You do not have access rights to this feature.");return}this.router.navigateByUrl(`${this.vanity()}/import-kml/camps`)})}exportCSV(){return()=>_(this,null,function*(){if(!this.isAdmin){this.message("You do not have access rights to this feature.");return}this.exportToCSV()})}toggleGrid(){this.isGrid=!this.isGrid,this.store.set("isGrid",`${!this.isGrid}`)}ngOnInit(){return _(this,null,function*(){var e;yield this.api.setFestivalByVanity(this.vanity(),!0),this.title=`${this.api.festivalTitle()}`,this.festivalTitle=this.api.festivalTitle(),this.isAdmin=this.api.isAdmin(this.api.festivalId),this.imageUrl=(e=this.api.imageURL(this.api.festivalImage()))!=null?e:"",this.canAddCamp=this.api.campRegistration()||this.isAdmin,this.canEditCamp=this.api.campRegistration()||this.api.campEditing()||this.isAdmin,this.canEditEvent=this.api.campRegistration()||this.api.eventEditing()||this.isAdmin,this.buttons=this.isAdmin?[{title:"Import CSV",method:this.importCSV(),icon:"cloud-upload-outline"},{title:"Export CSV",method:this.exportCSV(),icon:"cloud-download-outline"},{title:"Export Email Addresses",method:this.exportEmail(),icon:"mail-outline"},{title:"Import KML",method:this.importKML(),icon:"cloud-upload-outline"},{title:"Invite All Theme Camps",method:this.inviteAllCamps(),icon:"mail-outline"}]:[],this.isGrid=this.store.get("isGrid")!=="true"})}inviteAllCamps(){return()=>_(this,null,function*(){if(!this.isAdmin){this.message("You do not have access rights to this feature.");return}yield this.inviteEmailService.inviteAllCamps(this.camps,this.progress)})}exportEmail(){return()=>_(this,null,function*(){this.campService.exportCampsEmail(this.festivalTitle,this.camps)})}ionViewDidEnter(){return _(this,null,function*(){this.camps=yield this.api.camps({cached:!0}),this.filteredBySearch=!1,this.busy=!1})}handleSearch(e){return _(this,null,function*(){let i=e.target.value.toLowerCase(),n=yield this.api.camps({cached:!0});this.camps=n.filter(C=>C.name.toLowerCase().includes(i)),this.filteredBySearch=i.length>0})}editRoute(e){return this.canEditCamp?"../camp/"+e.id:void 0}newRoute(){return this.canEditCamp?"../camp/new":void 0}image(e){return e.imageUrl?this.api.imageURL(e.imageUrl):"./assets/camp.svg"}exportToCSV(){this.campService.exportCampsToCSV(this.festivalTitle,this.camps)}};f.\u0275fac=function(i){return new(i||f)},f.\u0275cmp=R({type:f,selectors:[["app-camps"]],inputs:{vanity:[1,"vanity"]},decls:17,vars:8,consts:[["color","primary"],["slot","start"],["routerLink","../"],["slot","end"],["routerLink","../camp/new",3,"hidden"],["name","add"],[3,"buttons"],[3,"fullscreen"],[3,"title","progress"],[3,"value"],[1,"large-border"],["title","Add Camp",3,"routeTo"],["mode","ios","search-icon","none","show-clear-button","always",3,"ionInput","debounce","placeholder"],["color","dark","fill","clear","slot","end",3,"click"],[3,"name"],[1,"ion-text-center",3,"ngClass"],[3,"title","description"],["title","Registration",3,"description"],["title","Camp Registration",3,"description"],["logo","",1,"logo","ion-padding",3,"width","height","src"],["shape","round",3,"routerLink"],[1,"pad-below",3,"ngClass"],[1,"grid-item"],[1,"clickable"],[3,"routerLink","src"],[3,"routerLink"],["fill","clear","color","light",1,"pin-button"],["fill","clear","color","warning",1,"approval-button"],[1,"dim",2,"text-align","center","padding-top","0.5rem"],["color","secondary",3,"disabled","routerLink"],["color","secondary",3,"disabled","routerLink","queryParams"],["size","small","name","location-sharp",1,"pin"],["size","small","name","alert-circle-sharp"],[1,"border"],[1,"ion-padding"],[1,"clickable",2,"min-width","45px",3,"width","height","routerLink","src"],[1,"clickable",2,"width","100%","padding","1rem",3,"routerLink"],["size","small","color","warning","name","alert-circle-sharp"]],template:function(i,n){i&1&&(r(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),l(3,"ion-back-button"),s(),r(4,"ion-title",2),m(5,"Camps"),s(),r(6,"ion-buttons",3)(7,"ion-button",4),l(8,"ion-icon",5),s(),l(9,"app-side",6),s()()(),r(10,"ion-content",7),p(11,Ti,1,2,"app-progress-overlay",8),p(12,Pi,4,3,"ion-toolbar"),p(13,Ii,1,1,"ion-progress-bar",9),p(14,$i,5,3,"div",10)(15,Di,1,0,"app-spinner"),p(16,Yi,1,1,"app-footer",11),s()),i&2&&(o(7),a("hidden",!n.canAddCamp),o(2),a("buttons",n.buttons),o(),a("fullscreen",!0),o(),d(n.progress()>0?11:-1),o(),d(n.camps.length>1||n.filteredBySearch?12:-1),o(),d(n.progress()>0?13:-1),o(),d(n.busy?15:14),o(2),d(n.isAdmin?16:-1))},dependencies:[ii,oi,Z,Ci,O,B,G,z,U,J,ei,Y,$,ti,D,Q,ni,q,H,K,j,fi,X,W,mi,hi,gi,vi],styles:["ion-card-title[_ngcontent-%COMP%]{font-size:var(--font-size-medium)!important}ion-card-content[_ngcontent-%COMP%]{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-size:var(--font-size-base)}h1[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.pin[_ngcontent-%COMP%]{color:var(--ion-color-primary);opacity:.5}.pin-button[_ngcontent-%COMP%]{position:absolute;margin-top:calc(-1 * var(--spacing-xs))}.approval-button[_ngcontent-%COMP%]{position:absolute;margin-top:calc(-1 * var(--spacing-xs));right:0}.logo[_ngcontent-%COMP%]{--app-background-color: transparent;--border-radius: .5rem}app-img[_ngcontent-%COMP%]{--border-radius: var(--br-xl)}ion-text[_ngcontent-%COMP%]{font-size:var(--font-size-base)}"]});var yi=f;export{yi as CampsPage};
