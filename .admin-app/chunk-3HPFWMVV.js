import{a as st}from"./chunk-EWTSRLY7.js";import{a as lt}from"./chunk-TOSLD3EX.js";import"./chunk-WVEW2PMG.js";import{a as rt}from"./chunk-55PDQDPP.js";import"./chunk-TUKQZ63R.js";import{F as it,N as nt,P as ot,R as C,a as X,h as Y,r as Z,s as tt,z as et}from"./chunk-OAPJ7RFL.js";import{w as Q}from"./chunk-A5NTSXZY.js";import{$ as f,A as L,Aa as g,B as y,Ba as R,I as b,Ka as V,Lb as G,O as P,Pa as _,Qb as H,Rb as $,S as a,Sb as N,T,Tb as j,X as d,Xa as x,Yb as W,cb as A,cc as z,da as p,db as O,dc as U,fc as q,ga as k,gb as D,ia as w,ja as E,ka as l,la as r,ma as s,nc as J,oa as M,oc as K,pa as S,qa as c,sb as B,uc as v}from"./chunk-SLKJQVFW.js";import"./chunk-35XJAIHY.js";import"./chunk-7KGURMOZ.js";import"./chunk-W5R2B4OG.js";import"./chunk-SDKY465T.js";import"./chunk-45ASMX5N.js";import"./chunk-KM5AR3OJ.js";import"./chunk-XCRBEL2Y.js";import"./chunk-4U6PRYVA.js";import"./chunk-HJX2WMCX.js";import"./chunk-Z4V4M3ZT.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{h as F}from"./chunk-LNJ3S2LQ.js";function ft(i,e){if(i&1){let t=M();l(0,"ion-item",2),S("click",function(){L(t);let o=c();return y(o.link(o.url()))}),s(1,"ion-icon",3),g(2),r()}if(i&2){let t=c();a(),p("name",t.icon()),a(),R(t.text())}}function kt(i,e){if(i&1){let t=M();l(0,"div",4),S("click",function(){L(t);let o=c();return y(o.link(o.url()))}),r()}if(i&2){let t=c();p("innerHTML",t.html(),P)}}var m=class m{constructor(){this.text=b("");this.url=b("");this.icon=_(()=>{let e=this.url(),t=this.text();return console.log(e),e.includes("tel:")||e.includes("sms:")?"call-outline":e.includes("mailto:")?"mail-outline":e.includes("maps.")?"compass-outline":e.includes("youtu.")?"tv-outline":t.includes("ticket")?"ticket-outline":"link-outline"});this.simple=_(()=>!this.text().includes("<"));this.html=_(()=>{let e=this.text();return this.removeTagsExceptAllowed(e,["b","h1","h2","h3","h4","code","img","small","br","center","p","i","u","ul","li","ol"])});C({linkOutline:et,compass:Z,compassOutline:tt,callOutline:Y,mailOutline:it,ticketOutline:nt,tvOutline:ot})}link(e){console.log("click",e)}removeTagsExceptAllowed(e,t){let n=t.map(ct).join("|"),o=new RegExp("</?([^>]+)(?:>)(?!</\\1>)","gi");function ct(I){return I.replace(/([\\\/<>+\-*!(){}.^$|\[\]])/g,"\\$&")}return e.replace(o,(I,mt)=>n.includes(mt)?I:"")}};m.\u0275fac=function(t){return new(t||m)},m.\u0275cmp=d({type:m,selectors:[["app-link"]],inputs:{text:[1,"text"],url:[1,"url"]},decls:2,vars:1,consts:[["lines","none","detail","true"],[3,"innerHTML"],["lines","none","detail","true",3,"click"],["slot","start",3,"name"],[3,"click","innerHTML"]],template:function(t,n){t&1&&f(0,ft,3,2,"ion-item",0)(1,kt,1,1,"div",1),t&2&&k(n.simple()?0:1)},dependencies:[v,U,x],encapsulation:2});var h=m;var pt=(i,e)=>e.id,gt=i=>[i];function _t(i,e){if(i&1&&s(0,"app-link",10),i&2){let t=e.$implicit;p("routerLink","../link/"+V(2,gt,t.id))("text",t.title)}}function xt(i,e){if(i&1&&(l(0,"ion-card")(1,"ion-card-content")(2,"ion-list"),w(3,_t,1,4,"app-link",10,pt),r()()()),i&2){let t=e.$implicit;a(3),E(t.links)}}function vt(i,e){if(i&1&&(s(0,"app-image-card",9),w(1,xt,5,0,"ion-card",null,pt)),i&2){let t=c();p("url",t.festivalImage())("title",t.title)("description",t.groups.length===0?"Links are buttons that appear in the dust app that will open a browser window, call a phone number or email.":""),a(),E(t.groups)}}function Ct(i,e){i&1&&s(0,"app-spinner")}var u=class u{constructor(e,t){this.api=e;this.router=t;this.title="";this.busy=!0;this.groups=[];C({add:X})}ionViewWillEnter(){return F(this,null,function*(){this.busy=!0,yield this.api.setFestivalByVanity(this.vanity),this.title=this.api.festivalTitle(),this.groups=this.group(yield this.api.links()),console.log(this.groups),this.busy=!1})}group(e){let t=[],n={id:1,links:[]};for(let o of e)o.title.startsWith("#")&&(o.title=o.title.substring(1),n.links.length>0&&(t.push(n),n={id:n.id+1,links:[]})),n.links.push(o);return t.push(n),t}festivalImage(){return this.api.imageURL(this.api.festivalImage())}};u.\u0275fac=function(t){return new(t||u)(T(Q),T(A))},u.\u0275cmp=d({type:u,selectors:[["app-links"]],inputs:{vanity:"vanity"},decls:14,vars:2,consts:[["color","primary"],["slot","start"],["routerLink","../"],["slot","end"],["routerLink","../link/new"],["name","add"],[3,"fullscreen"],[1,"border"],["title","Add Link","routeTo","../link/new"],["routeTo","../link/new",3,"url","title","description"],[1,"clickable",3,"routerLink","text"]],template:function(t,n){t&1&&(l(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),s(3,"ion-back-button"),r(),l(4,"ion-title",2),g(5,"Links"),r(),l(6,"ion-buttons",3)(7,"ion-button",4),s(8,"ion-icon",5),r()()()(),l(9,"ion-content",6)(10,"div",7),f(11,vt,3,3)(12,Ct,1,0,"app-spinner"),r(),s(13,"app-footer",8),r()),t&2&&(a(9),p("fullscreen",!0),a(2),k(n.busy?12:11))},dependencies:[x,rt,B,D,O,z,K,$,G,J,H,W,v,N,st,j,q,lt,h],styles:["ion-item[_ngcontent-%COMP%]{cursor:pointer}"]});var at=u;export{at as LinksPage};
