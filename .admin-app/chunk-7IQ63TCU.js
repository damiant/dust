import{a as Y}from"./chunk-HSBV6RIN.js";import{a as U}from"./chunk-5EUBO754.js";import{a as X}from"./chunk-OZ2IKH4J.js";import"./chunk-ZHFJF7NS.js";import"./chunk-A5RC3O7B.js";import"./chunk-CVA27SDO.js";import"./chunk-U5OWWBBZ.js";import"./chunk-HC6MZPB3.js";import"./chunk-YMI2B6JE.js";import"./chunk-L4IPHJNS.js";import"./chunk-NPRM7GGH.js";import"./chunk-SFJBRZ2Y.js";import"./chunk-I5V6RRU4.js";import"./chunk-2EOHHFOF.js";import"./chunk-JXIEZMHN.js";import"./chunk-ZMJ3RQA5.js";import"./chunk-MCRJI3T3.js";import"./chunk-QDGYTOUC.js";import"./chunk-VLNXCBKY.js";import"./chunk-MM5QLNJM.js";import"./chunk-3573TPBU.js";import{I as R}from"./chunk-CXIDEVKY.js";import"./chunk-PFLI22GG.js";import{$b as O,Ca as S,Cc as J,Dc as K,Ea as C,Fa as v,G as s,Ga as b,Jc as Q,O as I,Ra as T,Rb as F,W as x,Wa as k,X as w,Yb as N,Zb as W,_b as L,aa as h,ba as i,ca as n,da as _,ec as q,ia as P,ka as y,kc as A,lc as G,ma as d,nc as j,ob as V,p as g,rb as E,s as u,t as f,vc as H,w as M,wb as D,wc as z,yb as B,za as c}from"./chunk-GPCT4GNB.js";import"./chunk-JORYF43P.js";import"./chunk-7KGURMOZ.js";import"./chunk-UT2PGJWE.js";import"./chunk-6Y2ASLSF.js";import"./chunk-XRJ4SE6F.js";import"./chunk-LIBYTRNP.js";import"./chunk-3MK77LPM.js";import"./chunk-4U6PRYVA.js";import"./chunk-CZ4AHVKD.js";import"./chunk-Z4V4M3ZT.js";import"./chunk-LLZYEWEK.js";import"./chunk-Z2GS73PT.js";import"./chunk-LF5XB4YN.js";import{h as p}from"./chunk-LNJ3S2LQ.js";function $(m,o){if(m&1){let e=P();i(0,"div",7)(1,"ion-card",9)(2,"ion-card-content",9)(3,"ion-list",10)(4,"ion-item")(5,"ion-input",11),b("ngModelChange",function(t){u(e);let l=d();return v(l.message.title,t)||(l.message.title=t),f(t)}),n()(),i(6,"ion-item")(7,"ion-textarea",12),b("ngModelChange",function(t){u(e);let l=d();return v(l.message.description,t)||(l.message.description=t),f(t)}),n()()(),i(8,"div",13),c(9),n(),i(10,"div",14)(11,"ion-button",15),y("click",function(){u(e);let t=d();return f(t.send())}),c(12,"Send"),n()()()()()}if(m&2){let e=d();s(5),C("ngModel",e.message.title),s(2),h("counterFormatter",e.customCounterFormatter)("spellcheck",!0)("rows",6)("maxlength",178)("autoGrow",!0),C("ngModel",e.message.description),s(2),S(" This will send a notification to ",e.pushInformation.deviceCount," users who have accepted receiving notifications for ",e.festivalTitle," in the dust app. "),s(2),h("disabled",e.busy())}}function ee(m,o){m&1&&_(0,"app-spinner",8)}var a=class a{constructor(){this.message={title:"",description:""};this.pushInformation={deviceCount:0};this.festivalTitle="";this.busy=M(!1);this.vanity=T();this.api=g(R);this.location=g(k);this.alert=g(Y)}ngOnInit(){return p(this,null,function*(){yield this.api.setFestivalByVanity(this.vanity(),!0),this.festivalTitle=this.api.festivalTitle()})}ionViewWillEnter(){return p(this,null,function*(){let o=yield this.api.getPushInformation();this.pushInformation=o.data})}customCounterFormatter(o,e){return`${e-o} characters remaining`}send(){return p(this,null,function*(){try{if(this.message.title.length==0){this.api.sendMessage("Title is required");return}if(this.message.description.length==0){this.api.sendMessage("Description is required");return}if(!(yield X(this.alert,`Send message "${this.message.title}" to ${this.pushInformation.deviceCount} users ?`,"Send")))return;this.busy.set(!0),yield this.api.sendPushMessage({title:this.message.title,description:this.message.description}),this.location.back(),this.api.sendMessage("Message Sent")}finally{this.busy.set(!1)}})}};a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=I({type:a,selectors:[["app-message"]],inputs:{vanity:[1,"vanity"]},decls:13,vars:2,consts:[["color","primary"],["slot","start"],["routerLink","../"],["slot","end"],[3,"click"],["name","add"],[3,"fullscreen"],[1,"border"],["title","Sending message..."],[1,"form"],["lines","none"],["label","Title","labelPlacement","stacked","placeholder","Title of the message",3,"ngModelChange","ngModel"],["labelPlacement","stacked","label","Description","placeholder","Description of the message",3,"ngModelChange","counterFormatter","spellcheck","rows","maxlength","autoGrow","ngModel"],[1,"padded"],[1,"center"],[3,"click","disabled"]],template:function(e,r){e&1&&(i(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),_(3,"ion-back-button"),n(),i(4,"ion-title",2),c(5,"Notify"),n(),i(6,"ion-buttons",3)(7,"ion-button",4),y("click",function(){return r.send()}),_(8,"ion-icon",5),c(9,"Send"),n()()()(),i(10,"ion-content",6),x(11,$,13,10,"div",7)(12,ee,1,0,"app-spinner",8),n()),e&2&&(s(10),h("fullscreen",!0),s(),w(r.busy()?12:11))},dependencies:[G,j,O,L,J,N,F,K,W,q,A,Q,H,z,B,V,D,E,U],styles:[".padded[_ngcontent-%COMP%]{padding-left:25%;padding-right:25%;text-align:center}"]});var Z=a;export{Z as MessagePage};
