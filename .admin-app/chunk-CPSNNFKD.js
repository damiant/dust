import{a as lt}from"./chunk-INZF7S5A.js";import{a as st}from"./chunk-XGEMISMR.js";import{a as ge}from"./chunk-HSBV6RIN.js";import{a as ct}from"./chunk-SAXSOE4W.js";import{a as rt}from"./chunk-GKO5FLMM.js";import{a as ot}from"./chunk-5EUBO754.js";import{a as at,c as B}from"./chunk-OZ2IKH4J.js";import"./chunk-ZHFJF7NS.js";import"./chunk-A5RC3O7B.js";import"./chunk-CVA27SDO.js";import"./chunk-U5OWWBBZ.js";import"./chunk-HC6MZPB3.js";import"./chunk-YMI2B6JE.js";import"./chunk-L4IPHJNS.js";import"./chunk-NPRM7GGH.js";import"./chunk-SFJBRZ2Y.js";import"./chunk-I5V6RRU4.js";import"./chunk-2EOHHFOF.js";import"./chunk-JXIEZMHN.js";import"./chunk-ZMJ3RQA5.js";import"./chunk-MCRJI3T3.js";import"./chunk-QDGYTOUC.js";import"./chunk-VLNXCBKY.js";import"./chunk-MM5QLNJM.js";import"./chunk-3573TPBU.js";import{F as it,G as nt,aa as _e,b as Xe,m as et,q as tt}from"./chunk-TF5OT4X3.js";import{I as he,a as Ye,b as Ie,e as pe,l as Se,m as A,o as Pe,p as Le,q as Ke,r as $e,t as b,v as Ge,y as q}from"./chunk-CXIDEVKY.js";import"./chunk-PFLI22GG.js";import{$ as k,$b as qe,Aa as S,Ac as Qe,Cc as me,Dc as de,Ea as M,Fa as C,G as c,Ga as y,Hc as Ze,Ic as ue,Jc as He,O as L,Oa as E,Pa as X,Qa as R,Ra as D,Rb as ze,S as Ee,Sa as Be,Sb as ee,Ta as F,W as w,Wa as Fe,X as T,Yb as te,Z as $,Zb as ie,_ as V,_b as Je,aa as _,ba as s,ca as r,da as x,db as Ae,ec as ne,ia as g,jb as je,ka as h,kc as oe,lc as W,ma as l,mc as ae,nc as re,ob as z,p as I,qa as Me,ra as ve,rb as J,rc as Ue,s as m,sa as be,sc as se,t as d,ta as Oe,ua as Ve,vc as ce,w as v,wa as ke,wb as Re,wc as le,xa as Ne,ya as We,yb as N,za as u}from"./chunk-GPCT4GNB.js";import"./chunk-JORYF43P.js";import"./chunk-7KGURMOZ.js";import"./chunk-UT2PGJWE.js";import"./chunk-6Y2ASLSF.js";import"./chunk-XRJ4SE6F.js";import"./chunk-LIBYTRNP.js";import"./chunk-3MK77LPM.js";import"./chunk-4U6PRYVA.js";import"./chunk-CZ4AHVKD.js";import"./chunk-Z4V4M3ZT.js";import"./chunk-LLZYEWEK.js";import"./chunk-Z2GS73PT.js";import"./chunk-LF5XB4YN.js";import{h as P}from"./chunk-LNJ3S2LQ.js";function pt(a,t){if(a&1){let e=g();s(0,"ion-header")(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),h("click",function(){m(e);let i=l();return d(i.cancel())}),u(4,"Cancel"),r()(),s(5,"ion-title"),u(6,"Import"),r(),s(7,"ion-buttons",4)(8,"ion-button",5),h("click",function(){m(e);let i=l();return d(i.confirm())}),u(9,"Convert"),r()()()(),s(10,"ion-content",6)(11,"ion-item")(12,"ion-textarea",7),y("ngModelChange",function(i){m(e);let o=l();return C(o.text,i)||(o.text=i),d(i)}),r()(),s(13,"ion-item"),x(14,"ion-textarea",8),r()()}if(a&2){let e=l();c(8),_("strong",!0),c(4),M("ngModel",e.text),c(2),_("value",e.prompt)}}var U=class U{constructor(){this.text="";this.modal=Be.required(ee);this.isOpen=F(!1);this.occurrences=v([]);this.imported=R();this.alert=I(ge);this.prompt="Convert this to a JSON array an artist, startDate in iso date format, endDate in iso date format where endDate is 1 hour after startDate if the endDate is missing. Thursday is February 13 2025. Also convert the artist to title case. Finally, only list items that are on thursday"}cancel(){this.modal().dismiss(null,"cancel")}confirm(){this.validate(this.text)&&this.modal().dismiss(this.text,"confirm")}onWillDismiss(t){t.detail.role==="confirm"&&this.imported.emit(this.occurrences()),this.isOpen.set(!1)}validate(t){let e=JSON.parse(t);if(!Array.isArray(e))return B(this.alert,"Data is not an array"),!1;if(e.length===0)return B(this.alert,"Data is empty"),!1;let n=[],i=1;for(let o of e){if(pe(o.artist))return B(this.alert,"Artist is required"),!1;if(pe(o.startDate))return B(this.alert,"Start date is required"),!1;if(!Ie(o.startDate))return B(this.alert,`Invalid start date "${o.startDate}"`),!1;if(pe(o.endDate))return B(this.alert,"End date is required"),!1;if(!Ie(o.endDate))return B(this.alert,`Invalid end date "${o.endDate}"`),!1;n.push({id:i.toString(),who:o.artist,startTime:b(o.startDate),endTime:b(o.endDate)}),i++}return this.occurrences.set(n),!0}};U.\u0275fac=function(e){return new(e||U)},U.\u0275cmp=L({type:U,selectors:[["app-music-import"]],viewQuery:function(e,n){e&1&&Oe(n.modal,ee,5),e&2&&Ve()},inputs:{isOpen:[1,"isOpen"]},outputs:{isOpen:"isOpenChange",imported:"imported"},decls:2,vars:1,consts:[[3,"willDismiss","isOpen"],["color","primary"],["slot","start"],[3,"click"],["slot","end"],[3,"click","strong"],[1,"ion-padding"],["rows","15","placeholder","",3,"ngModelChange","ngModel"],["rows","4",3,"value"]],template:function(e,n){e&1&&(s(0,"ion-modal",0),h("willDismiss",function(o){return n.onWillDismiss(o)}),Ee(1,pt,15,3,"ng-template"),r()),e&2&&_("isOpen",n.isOpen())},dependencies:[ne,te,ee,oe,ie,ce,le,He,W,N,z,J],encapsulation:2});var fe=U;var ht=(a,t)=>t.uid;function _t(a,t){if(a&1){let e=g();s(0,"ion-item",2),h("click",function(){let i=m(e).$implicit,o=l();return d(o.onEntryClick(i))}),s(1,"ion-label"),u(2),r()()}if(a&2){let e=t.$implicit;c(2),S(e.name)}}function gt(a,t){a&1&&(s(0,"ion-item")(1,"ion-label",3),u(2,"No entries found"),r()())}var Q=class Q{constructor(){this.searchText=D("");this.entries=D([]);this.entrySelected=R();this.show=F(!1);this.filteredEntries=E(()=>{let t=this.searchText().toLowerCase().trim();if(!t)return this.entries().slice(0,10);let e=this.entries(),n=[];for(let i=0;i<e.length&&n.length<10;i++){let o=e[i];o.name.toLowerCase().includes(t)&&n.push(o)}return n})}onEntryClick(t){this.entrySelected.emit(t),this.show.set(!1),setTimeout(()=>{this.show.set(!1)},100)}};Q.\u0275fac=function(e){return new(e||Q)},Q.\u0275cmp=L({type:Q,selectors:[["app-auto-complete"]],inputs:{searchText:[1,"searchText"],entries:[1,"entries"],show:[1,"show"]},outputs:{entrySelected:"entrySelected",show:"showChange"},decls:5,vars:3,consts:[[1,"wrap"],["button",""],["button","",3,"click"],["color","medium"]],template:function(e,n){e&1&&(s(0,"div",0)(1,"ion-list"),V(2,_t,3,1,"ion-item",1,ht,!1,gt,3,0,"ion-item"),r()()),e&2&&(ke("display",n.show()?"block":"none"),c(2),k(n.filteredEntries()))},dependencies:[re,ae,W,N],styles:[".wrap[_ngcontent-%COMP%]{border:1px solid var(--ion-color-dark-contrast);box-shadow:#0000003d 0 3px 8px;padding:0;margin:.5rem;width:400px;position:absolute;z-index:1001}"],changeDetection:0});var we=Q;var Z=class Z{constructor(){this.position=D("left");this.title=D("message");this.short=D("title");this.url=D(void 0);this.api=I(he);_e({informationCircle:it,informationCircleOutline:nt})}showMessage(){this.api.sendMessage(this.title(),0,this.short(),this.url())}};Z.\u0275fac=function(e){return new(e||Z)},Z.\u0275cmp=L({type:Z,selectors:[["app-tip-button"]],inputs:{position:[1,"position"],title:[1,"title"],short:[1,"short"],url:[1,"url"]},decls:1,vars:2,consts:[["color","tertiary","name","information-circle",3,"click"]],template:function(e,n){e&1&&(s(0,"ion-icon",0),h("click",function(){return n.showMessage()}),r()),e&2&&We(n.position())},dependencies:[me],styles:["ion-icon[_ngcontent-%COMP%]{position:absolute;font-size:24px;margin-left:-32px;z-index:1000;cursor:pointer}.bottom[_ngcontent-%COMP%]{margin-left:-40px;margin-top:10px}.middle[_ngcontent-%COMP%]{margin-left:-40px;margin-top:-10px}"]});var H=Z;function ft(a,t){if(a&1){let e=g();s(0,"ion-item",7)(1,"ion-input",10),h("keypress",function(){m(e);let i=l();return d(i.onKeyPress())})("ionBlur",function(){m(e);let i=l();return d(i.onBlur())}),y("ngModelChange",function(i){m(e);let o=l();return C(o.location,i)||(o.location=i),d(i)}),r(),x(2,"app-tip-button",11),r()}if(a&2){let e=l();c(),_("placeholder",e.placeholder())("value",e.location()),M("ngModel",e.location)}}function Ct(a,t){if(a&1&&(s(0,"ion-item",9)(1,"p",12),u(2),r()()),a&2){let e=l();c(),Ne("error",e.locationProblem()),c(),S(e.locationTip())}}function yt(a,t){if(a&1&&(s(0,"ion-select-option",14),u(1),r()),a&2){let e=t.$implicit;_("value",e),c(),S(e)}}function wt(a,t){if(a&1){let e=g();s(0,"ion-select",13),h("ionChange",function(){m(e);let i=l();return d(i.onBlur())}),y("ngModelChange",function(i){m(e);let o=l();return C(o.location,i)||(o.location=i),d(i)}),V(1,yt,2,2,"ion-select-option",14,$),r(),s(3,"p",15),u(4,` "Roaming" is used for mutant vehicles or events not located at a camp or art.
`),r()}if(a&2){let e=l();_("value",e.location),M("ngModel",e.location),c(),k(e.altLocations)}}function Tt(a,t){if(a&1&&(s(0,"ion-item",0)(1,"ion-label",1),u(2),r()()),a&2){let e,n=l();c(2),S(((e=n.rslLocation())==null?null:e.type)==="mutant"?"Mutant Vehicle":"Mutant Vehicle / Name")}}function xt(a,t){if(a&1){let e=g();s(0,"ion-item",0)(1,"ion-checkbox",16),h("ngModelChange",function(){m(e);let i=l();return d(i.emit())}),y("ngModelChange",function(i){m(e);let o=l();return C(o.mutantVehicle,i)||(o.mutantVehicle=i),d(i)}),u(2,"Mutant Vehicle"),r()()}if(a&2){let e=l();c(),M("ngModel",e.mutantVehicle)}}function Mt(a,t){if(a&1){let e=g();s(0,"ion-item",7)(1,"ion-input",17),h("ionBlur",function(){m(e);let i=l();return d(i.onBlur())}),y("ngModelChange",function(i){m(e);let o=l();return C(o.artCar,i)||(o.artCar=i),d(i)}),r()()}if(a&2){let e=l();c(),M("ngModel",e.artCar)}}var Y=class Y{constructor(){this.ttitdService=I(lt);this.locationType=v("");this.showAutoComplete=!1;this.altLocations=["On The Playa","Deep Playa","Center Camp","Gate","DMZ","Airport","The Man","The Temple","Trash Fence","Inner Playa @ 10:15","Inner Playa @ 10:30","Inner Playa @ 10:45","Inner Playa @ 11:00","Inner Playa @ 11:15","Inner Playa @ 11:30","Inner Playa @ 11:45","Inner Playa @ 12:00","Inner Playa @ 12:15","Inner Playa @ 12:30","Inner Playa @ 12:45","Inner Playa @ 1:00","Inner Playa @ 1:15","Inner Playa @ 1:30","Inner Playa @ 1:45","Outer Playa @ 10:15","Outer Playa @ 10:30","Outer Playa @ 10:45","Outer Playa @ 11:00","Outer Playa @ 11:15","Outer Playa @ 11:30","Outer Playa @ 11:45","Outer Playa @ 12:00","Outer Playa @ 12:15","Outer Playa @ 12:30","Outer Playa @ 12:45","Outer Playa @ 1:00","Outer Playa @ 1:15","Outer Playa @ 1:30","Outer Playa @ 1:45","Trash Fence @ 10:15","Trash Fence @ 10:30","Trash Fence @ 10:45","Trash Fence @ 11:00","Trash Fence @ 11:15","Trash Fence @ 11:30","Trash Fence @ 11:45","Trash Fence @ 12:00","Trash Fence @ 12:15","Trash Fence @ 12:30","Trash Fence @ 12:45","Trash Fence @ 1:00","Trash Fence @ 1:15","Trash Fence @ 1:30","Trash Fence @ 1:45"];this.rslLocation=F(void 0);this.placeholder=E(()=>{switch(this.locationType()){case"camp":return"Enter camp name";case"art":return"Enter art name";case"mutant":return"Enter mutant vehicle name";default:return"Enter location"}});this.location=v("");this.artCar=v("");this.mutantVehicle=v(!1);this.locationUid=v("");this.locationError=F("");this.locationProblem=v(!1);this.locationSelected=R();this.ready=!1;this.locationTip=E(()=>this.locationProblem()?`A ${this.locationType()} has not been selected from the list.`:"Begin typing a name then select from the list (sourced from Burning Man).");this.lastType="";this.entries=E(()=>{if(!this.ttitdService.initialized())return[];let e=this.locationType();return e==="camp"?this.ttitdService.camps.map(n=>({uid:n.uid,name:n.name})):e==="art"?this.ttitdService.art.map(n=>({uid:n.uid,name:n.name})):[]});X(()=>{let t=this.locationType();this.ready&&t!==""&&(this.lastType!==t&&(this.location.set(""),this.locationUid.set(""),this.lastType=t),t=="mutant"?this.mutantVehicle.set(!0):this.artCar()===""&&this.mutantVehicle.set(!1))}),X(()=>{let t=this.rslLocation();t&&(this.ready=!1,this.locationType.set(t.type),setTimeout(()=>{if(!t||(t.name==""&&this.location()?(t.name=this.location(),this.rslLocation.set(t),t=this.rslLocation()):this.location.set(t.name),!t))return;console.log(`Location "${this.location()}" ${JSON.stringify(t)} id set to ${this.locationUid()}`),this.locationUid.set(t.uid);let e=t.artCar!==""&&t.artCar!==void 0||t.type==="mutant";this.mutantVehicle.set(e),this.artCar.set(t.artCar||""),this.ready=!0},10))}),X(()=>{let t=this.locationType();this.locationError.set(""),t==="camp"&&this.locationUid()===""&&this.locationError.set("You must select a camp from the list."),t==="art"&&this.locationUid()===""&&this.locationError.set("You must select art from the list."),t==="mutant"&&this.artCar()===""&&this.locationError.set("You must enter a mutant vehicle name."),this.mutantVehicle()&&this.artCar()===""&&this.locationError.set("You must enter a mutant vehicle name.")})}ngOnInit(){return P(this,null,function*(){yield this.ttitdService.init(),this.locationType()===""&&(this.locationType.set("camp"),this.ready=!0)})}onKeyPress(){this.showAutoComplete=!0}selectItem(t){this.location.set(t.name),this.locationUid.set(t.uid),this.locationError.set(""),this.emit()}onBlur(){setTimeout(()=>{this.showAutoComplete=!1},200),this.emit(),this.locationType()!=="mutant"&&setTimeout(()=>{this.locationProblem.set(this.locationUid()===""&&this.location()!=="")},200)}emit(){this.locationSelected.emit({uid:this.locationUid(),name:this.location(),type:this.locationType(),artCar:this.artCar()})}};Y.\u0275fac=function(e){return new(e||Y)},Y.\u0275cmp=L({type:Y,selectors:[["app-music-location"]],inputs:{rslLocation:[1,"rslLocation"],locationError:[1,"locationError"]},outputs:{rslLocation:"rslLocationChange",locationError:"locationErrorChange",locationSelected:"locationSelected"},decls:22,vars:10,consts:[["lines","none",1,"loc2"],[1,"lab-loc"],["mode","ios","value","camp",3,"ngModelChange","ngModel"],["value","camp"],["value","art"],["value","mutant"],[1,"w"],["lines","none",1,"loc3"],[3,"entrySelected","show","entries","searchText"],["lines","none",1,"tip","loc3"],["labelPlacement","stacked",1,"loc",3,"keypress","ionBlur","ngModelChange","placeholder","value","ngModel"],["short","Location","title","As you type a name be sure to select the name of the camp/art from the list of registered Burning Man camps and art. Clock locations will be added by us. The names of camps and art are set when registering with Burning Man (contact campsupport@burningman.org for changes)","position","middle"],[1,"pad-left"],["labelPlacement","stacked","interface","popover","placeholder","Select the location",1,"app-select",3,"ionChange","ngModelChange","value","ngModel"],[3,"value"],[1,"m-t","pad-left"],["justify","start",3,"ngModelChange","ngModel"],["labelPlacement","stacked","placeholder","Enter mutant vehicle name",1,"loc",3,"ionBlur","ngModelChange","ngModel"]],template:function(e,n){e&1&&(s(0,"ion-item",0)(1,"ion-label",1),u(2,"Location"),r()(),s(3,"ion-item",0)(4,"ion-segment",2),y("ngModelChange",function(o){return C(n.locationType,o)||(n.locationType=o),o}),s(5,"ion-segment-button",3)(6,"ion-label"),u(7,"Camp"),r()(),s(8,"ion-segment-button",4)(9,"ion-label"),u(10,"Art"),r()(),s(11,"ion-segment-button",5)(12,"ion-label"),u(13,"Roaming"),r()()(),x(14,"div",6),r(),w(15,ft,3,3,"ion-item",7),s(16,"app-auto-complete",8),h("entrySelected",function(o){return n.selectItem(o)}),r(),w(17,Ct,3,3,"ion-item",9),w(18,wt,5,2),w(19,Tt,3,1,"ion-item",0),w(20,xt,3,1,"ion-item",0),w(21,Mt,2,1,"ion-item",7)),e&2&&(c(4),M("ngModel",n.locationType),c(11),T(n.locationType()!=="mutant"?15:-1),c(),_("show",n.showAutoComplete)("entries",n.entries())("searchText",n.location()),c(),T(n.locationType()!=="mutant"?17:-1),c(),T(n.locationType()==="mutant"?18:-1),c(),T(n.locationType()==="mutant"?19:-1),c(),T(n.locationType()!=="mutant"?20:-1),c(),T(n.mutantVehicle()?21:-1))},dependencies:[Qe,W,de,ae,Ue,Ze,ue,se,N,z,J,we,H],styles:[".pad[_ngcontent-%COMP%]{padding:8px}.pad[_ngcontent-%COMP%]{padding:16px}.pad-left[_ngcontent-%COMP%]{padding-left:1rem}@media screen and (min-width: 800px){.w[_ngcontent-%COMP%]{width:100%}}.loc[_ngcontent-%COMP%]{margin-top:-16px}.lab-loc[_ngcontent-%COMP%]{margin-bottom:-8px}.error[_ngcontent-%COMP%]{color:red}.loc2[_ngcontent-%COMP%]{margin-left:-8px}.loc3[_ngcontent-%COMP%]{margin-left:-16px}.tip[_ngcontent-%COMP%]{opacity:.6;margin-top:-10px}.m-t[_ngcontent-%COMP%]{margin-top:10px}"]});var Te=Y;var vt=["musicContent"],bt=["musician"],It=(a,t)=>t.id;function St(a,t){if(a&1){let e=g();s(0,"ion-button",9),h("click",function(){m(e);let i=l();return d(i.showImport.set(!0))}),x(1,"ion-icon",10),r()}}function Pt(a,t){if(a&1){let e=g();s(0,"app-music-location",25),y("rslLocationChange",function(i){m(e);let o=l(2);return C(o.rslLocation,i)||(o.rslLocation=i),d(i)}),h("locationSelected",function(i){m(e);let o=l(2);return d(o.locationSelected(i))}),y("locationErrorChange",function(i){m(e);let o=l(2);return C(o.locationError,i)||(o.locationError=i),d(i)}),r()}if(a&2){let e=l(2);M("rslLocation",e.rslLocation)("locationError",e.locationError)}}function Lt(a,t){if(a&1&&(s(0,"ion-select-option",27),u(1),r()),a&2){let e=t.$implicit;_("value",e.id),c(),S(e.name)}}function Dt(a,t){if(a&1){let e=g();s(0,"ion-item",13)(1,"ion-select",26),y("ngModelChange",function(i){m(e);let o=l(2);return C(o.music.campId,i)||(o.music.campId=i),d(i)}),V(2,Lt,2,2,"ion-select-option",27,$),r()()}if(a&2){let e=l(2);c(),_("value",e.music.campId),M("ngModel",e.music.campId),c(),k(e.camps)}}function Et(a,t){if(a&1&&(s(0,"ion-select-option",27),u(1),r()),a&2){let e=l().$implicit;_("value",e),c(),S(e)}}function Ot(a,t){if(a&1&&w(0,Et,2,2,"ion-select-option",27),a&2){let e=t.$implicit,n=l(3);T(n.categoryHidden(e)?-1:0)}}function Vt(a,t){if(a&1){let e=g();s(0,"ion-item",13)(1,"ion-select",28),y("ngModelChange",function(i){m(e);let o=l(2);return C(o.music.musicType,i)||(o.music.musicType=i),d(i)}),h("ionChange",function(i){m(e);let o=l(2);return d(o.musicTypeChanged(i))}),V(2,Ot,1,1,null,null,$),r(),x(4,"app-tip-button",29),r(),s(5,"ion-item",13)(6,"p",17),u(7),r()()}if(a&2){let e=l(2);c(),_("multiple",!0)("value",e.music.musicType),M("ngModel",e.music.musicType),c(),k(e.musicTypes),c(5),S(e.categoryWarning())}}function kt(a,t){if(a&1){let e=g();s(0,"ion-item",14)(1,"app-emails",30),y("emailsChange",function(i){m(e);let o=l(2);return C(o.music.contact,i)||(o.music.contact=i),d(i)}),r(),x(2,"app-tip-button",31),r()}if(a&2){let e=l(2);c(),_("isAdmin",e.isAdmin)("isOwner",e.isOwner)("label","Owners")("placeholder","Email address"),M("emails",e.music.contact)}}function Nt(a,t){if(a&1){let e=g();s(0,"div",18)(1,"div",32)(2,"ion-input",33,1),y("ngModelChange",function(i){let o=m(e).$implicit;return C(o.who,i)||(o.who=i),d(i)}),r(),x(4,"app-tooltip",34),r(),s(5,"app-date-range",35),h("endChanged",function(i){let o=m(e).$implicit,p=l(2);return d(p.endChanged(o,i))})("startChanged",function(i){let o=m(e).$implicit,p=l(2);return d(p.startChanged(o,i))}),r(),s(6,"div",36)(7,"ion-button",37),h("click",function(){let i=m(e).$implicit,o=l(2);return d(o.deleteItem(i))}),x(8,"ion-icon",38),r()()()}if(a&2){let e=t.$implicit,n=l(2);c(2),_("label",n.musicianLabel()),M("ngModel",e.who),c(3),_("longDurations",!0)("minTime",n.minTime)("maxTime",n.maxTime)("id",e.id)("startTime",e.startTime)("endTime",e.endTime),c(2),_("hidden",n.occurrences.length===1)}}function Wt(a,t){if(a&1){let e=g();s(0,"ion-button",39),h("click",function(){m(e);let i=l(2);return d(i.deleteParty())}),u(1,"Delete"),r()}}function Bt(a,t){a&1&&(s(0,"ion-button",5),u(1,"\xA0"),r())}function Ft(a,t){if(a&1){let e=g();s(0,"div",8)(1,"app-music-import",11),h("imported",function(i){m(e);let o=l();return d(o.imported(i))}),r(),s(2,"ion-card")(3,"ion-card-content")(4,"ion-list"),w(5,Pt,1,2,"app-music-location",12)(6,Dt,4,2,"ion-item",13),w(7,Vt,8,4),s(8,"ion-item",14)(9,"ion-input",15),y("ngModelChange",function(i){m(e);let o=l();return C(o.music.title,i)||(o.music.title=i),d(i)}),r(),x(10,"app-tip-button",16),r(),s(11,"ion-item",13)(12,"p",17),u(13," Only provide a theme if applicable (do not use no day or date). "),r()(),w(14,kt,3,5,"ion-item",14),V(15,Nt,9,9,"div",18,It),r(),s(17,"div",19),w(18,Wt,2,0,"ion-button",20)(19,Bt,2,0,"ion-button",5),s(20,"ion-button",21),h("click",function(){m(e);let i=l();return d(i.save())}),u(21,"Save"),r(),s(22,"app-tooltip",22)(23,"ion-button",23),h("click",function(){m(e);let i=l();return d(i.addItem())}),u(24,"Add time slot"),r()()()()(),x(25,"div",24),r()}if(a&2){let e=l();c(),_("isOpen",e.showImport()),c(4),T(e.ttitd?5:6),c(2),T(e.ttitd?7:-1),c(2),M("ngModel",e.music.title),c(5),T(e.isAdmin?14:-1),c(),k(e.occurrences),c(3),T((e.isAdmin||e.isOwner)&&e.music.id?18:19),c(2),_("disabled",e.saving),c(3),_("disabled",e.saving)}}function At(a,t){a&1&&x(0,"app-spinner")}var K=class K{constructor(){this.api=I(he);this.route=I(Ae);this.alert=I(ge);this.location=I(Fe);this.busy=!0;this.ttitd=!1;this.vanity=D();this.showImport=v(!1);this.camps=[];this.minTime=new Date().toISOString();this.maxTime=new Date().toISOString();this.isOwner=!1;this.isAdmin=!1;this.saving=!1;this.musicTypes=[];this.timezone=this.api.currentTimeZone();this.music={id:void 0,camp:"",location:"",day:"",occurrences:"[]"};this.occurrences=[];this.locationError=v("");this.isNew=!1;this.categoryWarning=E(()=>this.liveMusic()?"Note: A DJ with or without vocals is not considered Live Music.":"Leave categories blank if none are applicable.");this.musicianLabel=E(()=>this.liveMusic()?"Musician / Band":"DJ / Musician");this.liveMusic=v(!1);_e({closeOutline:tt,addOutline:Xe,chevronDown:et})}ionViewWillEnter(){return P(this,null,function*(){var n,i;yield this.api.setFestivalByVanity(this.vanity()),this.id=Se(this.id),this.isNew=!this.id;let t=yield this.api.getFestival(this.api.festivalId,{cached:!0});this.ttitd=t.music_registration&&this.hasMusicRegistration(t.vanity)&&this.isRSLOrTest(t.name),this.musicTypes=((n=t.music_types)==null?void 0:n.split(`
`))||[],this.isNew?(this.music=yield this.api.newMusic(),console.log("new music with camp",this.route.snapshot.queryParams.camp),this.music.campId=Se(this.route.snapshot.queryParams.camp)):(this.music=yield this.api.getMusic(this.id),this.music.musicType=this.music.musicType?this.music.musicType.split(","):"",this.ttitd&&this.extractLocation(this.music));let e=this.api.getAccessInfo(t.id);if(this.liveMusic.set(!!((i=this.music.musicType)!=null&&i.includes("Live Music"))),this.isOwner=this.music&&e.music.includes(this.music.id)||this.isNew,this.isAdmin=this.api.isAdmin(t.id),this.timezone=t.timezone,this.timezone||(this.timezone=this.api.currentTimeZone()),this.minTime=t.start_time,this.maxTime=b(Pe(A(t.end_time),12).toISOString()),this.occurrences=JSON.parse(this.music.occurrences),this.occurrences.length==0){let o=this.defaultDay();this.occurrences.push({who:"",id:"1",startTime:o,endTime:b(Pe(A(o),1).toISOString())})}for(let o of this.occurrences)o.startTime=b(o.startTime),o.endTime=b(o.endTime);this.busy=!1})}isRSLOrTest(t){return t.toLowerCase().includes("librarian")||t.toLowerCase().includes("electrk")}defaultDay(){try{let t=this.route.snapshot.queryParams.nextDay;if(t){let e=new Date(t+"T00:00:00"),n=b(e.toISOString()),i=new Date(this.minTime),o=new Date(this.maxTime);if(e>=i&&e<=o)return n}return this.minTime}catch{return this.minTime}}musicTypeChanged(t){this.liveMusic.set(t.detail.value.includes("Live Music")),t.detail.value.includes("Mutant Vehicle")&&this.rslLocation&&this.locationSelected(this.rslLocation)}hasMusicRegistration(t){return!!(t.toLowerCase().includes("librarian")||t.toLowerCase().includes("forest"))}ngOnInit(){return P(this,null,function*(){this.camps=yield this.api.camps({cached:!0})})}categoryHidden(t){return this.isAdmin?!1:t.startsWith("_")}lastTime(){let t=this.minTime;for(let e of this.occurrences)t=e.endTime;return t}deleteParty(){return P(this,null,function*(){(yield at(this.alert,"Are you sure you want to delete this party?"))&&(yield this.api.deleteParty(this.music.id),this.api.clearCache(),this.location.back())})}deleteItem(t){this.occurrences.length!=1&&(this.occurrences=this.occurrences.filter(e=>e.id!==t.id))}addItem(){return P(this,null,function*(){let t=yield this.badTimeSlot(this.music,this.occurrences,!1);if(t){this.api.sendMessage(t);return}let e=this.lastTime(),n=this.occurrences.length>0?this.getDuration(this.occurrences[this.occurrences.length-1]):60;this.occurrences.push({who:"",id:(this.occurrences.length+1).toString(),startTime:e,endTime:b(Le(A(e),n).toISOString())}),setTimeout(()=>{this.musicContent.scrollToBottom(200),this.focusMusician()},100)})}focusMusician(){var t;(t=this.musicians.get(this.musicians.length-1))==null||t.setFocus()}getDuration(t){let e=A(t.startTime),n=A(t.endTime);return Math.round((n.getTime()-e.getTime())/6e4)}getDayName(t){return new Date(t).toLocaleDateString(void 0,{weekday:"long"})}sortableTime(t){return new Date(t).getTime()}extractLocation(t){try{this.rslLocation=JSON.parse(t.location)}catch{this.rslLocation=void 0}}save(){return P(this,null,function*(){var o;this.music.title||(this.music.title="");let t=this.validateTitle();if(t){this.api.sendMessage(t);return}if(this.ttitd&&this.locationError()!=""){this.api.sendMessage(this.locationError());return}this.saving=!0,this.music.title=$e(this.music.title);let e=this.camps.find(p=>p.id==this.music.campId);this.music.camp=e?e.name:"Unknown";let n;for(let p of this.occurrences){if(p.who.trim()==""){this.api.sendMessage("The DJ/Musician must be set"),this.saving=!1;return}p.startTime=b(p.startTime),p.endTime=b(p.endTime),p.who=p.who.trim();let O=new Date(p.startTime),j=new Date(p.endTime);p.timeRange=(o=Ye(O,j,void 0,this.api.currentTimeZone()))==null?void 0:o.brief,p.who.trim()==this.music.title.trim()&&(n=p.who)}if(this.occurrences=this.occurrences.sort((p,O)=>this.sortableTime(p.startTime)-this.sortableTime(O.startTime)),n){this.api.sendMessage("The name of the party should not be the same as a DJ/Musician."),this.saving=!1;return}let i=yield this.badTimeSlot(this.music,this.occurrences);if(i){this.api.sendMessage(i),this.saving=!1;return}Ge(this.music);try{this.music.musicType=this.music.musicType.join(",")}catch{}try{this.saving=!0,this.busy=!0,yield this.api.addMusic(this.music,this.occurrences),this.location.back()}finally{this.saving=!1,this.busy=!1}})}startChanged(t,e){t.startTime=e,t.endTime=Ke(Le(A(e),60))}endChanged(t,e){t.endTime=e}locationSelected(t){this.music.location=JSON.stringify(t)}validateTitle(){var t,e,n;if(this.extractLocation(this.music),this.music.title||(this.music.title=""),this.rslLocation&&this.music.title.toLowerCase().trim()==((t=this.rslLocation)==null?void 0:t.name.toLowerCase()))return`The theme should not be the location "${this.rslLocation.name}".`;if(this.rslLocation&&this.isDay(this.music.title))return"The theme should not include the day of the week (this is already captured with the events you enter)";if(this.rslLocation&&this.isDateStyle(this.music.title))return"The theme should not include the day or month (this is already captured with the events you enter)";if(this.rslLocation&&this.music.title.toLowerCase().trim()==((n=(e=this.rslLocation)==null?void 0:e.artCar)==null?void 0:n.toLowerCase()))return console.log(this.music.title),""}isDay(t){for(let e of["sunday","monday","tuesday","wednesday","thursday","friday","saturday"," mon"," tue"," wed"," thur"," fri","(mon)","(tue)","(wed)","(thur)","(fri)","(sat)","(sun)"])if(t.toLowerCase().includes(e))return!0;return!1}badTimeSlot(t,e,n=!0){return P(this,null,function*(){let i=n?(yield this.api.music()).filter(f=>f.campId==t.campId):[];if(this.ttitd){if(!t.location)return console.log(t),"The party needs a location selected"}else if(!t.campId&&!t.artCar)return"The party needs a location selected";let o=new Set;for(let f of e){if(o.has(f.startTime))return`${f.who} is at a duplicate time of ${q(new Date(f.startTime),this.api.currentTimeZone())}`;o.add(f.startTime)}let p=this.checkForOverlappingOccurrences(e);if(p)return p;let O=e.map(f=>new Date(f.startTime)),j=e.map(f=>new Date(f.endTime)),G=new Date(Math.min(...O.map(f=>f.getTime())));if((new Date(Math.max(...j.map(f=>f.getTime()))).getTime()-G.getTime())/(1e3*60*60)>24)return"The time span exceeds 24 hours. Keep length less than 24 hours (one day/night at a time).";for(let f of i){let De=JSON.parse(f.occurrences),xe=De[De.length-1],ut=e[e.length-1];if(this.music.id!=f.id&&this.music.id!=null&&this.isEqual(xe==null?void 0:xe.endTime,ut.startTime)&&(console.log("this.music.id",this.music.id),this.isNew))return`It looks like you are creating a party for a DJ timeslot instead of adding another timeslot to "${f.title}". Please add your DJ to the other party`}})}imported(t){return P(this,null,function*(){this.occurrences=t})}isEqual(t,e){return t.replace(".000","")==e.replace(".000","")}checkForOverlappingOccurrences(t){for(let e=0;e<t.length;e++)for(let n=e+1;n<t.length;n++){let i=t[e],o=t[n],p=new Date(i.startTime),O=new Date(i.endTime),j=new Date(o.startTime),G=new Date(o.endTime);if(p<G&&j<O)return`${i.who} (${q(p,this.api.currentTimeZone())} - ${q(O,this.api.currentTimeZone())}) overlaps with ${o.who} (${q(j,this.api.currentTimeZone())} - ${q(G,this.api.currentTimeZone())})`}}isDateStyle(t){let e=[/\b(jan|january|feb|february|mar|march|apr|april|may|jun|june|jul|july|aug|august|sep|september|oct|october|nov|november|dec|december)\s+\d{1,2}(st|nd|rd|th)?\b/i,/\b\d{1,2}(st|nd|rd|th)?\s+(jan|january|feb|february|mar|march|apr|april|may|jun|june|jul|july|aug|august|sep|september|oct|october|nov|november|dec|december)\b/i,/\b\d{1,2}\/\d{1,2}(\/(\d{2}|\d{4}))?\b/,/\b\d{1,2}-\d{1,2}(-(\d{2}|\d{4}))?\b/,/\b\d{1,2}[\/\-]\d{1,2}\b/,/\b\d{1,2}(st|nd|rd|th)\b/i];for(let n of e)if(n.test(t))return!0;return!1}};K.\u0275fac=function(e){return new(e||K)},K.\u0275cmp=L({type:K,selectors:[["app-music-item"]],viewQuery:function(e,n){if(e&1&&(Me(vt,5),Me(bt,5)),e&2){let i;ve(i=be())&&(n.musicContent=i.first),ve(i=be())&&(n.musicians=i)}},inputs:{id:"id",vanity:[1,"vanity"]},decls:14,vars:4,consts:[["musicContent",""],["musician",""],["color","primary"],["slot","start"],["slot","end"],["fill","clear"],[3,"click"],[3,"fullscreen"],[1,"border"],["fill","clear",3,"click"],["size","small","name","chevron-down"],[3,"imported","isOpen"],[3,"rslLocation","locationError"],["lines","none",1,"app-select"],["lines","none"],["label","Theme","labelPlacement","stacked","placeholder","Optional theme for the party","maxlength","32",1,"nice",3,"ngModelChange","ngModel"],["short","Theme","title","Examples: 'White Party, Welcome Home.', 'Duck Pond takeover Opulent Chill'. If you have a separate stage then include the name of the stage. You cannot use the name of the day, a camp name, art, or mutant vehicle name as this information is already captured.","position","bottom"],[2,"padding-left","1rem"],[1,"horizontal","bottom-line"],[1,"horizontal"],["color","secondary"],[3,"click","disabled"],["position","right","text","Add a time slot"],["color","secondary",3,"click","disabled"],[1,"pad"],[3,"rslLocationChange","locationSelected","locationErrorChange","rslLocation","locationError"],["label","Location","labelPlacement","stacked","interface","popover","placeholder","Select location of event",1,"app-select",3,"ngModelChange","value","ngModel"],[3,"value"],["labelPlacement","stacked","label","Categories","interface","action-sheet","toggleIcon","chevron-down","placeholder","Select the applicable categories",1,"app-select",3,"ngModelChange","ionChange","multiple","value","ngModel"],["short","Categories","title","Select applicable categories only. Want to know what wheelchair accessible means?","url","https://mobilitycamp.org/how-to-be-wheelchair-friendly/","position","bottom"],["helperText","",3,"emailsChange","isAdmin","isOwner","label","placeholder","emails"],["short","Owners","title","The party owner can login and alter this lineup. This is a list of email addresses."],["lines","none",1,"dj","vcenter"],["mode","ios","labelPlacement","stacked","maxlength","64",3,"ngModelChange","label","ngModel"],["position","right","text","Remove this time slot",2,"margin-top","32px"],["size","wide","label","",3,"endChanged","startChanged","longDurations","minTime","maxTime","id","startTime","endTime"],[1,"vcenter","del"],["slot","end","color","secondary",3,"click","hidden"],["size","small","name","close-outline"],["color","secondary",3,"click"]],template:function(e,n){if(e&1){let i=g();s(0,"ion-header")(1,"ion-toolbar",2)(2,"ion-buttons",3),x(3,"ion-back-button"),r(),s(4,"ion-title"),u(5),r(),s(6,"ion-buttons",4),w(7,St,2,0,"ion-button",5),s(8,"ion-button",6),h("click",function(){return m(i),d(n.save())}),u(9,"Save"),r()()()(),s(10,"ion-content",7,0),w(12,Ft,26,8,"div",8)(13,At,1,0,"app-spinner"),r()}e&2&&(c(5),S(n.id?"Party":"Add Party"),c(2),T(n.isAdmin?7:-1),c(3),_("fullscreen",!0),c(2),T(n.busy?13:12))},dependencies:[N,z,Re,J,je,oe,le,ie,ze,ce,ne,Je,qe,re,W,de,ue,se,te,me,rt,st,ct,fe,Te,H,ot],styles:["ion-card[_ngcontent-%COMP%]{cursor:auto}.vertical[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:end;justify-content:center}.horizontal[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;padding-right:5px;padding-left:5px}ion-item.app-select[_ngcontent-%COMP%]{--padding-start: 0 !important;--padding-end: 0rem}.bottom-line[_ngcontent-%COMP%]{border-bottom:1px solid var(--ion-color-light)}.dj[_ngcontent-%COMP%]{padding-left:.5rem;margin-top:-1rem;margin-bottom:.5rem}.del[_ngcontent-%COMP%]{margin-top:10px;max-width:50px}.vcenter[_ngcontent-%COMP%]{align-self:center}ion-input[_ngcontent-%COMP%]{color:var(--ion-color-dark)}ion-item[_ngcontent-%COMP%]{--padding-start: 0px;--padding-end: 0px}app-emails[_ngcontent-%COMP%]{width:100%}app-music-location[_ngcontent-%COMP%]{width:100%}.pad[_ngcontent-%COMP%]{padding:5rem}"]});var dt=K;export{dt as MusicItemPage};
