import{a as St}from"./chunk-GJLDF72A.js";import{a as bt}from"./chunk-3PGTX6TC.js";import{b as L}from"./chunk-YLPHNW7F.js";import{a as At}from"./chunk-Q7SRVC5Z.js";import{a as yt}from"./chunk-NIJZXRAZ.js";import{a as xt}from"./chunk-MTVNVIRQ.js";import{a as Ct}from"./chunk-OIMHMYK4.js";import{a as vt}from"./chunk-LKPHKBDT.js";import{a as gt}from"./chunk-5B2MUMUK.js";import"./chunk-OZ2IKH4J.js";import"./chunk-DUKSTT3K.js";import{G as ut,P as _t,R as ht,a as pt,c as mt,ja as ft}from"./chunk-LIWDDRYP.js";import{F as k,J as dt,K as b,e as ct}from"./chunk-OQVFSD37.js";import"./chunk-PFLI22GG.js";import{$ as P,Aa as g,Ca as A,Db as q,Ec as rt,Fa as F,Fc as at,Ga as N,H as o,Ha as O,Ma as M,Mc as st,P as B,Qc as lt,Ua as Q,Wb as H,X as m,Y as u,_a as R,aa as T,ba as l,ca as s,cc as K,da as r,db as $,dc as W,ea as d,ec as Y,fc as J,gc as X,ic as Z,ja as I,jb as U,kb as D,l as V,la as x,lc as tt,na as c,nb as G,p as h,rc as it,s as v,sc as et,t as y,tb as z,vc as nt,w as E,wb as j,yc as ot}from"./chunk-FDEJMFAU.js";import"./chunk-JORYF43P.js";import"./chunk-7KGURMOZ.js";import"./chunk-UT2PGJWE.js";import"./chunk-6Y2ASLSF.js";import"./chunk-XRJ4SE6F.js";import"./chunk-LIBYTRNP.js";import"./chunk-3MK77LPM.js";import"./chunk-4U6PRYVA.js";import"./chunk-CZ4AHVKD.js";import"./chunk-Z4V4M3ZT.js";import"./chunk-LLZYEWEK.js";import"./chunk-Z2GS73PT.js";import"./chunk-LF5XB4YN.js";import{h as _}from"./chunk-LNJ3S2LQ.js";function S(i){let e=i.replace("u-","");return Pt(e)}function Pt(i){let e=0;for(let n=0;n<i.length;n++)e=(e<<5)-e+i.charCodeAt(n),e|=0;return(Math.abs(e)%1e4).toString().padStart(4,"0")}var f=class f{constructor(){this.api=h(b)}exportArtToCSV(e,t){let n=[];for(let a of t)n.push({id:a.id,name:a.name,description:a.description,email:a.contact_email,placed:a.pin!=""?"Yes":"No",mvpin:a.art_type=="Mutant Vehicle"?S(`${a.id}`):""});let p=k(e.toLowerCase()," ","-");L(`${p}-art.csv`,n)}exportArtEmail(e,t){let n=[];for(let a of t)ct(a.contact_email)||n.push({email:a.contact_email});if(n.length==0){this.api.sendMessage("No Art has email addresses to be exported.");return}let p=k(e.toLowerCase()," ","-");L(`${p}-art-email.txt`,n,{stripQuotes:!0,hideHeaders:!0})}};f.\u0275fac=function(t){return new(t||f)},f.\u0275prov=V({token:f,factory:f.\u0275fac,providedIn:"root"});var w=f;var It=i=>[i],Mt=i=>({art:i}),Et=(i,e)=>e.id;function kt(i,e){if(i&1&&d(0,"app-progress-overlay",8),i&2){let t=c();l("title","Inviting...")("progress",t.progress())}}function Lt(i,e){if(i&1){let t=I();s(0,"ion-toolbar")(1,"ion-searchbar",12),x("ionInput",function(p){v(t);let a=c();return y(a.handleSearch(p))}),O("ngModelChange",function(p){v(t);let a=c();return N(a.searchQuery,p)||(a.searchQuery=p),y(p)}),r(),s(2,"ion-button",13),x("click",function(){v(t);let p=c();return y(p.toggleGrid())}),d(3,"ion-icon",14),r()()}if(i&2){let t=c();o(),l("debounce",600)("placeholder","Search art at "+t.title),F("ngModel",t.searchQuery),o(2),l("name",t.isGrid?"list-outline":"grid-outline")}}function Vt(i,e){if(i&1&&d(0,"ion-progress-bar",9),i&2){let t=c();l("value",t.progress())}}function Bt(i,e){if(i&1&&d(0,"app-card",16),i&2){let t=c(3);l("title",t.filteredBySearch?"No Art Found":"No Art")("description",t.filteredBySearch?"No art was found matching that search.":"There is no art registered for "+t.festivalTitle)}}function Ft(i,e){if(i&1&&m(0,Bt,1,2,"app-card",16),i&2){let t=c(2);u(t.art.length===0?0:-1)}}function Nt(i,e){}function Ot(i,e){i&1&&(s(0,"ion-button",23),d(1,"ion-icon",29),r())}function Qt(i,e){i&1&&(s(0,"ion-button",24),d(1,"ion-icon",30),r())}function Rt(i,e){if(i&1){let t=I();s(0,"ion-button",31),x("click",function(){v(t);let p=c().$implicit,a=c(4);return y(a.broadcastLocation(p))}),g(1,"Broadcast GPS"),r()}if(i&2){let t=c(5);l("disabled",!t.canBroadcastLocation)}}function $t(i,e){if(i&1&&(s(0,"div",19)(1,"ion-card",20),d(2,"app-img",21),s(3,"ion-card-header",22)(4,"ion-card-title"),g(5),m(6,Ot,2,0,"ion-button",23),m(7,Qt,2,0,"ion-button",24),r()(),s(8,"ion-card-content"),g(9),s(10,"div",25)(11,"ion-button",26),g(12,"Edit"),r(),s(13,"ion-button",27),g(14,"Events"),r(),m(15,Rt,2,1,"ion-button",28),r()()()()),i&2){let t=e.$implicit,n=c(4);o(2),l("routerLink",n.editRoute(t))("src",n.image(t)),o(),l("routerLink",n.editRoute(t)),o(2),A("",t.name," "),o(),u(t.pin?6:-1),o(),u(n.isAdmin&&t.status===n.ApprovalStatus.Unapproved?7:-1),o(2),A(" ",t.description," "),o(2),l("disabled",!n.canEditArt)("routerLink","../art/"+M(13,It,t.id)),o(2),l("disabled",!n.canEditEvent)("routerLink","../events")("queryParams",M(15,Mt,t.id)),o(2),u(t.art_type==="Mutant Vehicle"?15:-1)}}function Ut(i,e){if(i&1&&(s(0,"div",17),P(1,$t,16,17,"div",19,Et),r()),i&2){let t=c(3);l("ngClass",t.art.length>1?"grid":"grid1"),o(),T(t.art)}}function Dt(i,e){i&1&&d(0,"ion-icon",29)}function Gt(i,e){i&1&&d(0,"ion-icon",35)}function zt(i,e){if(i&1&&(s(0,"ion-item"),d(1,"app-img",33),s(2,"ion-text",34),g(3),m(4,Dt,1,0,"ion-icon",29),m(5,Gt,1,0,"ion-icon",35),r()()),i&2){let t=e.$implicit,n=c(4);o(),l("width","45px")("height","45px")("routerLink",n.editRoute(t))("src",n.image(t)),o(),l("routerLink",n.editRoute(t)),o(),A(" ",t.name," "),o(),u(t.pin?4:-1),o(),u(n.isAdmin&&t.status===n.ApprovalStatus.Unapproved?5:-1)}}function jt(i,e){if(i&1&&(s(0,"div",18)(1,"ion-card")(2,"ion-list"),P(3,zt,6,8,"ion-item",null,Et),r()(),d(5,"div",32)(6,"div",32),r()),i&2){let t=c(3);o(3),T(t.art)}}function qt(i,e){if(i&1&&m(0,Ut,3,1,"div",17)(1,jt,7,0,"div",18),i&2){let t=c(2);u(t.isGrid?0:1)}}function Ht(i,e){if(i&1&&(s(0,"div",10)(1,"div",15),m(2,Ft,1,1)(3,Nt,0,0),r(),m(4,qt,2,1),r()),i&2){let t=c();o(),l("ngClass",t.art.length>0?"":"pad-vertical"),o(),u(t.isAdmin?2:3),o(2),u(t.art.length>0?4:-1)}}function Kt(i,e){i&1&&d(0,"app-spinner")}function Wt(i,e){if(i&1&&d(0,"app-footer",11),i&2){let t=c();l("routeTo",t.newRoute())}}var C=class C{constructor(){this.api=h(b);this.artService=h(w);this.router=h(U);this.inviteEmailService=h(St);this.store=h(dt);this.ApprovalStatus=vt;this.vanity=Q();this.art=[];this.busy=!0;this.isAdmin=!1;this.canEdit=!1;this.canEditArt=!1;this.canEditEvent=!1;this.canBroadcastLocation=!1;this.isGrid=!0;this.filteredBySearch=!1;this.buttons=[];this.title="";this.festivalTitle="";this.progress=E(0);this.overlayTitle=E("");this.searchQuery="";ft({add:pt,locationSharp:ht,listOutline:_t,gridOutline:ut,alertCircleSharp:mt})}ngOnInit(){return _(this,null,function*(){yield this.api.setFestivalByVanity(this.vanity(),!0),this.title=`${this.api.festivalTitle()}`,this.festivalTitle=this.api.festivalTitle(),this.isAdmin=this.api.isAdmin(this.api.festivalId),this.canEdit=this.api.getAccessInfo(void 0).hasArt||this.isAdmin,this.canEditEvent=this.api.eventEditing()||this.isAdmin,this.canEditArt=this.api.artEditing()||this.isAdmin,this.canBroadcastLocation=this.api.artEditing(),this.buttons=this.isAdmin?[{title:"Import CSV",method:this.importCSV(),icon:"cloud-upload-outline"},{title:"Export CSV",method:this.exportCSV(),icon:"cloud-download-outline"},{title:"Export Email Addresses",method:this.exportEmail(),icon:"mail-outline"},{title:"Import KML",method:this.importKML(),icon:"cloud-upload-outline"},{title:"Invite All Artists",method:this.inviteAllArt(),icon:"mail-outline"}]:[]})}inviteAllArt(){return()=>_(this,null,function*(){if(!this.isAdmin){this.message("You do not have access rights to this feature.");return}yield this.inviteEmailService.inviteAllArt(this.art,this.progress)})}broadcastLocation(e){return _(this,null,function*(){let t=S(`${e.id}`);this.api.sendMessage(`Use the PIN ${t} to broadcast your mutant vehicles location. Click the link to read how.`,0,"Broadcast Location","https://dust.events/docs/Mutant%20Vehicles/broadcast-location")})}ionViewDidEnter(){return _(this,null,function*(){let e=yield this.api.art({cached:!0}),t=this.store.get("artSearchQuery");t?(this.searchQuery=t,this.art=this.filterArt(e,t),this.filteredBySearch=t.length>0):(this.searchQuery="",this.art=e,this.filteredBySearch=!1),this.busy=!1})}filterArt(e,t){let n=t.toLowerCase();return e.filter(p=>{var a;return p.name.toLowerCase().includes(n)||((a=p.description)==null?void 0:a.toLowerCase().includes(n))})}importCSV(){return()=>_(this,null,function*(){this.router.navigateByUrl("./import-art")})}importKML(){return()=>_(this,null,function*(){if(!this.isAdmin){this.message("You do not have access rights to this feature.");return}this.router.navigateByUrl(`${this.vanity()}/import-kml/art`)})}exportCSV(){return()=>_(this,null,function*(){this.artService.exportArtToCSV(this.festivalTitle,this.art)})}exportEmail(){return()=>_(this,null,function*(){this.artService.exportArtEmail(this.festivalTitle,this.art)})}message(e){setTimeout(()=>{this.api.sendMessage(e)},1)}handleSearch(e){return _(this,null,function*(){let t=e.target.value.toLowerCase();this.searchQuery=t,this.store.set("artSearchQuery",t||void 0);let n=yield this.api.art({cached:!0});this.art=this.filterArt(n,t),this.filteredBySearch=t.length>0})}toggleGrid(){this.isGrid=!this.isGrid}editRoute(e){return this.canEdit?"../art/"+e.id:void 0}image(e){return e.imageUrl?this.api.imageURL(e.imageUrl):`./assets/${e.art_type?`${e.art_type}`.toLowerCase().replace(/ /g,"-"):"unknown"}.svg`}newRoute(){return this.canEdit?"../art/new":void 0}};C.\u0275fac=function(t){return new(t||C)},C.\u0275cmp=B({type:C,selectors:[["app-art"]],inputs:{vanity:[1,"vanity"]},decls:17,vars:8,consts:[["color","primary"],["slot","start"],["routerLink","../"],["slot","end"],["routerLink","../art/new",3,"disabled"],["name","add"],[3,"buttons"],[3,"fullscreen"],[3,"title","progress"],[3,"value"],[1,"large-border"],["title","Add Art",3,"routeTo"],["mode","ios","search-icon","none","show-clear-button","always",3,"ionInput","ngModelChange","debounce","placeholder","ngModel"],["color","dark","fill","clear","slot","end",3,"click"],[3,"name"],[1,"ion-text-center",3,"ngClass"],[3,"title","description"],[1,"pad-below",3,"ngClass"],[1,"border"],[1,"grid-item"],[1,"clickable"],[3,"routerLink","src"],[3,"routerLink"],["fill","clear","color","light",1,"pin-button"],["fill","clear","color","warning",1,"approval-button"],[1,"dim",2,"text-align","center","padding-top","0.5rem"],["color","secondary",3,"disabled","routerLink"],["color","secondary",3,"disabled","routerLink","queryParams"],["color","secondary",3,"disabled"],["size","small","name","location-sharp",1,"pin"],["size","small","name","alert-circle-sharp"],["color","secondary",3,"click","disabled"],[1,"ion-padding"],[1,"clickable",2,"min-width","45px",3,"width","height","routerLink","src"],[1,"clickable",2,"width","100%","padding","1rem",3,"routerLink"],["size","small","color","warning","name","alert-circle-sharp"]],template:function(t,n){t&1&&(s(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),d(3,"ion-back-button"),r(),s(4,"ion-title",2),g(5,"Art"),r(),s(6,"ion-buttons",3)(7,"ion-button",4),d(8,"ion-icon",5),r(),d(9,"app-side",6),r()()(),s(10,"ion-content",7),m(11,kt,1,2,"app-progress-overlay",8),m(12,Lt,4,4,"ion-toolbar"),m(13,Vt,1,1,"ion-progress-bar",9),m(14,Ht,5,3,"div",10)(15,Kt,1,0,"app-spinner"),m(16,Wt,1,1,"app-footer",11),r()),t&2&&(o(7),l("disabled",!n.canEdit),o(2),l("buttons",n.buttons),o(),l("fullscreen",!0),o(),u(n.progress()>0?11:-1),o(),u(n.art.length>1?12:-1),o(),u(n.progress()>0?13:-1),o(),u(n.busy?15:14),o(2),u(n.isAdmin?16:-1))},dependencies:[et,nt,J,Z,Y,X,ot,lt,st,yt,xt,gt,K,H,W,tt,it,rt,at,$,R,q,z,j,bt,Ct,G,D,At],styles:["ion-card-title[_ngcontent-%COMP%]{font-size:var(--font-size-medium)!important}ion-card-content[_ngcontent-%COMP%]{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-size:var(--font-size-base)}h1[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.pin[_ngcontent-%COMP%]{color:var(--ion-color-primary);opacity:.5}.pin-button[_ngcontent-%COMP%]{position:absolute;margin-top:calc(-1 * var(--spacing-xs))}.approval-button[_ngcontent-%COMP%]{position:absolute;margin-top:calc(-1 * var(--spacing-xs));right:0}app-img[_ngcontent-%COMP%]{--border-radius: var(--br-xl)}"]});var wt=C;export{wt as ArtPage};
