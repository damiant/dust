import{a as vt}from"./chunk-RSLAJ4X7.js";import{a as ht}from"./chunk-3PGTX6TC.js";import{b as M}from"./chunk-YLPHNW7F.js";import{a as gt}from"./chunk-Q7SRVC5Z.js";import{a as _t}from"./chunk-NIJZXRAZ.js";import{a as ft}from"./chunk-6XV5C437.js";import{a as mt}from"./chunk-OIMHMYK4.js";import{a as ut}from"./chunk-LKPHKBDT.js";import{a as dt}from"./chunk-5B2MUMUK.js";import"./chunk-OZ2IKH4J.js";import"./chunk-DUKSTT3K.js";import{G as lt,P as st,R as ct,a as rt,c as at,ja as pt}from"./chunk-LIWDDRYP.js";import{F as L,K as b,e as ot}from"./chunk-5GFD3MFK.js";import"./chunk-PFLI22GG.js";import{$ as T,Aa as f,Ca as A,Db as D,Ec as tt,Fc as it,H as o,Ma as k,Mc as et,P as B,Qc as nt,Ua as F,Wb as G,X as p,Y as m,_a as O,aa as w,ba as l,ca as a,cc as z,da as r,db as $,dc as j,ea as d,ec as q,fc as H,gc as K,ic as Y,ja as I,jb as N,kb as R,l as V,la as y,lc as Q,na as s,nb as U,p as g,rc as J,s as C,sc as W,t as x,vc as X,w as P,yc as Z}from"./chunk-FDEJMFAU.js";import"./chunk-JORYF43P.js";import"./chunk-7KGURMOZ.js";import"./chunk-UT2PGJWE.js";import"./chunk-6Y2ASLSF.js";import"./chunk-XRJ4SE6F.js";import"./chunk-LIBYTRNP.js";import"./chunk-3MK77LPM.js";import"./chunk-4U6PRYVA.js";import"./chunk-CZ4AHVKD.js";import"./chunk-Z4V4M3ZT.js";import"./chunk-LLZYEWEK.js";import"./chunk-Z2GS73PT.js";import"./chunk-LF5XB4YN.js";import{h as _}from"./chunk-LNJ3S2LQ.js";function S(i){let e=i.replace("u-","");return yt(e)}function yt(i){let e=0;for(let n=0;n<i.length;n++)e=(e<<5)-e+i.charCodeAt(n),e|=0;return(Math.abs(e)%1e4).toString().padStart(4,"0")}var h=class h{constructor(){this.api=g(b)}exportArtToCSV(e,t){let n=[];for(let c of t)n.push({id:c.id,name:c.name,description:c.description,email:c.contact_email,placed:c.pin!=""?"Yes":"No",mvpin:c.art_type=="Mutant Vehicle"?S(`${c.id}`):""});let u=L(e.toLowerCase()," ","-");M(`${u}-art.csv`,n)}exportArtEmail(e,t){let n=[];for(let c of t)ot(c.contact_email)||n.push({email:c.contact_email});if(n.length==0){this.api.sendMessage("No Art has email addresses to be exported.");return}let u=L(e.toLowerCase()," ","-");M(`${u}-art-email.txt`,n,{stripQuotes:!0,hideHeaders:!0})}};h.\u0275fac=function(t){return new(t||h)},h.\u0275prov=V({token:h,factory:h.\u0275fac,providedIn:"root"});var E=h;var bt=i=>[i],St=i=>({art:i}),xt=(i,e)=>e.id;function Et(i,e){if(i&1&&d(0,"app-progress-overlay",8),i&2){let t=s();l("title","Inviting...")("progress",t.progress())}}function Pt(i,e){if(i&1){let t=I();a(0,"ion-toolbar")(1,"ion-searchbar",12),y("ionInput",function(u){C(t);let c=s();return x(c.handleSearch(u))}),r(),a(2,"ion-button",13),y("click",function(){C(t);let u=s();return x(u.toggleGrid())}),d(3,"ion-icon",14),r()()}if(i&2){let t=s();o(),l("debounce",600)("placeholder","Search art at "+t.title),o(2),l("name",t.isGrid?"list-outline":"grid-outline")}}function Tt(i,e){if(i&1&&d(0,"ion-progress-bar",9),i&2){let t=s();l("value",t.progress())}}function wt(i,e){if(i&1&&d(0,"app-card",16),i&2){let t=s(3);l("title",t.filteredBySearch?"No Art Found":"No Art")("description",t.filteredBySearch?"No art was found matching that search.":"There is no art registered for "+t.festivalTitle)}}function It(i,e){if(i&1&&p(0,wt,1,2,"app-card",16),i&2){let t=s(2);m(t.art.length===0?0:-1)}}function kt(i,e){}function Lt(i,e){i&1&&(a(0,"ion-button",23),d(1,"ion-icon",29),r())}function Mt(i,e){i&1&&(a(0,"ion-button",24),d(1,"ion-icon",30),r())}function Vt(i,e){if(i&1){let t=I();a(0,"ion-button",31),y("click",function(){C(t);let u=s().$implicit,c=s(4);return x(c.broadcastLocation(u))}),f(1,"Broadcast GPS"),r()}if(i&2){let t=s(5);l("disabled",!t.canBroadcastLocation)}}function Bt(i,e){if(i&1&&(a(0,"div",19)(1,"ion-card",20),d(2,"app-img",21),a(3,"ion-card-header",22)(4,"ion-card-title"),f(5),p(6,Lt,2,0,"ion-button",23),p(7,Mt,2,0,"ion-button",24),r()(),a(8,"ion-card-content"),f(9),a(10,"div",25)(11,"ion-button",26),f(12,"Edit"),r(),a(13,"ion-button",27),f(14,"Events"),r(),p(15,Vt,2,1,"ion-button",28),r()()()()),i&2){let t=e.$implicit,n=s(4);o(2),l("routerLink",n.editRoute(t))("src",n.image(t)),o(),l("routerLink",n.editRoute(t)),o(2),A("",t.name," "),o(),m(t.pin?6:-1),o(),m(n.isAdmin&&t.status===n.ApprovalStatus.Unapproved?7:-1),o(2),A(" ",t.description," "),o(2),l("disabled",!n.canEditArt)("routerLink","../art/"+k(13,bt,t.id)),o(2),l("disabled",!n.canEditEvent)("routerLink","../events")("queryParams",k(15,St,t.id)),o(2),m(t.art_type==="Mutant Vehicle"?15:-1)}}function Ft(i,e){if(i&1&&(a(0,"div",17),T(1,Bt,16,17,"div",19,xt),r()),i&2){let t=s(3);l("ngClass",t.art.length>1?"grid":"grid1"),o(),w(t.art)}}function Ot(i,e){i&1&&d(0,"ion-icon",29)}function $t(i,e){i&1&&d(0,"ion-icon",35)}function Nt(i,e){if(i&1&&(a(0,"ion-item"),d(1,"app-img",33),a(2,"ion-text",34),f(3),p(4,Ot,1,0,"ion-icon",29),p(5,$t,1,0,"ion-icon",35),r()()),i&2){let t=e.$implicit,n=s(4);o(),l("width","45px")("height","45px")("routerLink",n.editRoute(t))("src",n.image(t)),o(),l("routerLink",n.editRoute(t)),o(),A(" ",t.name," "),o(),m(t.pin?4:-1),o(),m(n.isAdmin&&t.status===n.ApprovalStatus.Unapproved?5:-1)}}function Rt(i,e){if(i&1&&(a(0,"div",18)(1,"ion-card")(2,"ion-list"),T(3,Nt,6,8,"ion-item",null,xt),r()(),d(5,"div",32)(6,"div",32),r()),i&2){let t=s(3);o(3),w(t.art)}}function Ut(i,e){if(i&1&&p(0,Ft,3,1,"div",17)(1,Rt,7,0,"div",18),i&2){let t=s(2);m(t.isGrid?0:1)}}function Dt(i,e){if(i&1&&(a(0,"div",10)(1,"div",15),p(2,It,1,1)(3,kt,0,0),r(),p(4,Ut,2,1),r()),i&2){let t=s();o(),l("ngClass",t.art.length>0?"":"pad-vertical"),o(),m(t.isAdmin?2:3),o(2),m(t.art.length>0?4:-1)}}function Gt(i,e){i&1&&d(0,"app-spinner")}function zt(i,e){if(i&1&&d(0,"app-footer",11),i&2){let t=s();l("routeTo",t.newRoute())}}var v=class v{constructor(){this.api=g(b);this.artService=g(E);this.router=g(N);this.inviteEmailService=g(vt);this.ApprovalStatus=ut;this.vanity=F();this.art=[];this.busy=!0;this.isAdmin=!1;this.canEdit=!1;this.canEditArt=!1;this.canEditEvent=!1;this.canBroadcastLocation=!1;this.isGrid=!0;this.filteredBySearch=!1;this.buttons=[];this.title="";this.festivalTitle="";this.progress=P(0);this.overlayTitle=P("");pt({add:rt,locationSharp:ct,listOutline:st,gridOutline:lt,alertCircleSharp:at})}ngOnInit(){return _(this,null,function*(){yield this.api.setFestivalByVanity(this.vanity(),!0),this.title=`${this.api.festivalTitle()}`,this.festivalTitle=this.api.festivalTitle(),this.isAdmin=this.api.isAdmin(this.api.festivalId),this.canEdit=this.api.getAccessInfo(void 0).hasArt||this.isAdmin,this.canEditEvent=this.api.eventEditing()||this.isAdmin,this.canEditArt=this.api.artEditing()||this.isAdmin,this.canBroadcastLocation=this.api.artEditing(),this.buttons=this.isAdmin?[{title:"Import CSV",method:this.importCSV(),icon:"cloud-upload-outline"},{title:"Export CSV",method:this.exportCSV(),icon:"cloud-download-outline"},{title:"Export Email Addresses",method:this.exportEmail(),icon:"mail-outline"},{title:"Import KML",method:this.importKML(),icon:"cloud-upload-outline"},{title:"Invite All Artists",method:this.inviteAllArt(),icon:"mail-outline"}]:[]})}inviteAllArt(){return()=>_(this,null,function*(){if(!this.isAdmin){this.message("You do not have access rights to this feature.");return}yield this.inviteEmailService.inviteAllArt(this.art,this.progress)})}broadcastLocation(e){return _(this,null,function*(){let t=S(`${e.id}`);this.api.sendMessage(`Use the PIN ${t} to broadcast your mutant vehicles location. Click the link to read how.`,0,"Broadcast Location","https://dust.events/docs/Mutant%20Vehicles/broadcast-location")})}ionViewDidEnter(){return _(this,null,function*(){this.art=yield this.api.art({cached:!0}),this.filteredBySearch=!1,this.busy=!1})}importCSV(){return()=>_(this,null,function*(){this.router.navigateByUrl("./import-art")})}importKML(){return()=>_(this,null,function*(){if(!this.isAdmin){this.message("You do not have access rights to this feature.");return}this.router.navigateByUrl(`${this.vanity()}/import-kml/art`)})}exportCSV(){return()=>_(this,null,function*(){this.artService.exportArtToCSV(this.festivalTitle,this.art)})}exportEmail(){return()=>_(this,null,function*(){this.artService.exportArtEmail(this.festivalTitle,this.art)})}message(e){setTimeout(()=>{this.api.sendMessage(e)},1)}handleSearch(e){return _(this,null,function*(){let t=e.target.value.toLowerCase(),n=yield this.api.art({cached:!0});this.art=n.filter(u=>{var c;return u.name.toLowerCase().includes(t)||((c=u.description)==null?void 0:c.toLowerCase().includes(t))}),this.filteredBySearch=t.length>0})}toggleGrid(){this.isGrid=!this.isGrid}editRoute(e){return this.canEdit?"../art/"+e.id:void 0}image(e){return e.imageUrl?this.api.imageURL(e.imageUrl):`./assets/${e.art_type?`${e.art_type}`.toLowerCase().replace(/ /g,"-"):"unknown"}.svg`}newRoute(){return this.canEdit?"../art/new":void 0}};v.\u0275fac=function(t){return new(t||v)},v.\u0275cmp=B({type:v,selectors:[["app-art"]],inputs:{vanity:[1,"vanity"]},decls:17,vars:8,consts:[["color","primary"],["slot","start"],["routerLink","../"],["slot","end"],["routerLink","../art/new",3,"disabled"],["name","add"],[3,"buttons"],[3,"fullscreen"],[3,"title","progress"],[3,"value"],[1,"large-border"],["title","Add Art",3,"routeTo"],["mode","ios","search-icon","none","show-clear-button","always",3,"ionInput","debounce","placeholder"],["color","dark","fill","clear","slot","end",3,"click"],[3,"name"],[1,"ion-text-center",3,"ngClass"],[3,"title","description"],[1,"pad-below",3,"ngClass"],[1,"border"],[1,"grid-item"],[1,"clickable"],[3,"routerLink","src"],[3,"routerLink"],["fill","clear","color","light",1,"pin-button"],["fill","clear","color","warning",1,"approval-button"],[1,"dim",2,"text-align","center","padding-top","0.5rem"],["color","secondary",3,"disabled","routerLink"],["color","secondary",3,"disabled","routerLink","queryParams"],["color","secondary",3,"disabled"],["size","small","name","location-sharp",1,"pin"],["size","small","name","alert-circle-sharp"],["color","secondary",3,"click","disabled"],[1,"ion-padding"],[1,"clickable",2,"min-width","45px",3,"width","height","routerLink","src"],[1,"clickable",2,"width","100%","padding","1rem",3,"routerLink"],["size","small","color","warning","name","alert-circle-sharp"]],template:function(t,n){t&1&&(a(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),d(3,"ion-back-button"),r(),a(4,"ion-title",2),f(5,"Art"),r(),a(6,"ion-buttons",3)(7,"ion-button",4),d(8,"ion-icon",5),r(),d(9,"app-side",6),r()()(),a(10,"ion-content",7),p(11,Et,1,2,"app-progress-overlay",8),p(12,Pt,4,3,"ion-toolbar"),p(13,Tt,1,1,"ion-progress-bar",9),p(14,Dt,5,3,"div",10)(15,Gt,1,0,"app-spinner"),p(16,zt,1,1,"app-footer",11),r()),t&2&&(o(7),l("disabled",!n.canEdit),o(2),l("buttons",n.buttons),o(),l("fullscreen",!0),o(),m(n.progress()>0?11:-1),o(),m(n.art.length>1?12:-1),o(),m(n.progress()>0?13:-1),o(),m(n.busy?15:14),o(2),m(n.isAdmin?16:-1))},dependencies:[W,X,H,Y,q,K,Z,nt,et,_t,ft,dt,z,G,j,Q,J,tt,it,$,O,D,ht,mt,U,R,gt],styles:["ion-card-title[_ngcontent-%COMP%]{font-size:var(--font-size-medium)!important}ion-card-content[_ngcontent-%COMP%]{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-size:var(--font-size-base)}h1[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.pin[_ngcontent-%COMP%]{color:var(--ion-color-primary);opacity:.5}.pin-button[_ngcontent-%COMP%]{position:absolute;margin-top:calc(-1 * var(--spacing-xs))}.approval-button[_ngcontent-%COMP%]{position:absolute;margin-top:calc(-1 * var(--spacing-xs));right:0}app-img[_ngcontent-%COMP%]{--border-radius: var(--br-xl)}"]});var Ct=v;export{Ct as ArtPage};
