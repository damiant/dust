import{a as le}from"./chunk-4IGEIIOR.js";import{a as re}from"./chunk-67ONBALU.js";import"./chunk-A7RCF4AZ.js";import{a as oe}from"./chunk-GLPG6IXG.js";import"./chunk-DUKSTT3K.js";import{J as ee,P as te,_ as ie,a as Q,ba as ne,ea as C,k as X,x as Y,y as Z}from"./chunk-MQOPPKG3.js";import{J as K}from"./chunk-2K4NO5ZT.js";import"./chunk-PFLI22GG.js";import{$ as w,Aa as F,C as N,Cb as R,Dc as q,Ec as J,G as a,Kc as x,La as P,O as f,Qa as v,Ta as d,Vb as A,W as g,X as k,_ as T,aa as c,ba as l,bc as B,ca as r,cc as G,da as s,dc as H,ec as $,ia as M,ib as S,jb as V,ka as D,kc as j,ma as p,mb as O,p as y,qc as W,rc as z,s as L,t as I,uc as U,za as _}from"./chunk-OCTOJKK3.js";import"./chunk-JORYF43P.js";import"./chunk-7KGURMOZ.js";import"./chunk-UT2PGJWE.js";import"./chunk-6Y2ASLSF.js";import"./chunk-XRJ4SE6F.js";import"./chunk-LIBYTRNP.js";import"./chunk-3MK77LPM.js";import"./chunk-4U6PRYVA.js";import"./chunk-CZ4AHVKD.js";import"./chunk-Z4V4M3ZT.js";import"./chunk-LLZYEWEK.js";import"./chunk-Z2GS73PT.js";import"./chunk-LF5XB4YN.js";import{h as E}from"./chunk-LNJ3S2LQ.js";function de(i,t){if(i&1){let e=M();l(0,"ion-item",2),D("click",function(){L(e);let o=p();return I(o.link(o.url()))}),s(1,"ion-icon",3),_(2),r()}if(i&2){let e=p();a(),c("name",e.icon()),a(),F(e.text())}}function fe(i,t){if(i&1){let e=M();l(0,"div",4),D("click",function(){L(e);let o=p();return I(o.link(o.url()))}),r()}if(i&2){let e=p();c("innerHTML",e.html(),N)}}var u=class u{constructor(){this.text=d("");this.url=d("");this.icon=v(()=>{let t=this.url(),e=this.text();return console.log(t),t.includes("tel:")||t.includes("sms:")?"call-outline":t.includes("mailto:")?"mail-outline":t.includes("maps.")?"compass-outline":t.includes("youtu.")?"tv-outline":e.includes("ticket")?"ticket-outline":"link-outline"});this.simple=v(()=>!this.text().includes("<"));this.html=v(()=>{let t=this.text();return this.removeTagsExceptAllowed(t,["b","h1","h2","h3","h4","code","img","small","br","center","p","i","u","ul","li","ol"])});C({linkOutline:ee,compass:Y,compassOutline:Z,callOutline:X,mailOutline:te,ticketOutline:ie,tvOutline:ne})}link(t){console.log("click",t)}removeTagsExceptAllowed(t,e){let n=e.map(ce).join("|"),o=new RegExp("</?([^>]+)(?:>)(?!</\\1>)","gi");function ce(b){return b.replace(/([\\\/<>+\-*!(){}.^$|\[\]])/g,"\\$&")}return t.replace(o,(b,pe)=>n.includes(pe)?b:"")}};u.\u0275fac=function(e){return new(e||u)},u.\u0275cmp=f({type:u,selectors:[["app-link"]],inputs:{text:[1,"text"],url:[1,"url"]},decls:2,vars:1,consts:[["lines","none","detail","true"],[3,"innerHTML"],["lines","none","detail","true",3,"click"],["slot","start",3,"name"],[3,"click","innerHTML"]],template:function(e,n){e&1&&g(0,de,3,2,"ion-item",0)(1,fe,1,1,"div",1),e&2&&k(n.simple()?0:1)},dependencies:[x,z],encapsulation:2});var h=u;var ge=i=>[i],ae=(i,t)=>t.id;function ke(i,t){if(i&1&&s(0,"app-link",10),i&2){let e=t.$implicit;c("routerLink","../link/"+P(2,ge,e.id))("text",e.title)}}function _e(i,t){if(i&1&&(l(0,"ion-card")(1,"ion-card-content")(2,"ion-list"),T(3,ke,1,4,"app-link",10,ae),r()()()),i&2){let e=t.$implicit;a(3),w(e.links)}}function ve(i,t){if(i&1&&(s(0,"app-image-card",9),T(1,_e,5,0,"ion-card",null,ae)),i&2){let e=p();c("url",e.festivalImage())("title",e.title)("description",e.groups.length===0?"Links are buttons that appear in the dust app that will open a browser window, call a phone number or email.":""),a(),w(e.groups)}}function xe(i,t){i&1&&s(0,"app-spinner")}var m=class m{constructor(){this.api=y(K);this.router=y(S);this.vanity=d();this.title="";this.busy=!0;this.groups=[];C({add:Q})}ionViewWillEnter(){return E(this,null,function*(){this.busy=!0,yield this.api.setFestivalByVanity(this.vanity()),this.title=this.api.festivalTitle(),this.groups=this.group(yield this.api.links()),console.log(this.groups),this.busy=!1})}group(t){let e=[],n={id:1,links:[]};for(let o of t)o.title.startsWith("#")&&(o.title=o.title.substring(1),n.links.length>0&&(e.push(n),n={id:n.id+1,links:[]})),n.links.push(o);return e.push(n),e}festivalImage(){return this.api.imageURL(this.api.festivalImage())}};m.\u0275fac=function(e){return new(e||m)},m.\u0275cmp=f({type:m,selectors:[["app-links"]],inputs:{vanity:[1,"vanity"]},decls:14,vars:2,consts:[["color","primary"],["slot","start"],["routerLink","../"],["slot","end"],["routerLink","../link/new"],["name","add"],[3,"fullscreen"],[1,"border"],["title","Add Link","routeTo","../link/new"],["routeTo","../link/new",3,"url","title","description"],[1,"clickable",3,"routerLink","text"]],template:function(e,n){e&1&&(l(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),s(3,"ion-back-button"),r(),l(4,"ion-title",2),_(5,"Links"),r(),l(6,"ion-buttons",3)(7,"ion-button",4),s(8,"ion-icon",5),r()()()(),l(9,"ion-content",6)(10,"div",7),g(11,ve,3,3)(12,xe,1,0,"app-spinner"),r(),s(13,"app-footer",8),r()),e&2&&(a(9),c("fullscreen",!0),a(2),k(n.busy?12:11))},dependencies:[oe,R,O,V,W,J,G,A,q,B,j,x,H,le,$,U,re,h],styles:["ion-item[_ngcontent-%COMP%]{cursor:pointer}"]});var se=m;export{se as LinksPage};
