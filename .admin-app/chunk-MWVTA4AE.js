import{a as ft}from"./chunk-NIN2XJQV.js";import{a as ht}from"./chunk-K3UGTFX7.js";import{a as _t}from"./chunk-LSC52AIM.js";import{b as M}from"./chunk-QTBNLBDF.js";import{a as mt}from"./chunk-67ONBALU.js";import{a as ut}from"./chunk-ALTFHMWK.js";import{a as pt}from"./chunk-A7RCF4AZ.js";import{a as dt}from"./chunk-GLPG6IXG.js";import"./chunk-OZ2IKH4J.js";import"./chunk-DUKSTT3K.js";import{C as at,K as st,M as lt,a as rt,ea as ct}from"./chunk-MQOPPKG3.js";import{E as L,J as b,e as ot}from"./chunk-2K4NO5ZT.js";import"./chunk-PFLI22GG.js";import{$ as I,Ba as A,Cb as G,Dc as tt,Ec as it,G as o,Kc as et,La as k,O as B,Oc as nt,Ta as F,Vb as U,W as p,X as m,Za as $,_ as w,aa as a,ba as s,bc as j,ca as r,cb as N,cc as q,da as c,dc as z,ec as H,fc as K,hc as Y,ia as P,ib as O,jb as R,ka as y,kc as Q,l as V,ma as l,mb as D,p as h,qc as J,rc as W,s as C,t as x,uc as X,w as T,xc as Z,za as f}from"./chunk-OCTOJKK3.js";import"./chunk-JORYF43P.js";import"./chunk-7KGURMOZ.js";import"./chunk-UT2PGJWE.js";import"./chunk-6Y2ASLSF.js";import"./chunk-XRJ4SE6F.js";import"./chunk-LIBYTRNP.js";import"./chunk-3MK77LPM.js";import"./chunk-4U6PRYVA.js";import"./chunk-CZ4AHVKD.js";import"./chunk-Z4V4M3ZT.js";import"./chunk-LLZYEWEK.js";import"./chunk-Z2GS73PT.js";import"./chunk-LF5XB4YN.js";import{h as _}from"./chunk-LNJ3S2LQ.js";function E(i){let e=i.replace("u-","");return Ct(e)}function Ct(i){let e=0;for(let n=0;n<i.length;n++)e=(e<<5)-e+i.charCodeAt(n),e|=0;return(Math.abs(e)%1e4).toString().padStart(4,"0")}var g=class g{constructor(){this.api=h(b)}exportArtToCSV(e,t){let n=[];for(let d of t)n.push({id:d.id,name:d.name,description:d.description,email:d.contact_email,placed:d.pin!=""?"Yes":"No",mvpin:d.art_type=="Mutant Vehicle"?E(`${d.id}`):""});let u=L(e.toLowerCase()," ","-");M(`${u}-art.csv`,n)}exportArtEmail(e,t){let n=[];for(let d of t)ot(d.contact_email)||n.push({email:d.contact_email});if(n.length==0){this.api.sendMessage("No Art has email addresses to be exported.");return}let u=L(e.toLowerCase()," ","-");M(`${u}-art-email.txt`,n,{stripQuotes:!0,hideHeaders:!0})}};g.\u0275fac=function(t){return new(t||g)},g.\u0275prov=V({token:g,factory:g.\u0275fac,providedIn:"root"});var S=g;var yt=i=>[i],At=i=>({art:i}),vt=(i,e)=>e.id;function bt(i,e){if(i&1&&c(0,"app-progress-overlay",8),i&2){let t=l();a("title","Inviting...")("progress",t.progress())}}function Et(i,e){if(i&1){let t=P();s(0,"ion-toolbar")(1,"ion-searchbar",12),y("ionInput",function(u){C(t);let d=l();return x(d.handleSearch(u))}),r(),s(2,"ion-button",13),y("click",function(){C(t);let u=l();return x(u.toggleGrid())}),c(3,"ion-icon",14),r()()}if(i&2){let t=l();o(),a("debounce",600)("placeholder","Search art at "+t.title),o(2),a("name",t.isGrid?"list-outline":"grid-outline")}}function St(i,e){if(i&1&&c(0,"ion-progress-bar",9),i&2){let t=l();a("value",t.progress())}}function Tt(i,e){if(i&1&&c(0,"app-card",16),i&2){let t=l(3);a("title",t.filteredBySearch?"No Art Found":"No Art")("description",t.filteredBySearch?"No art was found matching that search.":"There is no art registered for "+t.festivalTitle)}}function wt(i,e){if(i&1&&p(0,Tt,1,2,"app-card",16),i&2){let t=l(2);m(t.art.length===0?0:-1)}}function It(i,e){}function Pt(i,e){i&1&&(s(0,"ion-button",23),c(1,"ion-icon",28),r())}function kt(i,e){if(i&1){let t=P();s(0,"ion-button",29),y("click",function(){C(t);let u=l().$implicit,d=l(4);return x(d.broadcastLocation(u))}),f(1,"Broadcast GPS"),r()}if(i&2){let t=l(5);a("disabled",!t.canBroadcastLocation)}}function Lt(i,e){if(i&1&&(s(0,"div",19)(1,"ion-card",20),c(2,"app-img",21),s(3,"ion-card-header",22)(4,"ion-card-title"),f(5),p(6,Pt,2,0,"ion-button",23),r()(),s(7,"ion-card-content"),f(8),s(9,"div",24)(10,"ion-button",25),f(11,"Edit"),r(),s(12,"ion-button",26),f(13,"Events"),r(),p(14,kt,2,1,"ion-button",27),r()()()()),i&2){let t=e.$implicit,n=l(4);o(2),a("routerLink",n.editRoute(t))("src",n.image(t)),o(),a("routerLink",n.editRoute(t)),o(2),A("",t.name," "),o(),m(t.pin?6:-1),o(2),A(" ",t.description," "),o(2),a("disabled",!n.canEditArt)("routerLink","../art/"+k(12,yt,t.id)),o(2),a("disabled",!n.canEditEvent)("routerLink","../events")("queryParams",k(14,At,t.id)),o(2),m(t.art_type==="Mutant Vehicle"?14:-1)}}function Mt(i,e){if(i&1&&(s(0,"div",17),w(1,Lt,15,16,"div",19,vt),r()),i&2){let t=l(3);a("ngClass",t.art.length>1?"grid":"grid1"),o(),I(t.art)}}function Vt(i,e){i&1&&c(0,"ion-icon",28)}function Bt(i,e){if(i&1&&(s(0,"ion-item"),c(1,"app-img",31),s(2,"ion-text",32),f(3),p(4,Vt,1,0,"ion-icon",28),r()()),i&2){let t=e.$implicit,n=l(4);o(),a("width","45px")("height","45px")("routerLink",n.editRoute(t))("src",n.image(t)),o(),a("routerLink",n.editRoute(t)),o(),A(" ",t.name," "),o(),m(t.pin?4:-1)}}function Ft(i,e){if(i&1&&(s(0,"div",18)(1,"ion-card")(2,"ion-list"),w(3,Bt,5,7,"ion-item",null,vt),r()(),c(5,"div",30)(6,"div",30),r()),i&2){let t=l(3);o(3),I(t.art)}}function $t(i,e){if(i&1&&p(0,Mt,3,1,"div",17)(1,Ft,7,0,"div",18),i&2){let t=l(2);m(t.isGrid?0:1)}}function Nt(i,e){if(i&1&&(s(0,"div",10)(1,"div",15),p(2,wt,1,1)(3,It,0,0),r(),p(4,$t,2,1),r()),i&2){let t=l();o(),a("ngClass",t.art.length>0?"":"pad-vertical"),o(),m(t.isAdmin?2:3),o(2),m(t.art.length>0?4:-1)}}function Ot(i,e){i&1&&c(0,"app-spinner")}function Rt(i,e){if(i&1&&c(0,"app-footer",11),i&2){let t=l();a("routeTo",t.newRoute())}}var v=class v{constructor(){this.api=h(b);this.artService=h(S);this.router=h(O);this.inviteEmailService=h(ft);this.vanity=F();this.art=[];this.busy=!0;this.isAdmin=!1;this.canEdit=!1;this.canEditArt=!1;this.canEditEvent=!1;this.canBroadcastLocation=!1;this.isGrid=!0;this.filteredBySearch=!1;this.buttons=[];this.title="";this.festivalTitle="";this.progress=T(0);this.overlayTitle=T("");ct({add:rt,locationSharp:lt,listOutline:st,gridOutline:at})}ngOnInit(){return _(this,null,function*(){yield this.api.setFestivalByVanity(this.vanity(),!0),this.title=`${this.api.festivalTitle()}`,this.festivalTitle=this.api.festivalTitle(),this.isAdmin=this.api.isAdmin(this.api.festivalId),this.canEdit=this.api.getAccessInfo(void 0).hasArt||this.isAdmin,this.canEditEvent=this.api.eventEditing()||this.isAdmin,this.canEditArt=this.api.artEditing()||this.isAdmin,this.canBroadcastLocation=this.api.artEditing(),this.buttons=this.isAdmin?[{title:"Import CSV",method:this.importCSV(),icon:"cloud-upload-outline"},{title:"Export CSV",method:this.exportCSV(),icon:"cloud-download-outline"},{title:"Export Email Addresses",method:this.exportEmail(),icon:"mail-outline"},{title:"Import KML",method:this.importKML(),icon:"cloud-upload-outline"},{title:"Invite All Artists",method:this.inviteAllArt(),icon:"mail-outline"}]:[]})}inviteAllArt(){return()=>_(this,null,function*(){if(!this.isAdmin){this.message("You do not have access rights to this feature.");return}yield this.inviteEmailService.inviteAllArt(this.art,this.progress)})}broadcastLocation(e){return _(this,null,function*(){let t=E(`${e.id}`);this.api.sendMessage(`Use the PIN ${t} to broadcast your mutant vehicles location. Click the link to read how.`,0,"Broadcast Location","https://dust.events/docs/Mutant%20Vehicles/broadcast-location")})}ionViewDidEnter(){return _(this,null,function*(){this.art=yield this.api.art({cached:!0}),this.filteredBySearch=!1,this.busy=!1})}importCSV(){return()=>_(this,null,function*(){this.router.navigateByUrl("./import-art")})}importKML(){return()=>_(this,null,function*(){if(!this.isAdmin){this.message("You do not have access rights to this feature.");return}this.router.navigateByUrl(`${this.vanity()}/import-kml/art`)})}exportCSV(){return()=>_(this,null,function*(){this.artService.exportArtToCSV(this.festivalTitle,this.art)})}exportEmail(){return()=>_(this,null,function*(){this.artService.exportArtEmail(this.festivalTitle,this.art)})}message(e){setTimeout(()=>{this.api.sendMessage(e)},1)}handleSearch(e){return _(this,null,function*(){let t=e.target.value.toLowerCase(),n=yield this.api.art({cached:!0});this.art=n.filter(u=>{var d;return u.name.toLowerCase().includes(t)||((d=u.description)==null?void 0:d.toLowerCase().includes(t))}),this.filteredBySearch=t.length>0})}toggleGrid(){this.isGrid=!this.isGrid}editRoute(e){return this.canEdit?"../art/"+e.id:void 0}image(e){return e.imageUrl?this.api.imageURL(e.imageUrl):`./assets/${e.art_type?`${e.art_type}`.toLowerCase().replace(/ /g,"-"):"unknown"}.svg`}newRoute(){return this.canEdit?"../art/new":void 0}};v.\u0275fac=function(t){return new(t||v)},v.\u0275cmp=B({type:v,selectors:[["app-art"]],inputs:{vanity:[1,"vanity"]},decls:17,vars:8,consts:[["color","primary"],["slot","start"],["routerLink","../"],["slot","end"],["routerLink","../art/new",3,"disabled"],["name","add"],[3,"buttons"],[3,"fullscreen"],[3,"title","progress"],[3,"value"],[1,"large-border"],["title","Add Art",3,"routeTo"],["mode","ios","search-icon","none","show-clear-button","always",3,"ionInput","debounce","placeholder"],["color","dark","fill","clear","slot","end",3,"click"],[3,"name"],[1,"ion-text-center",3,"ngClass"],[3,"title","description"],[1,"pad-below",3,"ngClass"],[1,"border"],[1,"grid-item"],[1,"clickable"],[3,"routerLink","src"],[3,"routerLink"],["fill","clear","color","light",2,"position","absolute","margin-top","-3px"],[1,"dim",2,"text-align","center","padding-top","0.5rem"],["color","secondary",3,"disabled","routerLink"],["color","secondary",3,"disabled","routerLink","queryParams"],["color","secondary",3,"disabled"],["size","small","name","location-sharp",1,"pin"],["color","secondary",3,"click","disabled"],[1,"ion-padding"],[1,"clickable",2,"min-width","45px",3,"width","height","routerLink","src"],[1,"clickable",2,"width","100%","padding","1rem",3,"routerLink"]],template:function(t,n){t&1&&(s(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),c(3,"ion-back-button"),r(),s(4,"ion-title",2),f(5,"Art"),r(),s(6,"ion-buttons",3)(7,"ion-button",4),c(8,"ion-icon",5),r(),c(9,"app-side",6),r()()(),s(10,"ion-content",7),p(11,bt,1,2,"app-progress-overlay",8),p(12,Et,4,3,"ion-toolbar"),p(13,St,1,1,"ion-progress-bar",9),p(14,Nt,5,3,"div",10)(15,Ot,1,0,"app-spinner"),p(16,Rt,1,1,"app-footer",11),r()),t&2&&(o(7),a("disabled",!n.canEdit),o(2),a("buttons",n.buttons),o(),a("fullscreen",!0),o(),m(n.progress()>0?11:-1),o(),m(n.art.length>1?12:-1),o(),m(n.progress()>0?13:-1),o(),m(n.busy?15:14),o(2),m(n.isAdmin?16:-1))},dependencies:[W,X,H,Y,z,K,Z,nt,et,mt,ut,dt,j,U,q,Q,J,tt,it,N,$,G,_t,pt,D,R,ht],styles:["ion-card-title[_ngcontent-%COMP%]{font-size:1.5rem!important}ion-card-content[_ngcontent-%COMP%]{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-size:var(--fs4)}h1[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.pin[_ngcontent-%COMP%]{color:var(--ion-color-primary);opacity:.5}app-img[_ngcontent-%COMP%]{--border-radius: 5px}"]});var gt=v;export{gt as ArtPage};
