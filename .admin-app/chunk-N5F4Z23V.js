import{a as Ti}from"./chunk-GJLDF72A.js";import{a as Ei}from"./chunk-3PGTX6TC.js";import{b as A}from"./chunk-YLPHNW7F.js";import{a as Si}from"./chunk-Q7SRVC5Z.js";import{a as yi}from"./chunk-NIJZXRAZ.js";import{a as bi}from"./chunk-MTVNVIRQ.js";import{a as vi}from"./chunk-OIMHMYK4.js";import{a as xi}from"./chunk-LKPHKBDT.js";import{a as gi}from"./chunk-5B2MUMUK.js";import"./chunk-OZ2IKH4J.js";import"./chunk-DUKSTT3K.js";import{G as Ci,P as hi,R as _i,a as mi,c as ui,ja as fi}from"./chunk-LIWDDRYP.js";import{F as L,J as di,K as S,e as pi}from"./chunk-OQVFSD37.js";import"./chunk-PFLI22GG.js";import{$ as w,Aa as C,Ca as b,Db as $,Dc as ai,Ec as ri,Fa as B,Fc as si,Ga as F,H as o,Ha as O,Ma as f,Mc as li,P as R,Qc as ci,Ua as N,Wb as j,X as p,Y as d,_a as Q,aa as I,ba as a,ca as r,cc as H,da as s,db as U,dc as K,ea as l,ec as W,fc as J,gc as X,ic as Z,ja as V,jb as z,kb as G,l as M,la as k,lc as ii,na as c,nb as D,p as _,rc as ti,s as x,sc as ei,t as y,tb as Y,vc as ni,w as P,wb as q,yc as oi}from"./chunk-FDEJMFAU.js";import"./chunk-JORYF43P.js";import"./chunk-7KGURMOZ.js";import"./chunk-UT2PGJWE.js";import"./chunk-6Y2ASLSF.js";import"./chunk-XRJ4SE6F.js";import"./chunk-LIBYTRNP.js";import"./chunk-3MK77LPM.js";import"./chunk-4U6PRYVA.js";import"./chunk-CZ4AHVKD.js";import"./chunk-Z4V4M3ZT.js";import"./chunk-LLZYEWEK.js";import"./chunk-Z2GS73PT.js";import"./chunk-LF5XB4YN.js";import{h}from"./chunk-LNJ3S2LQ.js";var g=class g{constructor(){this.api=_(S)}exportCampsToCSV(e,i){let n=[];for(let u of i)n.push({id:u.id,name:u.name,description:u.description,email:u.contact_email,placed:u.pin!=""?"Yes":"No"});let m=L(e.toLowerCase()," ","-");A(`${m}-camps.csv`,n)}exportCampsEmail(e,i){let n=[];for(let u of i)pi(u.contact_email)||n.push({email:u.contact_email});if(n.length==0){this.api.sendMessage("No Camps have email addresses to be exported.");return}let m=L(e.toLowerCase()," ","-");A(`${m}-camp-email.txt`,n,{stripQuotes:!0,hideHeaders:!0})}};g.\u0275fac=function(i){return new(i||g)},g.\u0275prov=M({token:g,factory:g.\u0275fac,providedIn:"root"});var E=g;var ki=t=>[t],T=t=>({camp:t}),wi=(t,e)=>e.id;function Li(t,e){if(t&1&&l(0,"app-progress-overlay",8),t&2){let i=c();a("title","Inviting...")("progress",i.progress())}}function Ai(t,e){if(t&1){let i=V();r(0,"ion-toolbar")(1,"ion-searchbar",12),k("ionInput",function(m){x(i);let u=c();return y(u.handleSearch(m))}),O("ngModelChange",function(m){x(i);let u=c();return F(u.searchQuery,m)||(u.searchQuery=m),y(m)}),s(),r(2,"ion-button",13),k("click",function(){x(i);let m=c();return y(m.toggleGrid())}),l(3,"ion-icon",14),s()()}if(t&2){let i=c();o(),a("debounce",600)("placeholder","Search camps at "+i.title),B("ngModel",i.searchQuery),o(2),a("name",i.isGrid?"list-outline":"grid-outline")}}function Mi(t,e){if(t&1&&l(0,"ion-progress-bar",9),t&2){let i=c();a("value",i.progress())}}function Ri(t,e){if(t&1&&l(0,"app-card",16),t&2){let i=c(3);a("title",i.filteredBySearch?"No Camps Found":"No Camps")("description",i.filteredBySearch?"No camps found matching that search":"There are no theme camps registered for "+i.festivalTitle)}}function Vi(t,e){if(t&1&&p(0,Ri,1,2,"app-card",16),t&2){let i=c(2);d(i.camps.length===0?0:-1)}}function Bi(t,e){if(t&1&&(r(0,"app-card",17),l(1,"app-img",19),r(2,"ion-button",20),C(3," Register Camp "),s()()),t&2){let i=c(3);a("description","Camp registration for "+i.festivalTitle+" is open."),o(),a("width","100px")("height","100px")("src",i.imageUrl),o(),a("routerLink",i.newRoute())}}function Fi(t,e){if(t&1&&l(0,"app-card",18),t&2){let i=c(3);a("description",i.camps.length===0?"Registration for camps at "+i.festivalTitle+" have been disabled. You cannot register a camp at this time.":"Changes to camps at "+i.festivalTitle+" have been disabled. You cannot make any changes at this time.")}}function Oi(t,e){if(t&1&&p(0,Bi,4,5,"app-card",17)(1,Fi,1,1,"app-card",18),t&2){let i=c(2);d(i.camps.length===0&&i.api.campRegistration()?0:!i.api.campRegistration()&&!i.api.campEditing()?1:-1)}}function Ni(t,e){t&1&&(r(0,"ion-button",26),l(1,"ion-icon",31),s())}function Qi(t,e){t&1&&(r(0,"ion-button",27),l(1,"ion-icon",32),s())}function Ui(t,e){if(t&1&&(r(0,"div",22)(1,"ion-card",23),l(2,"app-img",24),r(3,"ion-card-header",25)(4,"ion-card-title"),C(5),p(6,Ni,2,0,"ion-button",26),p(7,Qi,2,0,"ion-button",27),s()(),r(8,"ion-card-content"),C(9),r(10,"div",28)(11,"ion-button",29),C(12,"Edit"),s(),r(13,"ion-button",30),C(14,"Events"),s(),r(15,"ion-button",30),C(16,"Music"),s()()()()()),t&2){let i=e.$implicit,n=c(4);o(2),a("routerLink",n.editRoute(i))("src",n.image(i)),o(),a("routerLink",n.editRoute(i)),o(2),b("",i.name," "),o(),d(i.pin?6:-1),o(),d(n.isAdmin&&i.status===n.ApprovalStatus.Unapproved?7:-1),o(2),b(" ",i.description," "),o(2),a("disabled",!n.canEditCamp)("routerLink","../camp/"+f(15,ki,i.id)),o(2),a("disabled",!n.canEditEvent)("routerLink","../events")("queryParams",f(17,T,i.id)),o(2),a("disabled",!n.canEditEvent)("routerLink","../music")("queryParams",f(19,T,i.id))}}function zi(t,e){if(t&1&&(r(0,"div",21),w(1,Ui,17,21,"div",22,wi),s()),t&2){let i=c(3);a("ngClass",i.camps.length>1?"grid":"grid1"),o(),I(i.camps)}}function Gi(t,e){t&1&&l(0,"ion-icon",31)}function Di(t,e){t&1&&l(0,"ion-icon",37)}function Yi(t,e){if(t&1&&(r(0,"ion-item"),l(1,"app-img",35),r(2,"ion-text",36),C(3),p(4,Gi,1,0,"ion-icon",31),p(5,Di,1,0,"ion-icon",37),s(),r(6,"div",3)(7,"ion-button",30),C(8,"Events"),s(),r(9,"ion-button",30),C(10,"Music"),s()()()),t&2){let i=e.$implicit,n=c(4);o(),a("width","45px")("height","45px")("routerLink",n.editRoute(i))("src",n.image(i)),o(),a("routerLink",n.editRoute(i)),o(),b(" ",i.name," "),o(),d(i.pin?4:-1),o(),d(n.isAdmin&&i.status===n.ApprovalStatus.Unapproved?5:-1),o(2),a("disabled",!n.canEditEvent)("routerLink","../events")("queryParams",f(14,T,i.id)),o(2),a("disabled",!n.canEditEvent)("routerLink","../music")("queryParams",f(16,T,i.id))}}function qi(t,e){if(t&1&&(r(0,"div",33)(1,"ion-card")(2,"ion-list"),w(3,Yi,11,18,"ion-item",null,wi),s()()(),l(5,"div",34)(6,"div",34)),t&2){let i=c(3);o(3),I(i.camps)}}function $i(t,e){if(t&1&&p(0,zi,3,1,"div",21)(1,qi,7,0),t&2){let i=c(2);d(i.isGrid?0:1)}}function ji(t,e){if(t&1&&(r(0,"div",10)(1,"div",15),p(2,Vi,1,1)(3,Oi,2,1),s(),p(4,$i,2,1),s()),t&2){let i=c();o(),a("ngClass",i.camps.length>0?"":"pad-vertical"),o(),d(i.isAdmin?2:3),o(2),d(i.camps.length>0?4:-1)}}function Hi(t,e){t&1&&l(0,"app-spinner")}function Ki(t,e){if(t&1&&l(0,"app-footer",11),t&2){let i=c();a("routeTo",i.newRoute())}}var v=class v{constructor(){this.api=_(S);this.router=_(z);this.campService=_(E);this.store=_(di);this.inviteEmailService=_(Ti);this.ApprovalStatus=xi;this.vanity=N();this.camps=[];this.busy=!0;this.isAdmin=!1;this.title="";this.festivalTitle="";this.canRegister=!1;this.canEditCamp=!1;this.canAddCamp=!1;this.canEditEvent=!1;this.filteredBySearch=!1;this.imageUrl="";this.isGrid=!1;this.buttons=[];this.progress=P(0);this.overlayTitle=P("");this.searchQuery="";fi({add:mi,locationSharp:_i,listOutline:hi,gridOutline:Ci,alertCircleSharp:ui})}message(e){setTimeout(()=>{this.api.sendMessage(e)},1)}importCSV(){return()=>h(this,null,function*(){if(!this.isAdmin){this.message("You do not have access rights to this feature.");return}this.router.navigateByUrl("./import")})}importKML(){return()=>h(this,null,function*(){if(!this.isAdmin){this.message("You do not have access rights to this feature.");return}this.router.navigateByUrl(`${this.vanity()}/import-kml/camps`)})}exportCSV(){return()=>h(this,null,function*(){if(!this.isAdmin){this.message("You do not have access rights to this feature.");return}this.exportToCSV()})}toggleGrid(){this.isGrid=!this.isGrid,this.store.set("isGrid",`${!this.isGrid}`)}ngOnInit(){return h(this,null,function*(){var e;yield this.api.setFestivalByVanity(this.vanity(),!0),this.title=`${this.api.festivalTitle()}`,this.festivalTitle=this.api.festivalTitle(),this.isAdmin=this.api.isAdmin(this.api.festivalId),this.imageUrl=(e=this.api.imageURL(this.api.festivalImage()))!=null?e:"",this.canAddCamp=this.api.campRegistration()||this.isAdmin,this.canEditCamp=this.api.campRegistration()||this.api.campEditing()||this.isAdmin,this.canEditEvent=this.api.campRegistration()||this.api.eventEditing()||this.isAdmin,this.buttons=this.isAdmin?[{title:"Import CSV",method:this.importCSV(),icon:"cloud-upload-outline"},{title:"Export CSV",method:this.exportCSV(),icon:"cloud-download-outline"},{title:"Export Email Addresses",method:this.exportEmail(),icon:"mail-outline"},{title:"Import KML",method:this.importKML(),icon:"cloud-upload-outline"},{title:"Invite All Theme Camps",method:this.inviteAllCamps(),icon:"mail-outline"}]:[],this.isGrid=this.store.get("isGrid")!=="true"})}inviteAllCamps(){return()=>h(this,null,function*(){if(!this.isAdmin){this.message("You do not have access rights to this feature.");return}yield this.inviteEmailService.inviteAllCamps(this.camps,this.progress)})}exportEmail(){return()=>h(this,null,function*(){this.campService.exportCampsEmail(this.festivalTitle,this.camps)})}ionViewDidEnter(){return h(this,null,function*(){let e=yield this.api.camps({cached:!0}),i=this.store.get("campsSearchQuery");i?(this.searchQuery=i,this.camps=this.filterCamps(e,i),this.filteredBySearch=i.length>0):(this.searchQuery="",this.camps=e,this.filteredBySearch=!1),this.busy=!1})}filterCamps(e,i){let n=i.toLowerCase();return e.filter(m=>m.name.toLowerCase().includes(n))}handleSearch(e){return h(this,null,function*(){let i=e.target.value.toLowerCase();this.searchQuery=i,this.store.set("campsSearchQuery",i||void 0);let n=yield this.api.camps({cached:!0});this.camps=this.filterCamps(n,i),this.filteredBySearch=i.length>0})}editRoute(e){return this.canEditCamp?"../camp/"+e.id:void 0}newRoute(){return this.canEditCamp?"../camp/new":void 0}image(e){return e.imageUrl?this.api.imageURL(e.imageUrl):"./assets/camp.svg"}exportToCSV(){this.campService.exportCampsToCSV(this.festivalTitle,this.camps)}};v.\u0275fac=function(i){return new(i||v)},v.\u0275cmp=R({type:v,selectors:[["app-camps"]],inputs:{vanity:[1,"vanity"]},decls:17,vars:8,consts:[["color","primary"],["slot","start"],["routerLink","../"],["slot","end"],["routerLink","../camp/new",3,"hidden"],["name","add"],[3,"buttons"],[3,"fullscreen"],[3,"title","progress"],[3,"value"],[1,"large-border"],["title","Add Camp",3,"routeTo"],["mode","ios","search-icon","none","show-clear-button","always",3,"ionInput","ngModelChange","debounce","placeholder","ngModel"],["color","dark","fill","clear","slot","end",3,"click"],[3,"name"],[1,"ion-text-center",3,"ngClass"],[3,"title","description"],["title","Registration",3,"description"],["title","Camp Registration",3,"description"],["logo","",1,"logo","ion-padding",3,"width","height","src"],["shape","round",3,"routerLink"],[1,"pad-below",3,"ngClass"],[1,"grid-item"],[1,"clickable"],[3,"routerLink","src"],[3,"routerLink"],["fill","clear","color","light",1,"pin-button"],["fill","clear","color","warning",1,"approval-button"],[1,"dim",2,"text-align","center","padding-top","0.5rem"],["color","secondary",3,"disabled","routerLink"],["color","secondary",3,"disabled","routerLink","queryParams"],["size","small","name","location-sharp",1,"pin"],["size","small","name","alert-circle-sharp"],[1,"border"],[1,"ion-padding"],[1,"clickable",2,"min-width","45px",3,"width","height","routerLink","src"],[1,"clickable",2,"width","100%","padding","1rem",3,"routerLink"],["size","small","color","warning","name","alert-circle-sharp"]],template:function(i,n){i&1&&(r(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),l(3,"ion-back-button"),s(),r(4,"ion-title",2),C(5,"Camps"),s(),r(6,"ion-buttons",3)(7,"ion-button",4),l(8,"ion-icon",5),s(),l(9,"app-side",6),s()()(),r(10,"ion-content",7),p(11,Li,1,2,"app-progress-overlay",8),p(12,Ai,4,4,"ion-toolbar"),p(13,Mi,1,1,"ion-progress-bar",9),p(14,ji,5,3,"div",10)(15,Hi,1,0,"app-spinner"),p(16,Ki,1,1,"app-footer",11),s()),i&2&&(o(7),a("hidden",!n.canAddCamp),o(2),a("buttons",n.buttons),o(),a("fullscreen",!0),o(),d(n.progress()>0?11:-1),o(),d(n.camps.length>1||n.filteredBySearch?12:-1),o(),d(n.progress()>0?13:-1),o(),d(n.busy?15:14),o(2),d(n.isAdmin?16:-1))},dependencies:[ai,ci,oi,vi,U,Q,$,Y,q,D,G,ti,si,K,j,ri,H,ii,li,W,X,Z,J,Ei,ni,ei,gi,bi,yi,Si],styles:["ion-card-title[_ngcontent-%COMP%]{font-size:var(--font-size-medium)!important}ion-card-content[_ngcontent-%COMP%]{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-size:var(--font-size-base)}h1[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.pin[_ngcontent-%COMP%]{color:var(--ion-color-primary);opacity:.5}.pin-button[_ngcontent-%COMP%]{position:absolute;margin-top:calc(-1 * var(--spacing-xs))}.approval-button[_ngcontent-%COMP%]{position:absolute;margin-top:calc(-1 * var(--spacing-xs));right:0}.logo[_ngcontent-%COMP%]{--app-background-color: transparent;--border-radius: .5rem}app-img[_ngcontent-%COMP%]{--border-radius: var(--br-xl)}ion-text[_ngcontent-%COMP%]{font-size:var(--font-size-base)}"]});var Pi=v;export{Pi as CampsPage};
