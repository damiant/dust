import{a as _i}from"./chunk-NIN2XJQV.js";import{a as fi}from"./chunk-K3UGTFX7.js";import{a as hi}from"./chunk-LSC52AIM.js";import{b as A}from"./chunk-QTBNLBDF.js";import{a as Ci}from"./chunk-67ONBALU.js";import{a as gi}from"./chunk-ALTFHMWK.js";import{a as ui}from"./chunk-A7RCF4AZ.js";import{a as di}from"./chunk-GLPG6IXG.js";import"./chunk-OZ2IKH4J.js";import"./chunk-DUKSTT3K.js";import{C as pi,K as ci,M as li,a as si,ea as mi}from"./chunk-MQOPPKG3.js";import{E as L,I as ri,J as y,e as ai}from"./chunk-2K4NO5ZT.js";import"./chunk-PFLI22GG.js";import{$ as w,Ba as x,Cb as $,Cc as ii,Dc as ti,Ec as ei,G as o,Kc as ni,La as f,O as M,Oc as oi,Ta as B,Vb as D,W as l,X as d,Za as F,_ as I,aa as a,ba as r,bc as Y,ca as s,cb as O,cc as q,da as c,dc as j,ec as z,fc as H,hc as K,ia as V,ib as N,jb as G,ka as k,kc as Q,l as R,ma as p,mb as U,p as h,qc as J,rc as W,s as S,t as T,uc as X,w as P,xc as Z,za as m}from"./chunk-OCTOJKK3.js";import"./chunk-JORYF43P.js";import"./chunk-7KGURMOZ.js";import"./chunk-UT2PGJWE.js";import"./chunk-6Y2ASLSF.js";import"./chunk-XRJ4SE6F.js";import"./chunk-LIBYTRNP.js";import"./chunk-3MK77LPM.js";import"./chunk-4U6PRYVA.js";import"./chunk-CZ4AHVKD.js";import"./chunk-Z4V4M3ZT.js";import"./chunk-LLZYEWEK.js";import"./chunk-Z2GS73PT.js";import"./chunk-LF5XB4YN.js";import{h as g}from"./chunk-LNJ3S2LQ.js";var _=class _{constructor(){this.api=h(y)}exportCampsToCSV(e,i){let n=[];for(let u of i)n.push({id:u.id,name:u.name,description:u.description,email:u.contact_email,placed:u.pin!=""?"Yes":"No"});let C=L(e.toLowerCase()," ","-");A(`${C}-camps.csv`,n)}exportCampsEmail(e,i){let n=[];for(let u of i)ai(u.contact_email)||n.push({email:u.contact_email});if(n.length==0){this.api.sendMessage("No Camps have email addresses to be exported.");return}let C=L(e.toLowerCase()," ","-");A(`${C}-camp-email.txt`,n,{stripQuotes:!0,hideHeaders:!0})}};_.\u0275fac=function(i){return new(i||_)},_.\u0275prov=R({token:_,factory:_.\u0275fac,providedIn:"root"});var b=_;var bi=t=>[t],E=t=>({camp:t}),xi=(t,e)=>e.id;function Ei(t,e){if(t&1&&c(0,"app-progress-overlay",8),t&2){let i=p();a("title","Inviting...")("progress",i.progress())}}function Si(t,e){if(t&1){let i=V();r(0,"ion-toolbar")(1,"ion-searchbar",12),k("ionInput",function(C){S(i);let u=p();return T(u.handleSearch(C))}),s(),r(2,"ion-button",13),k("click",function(){S(i);let C=p();return T(C.toggleGrid())}),c(3,"ion-icon",14),s()()}if(t&2){let i=p();o(),a("debounce",600)("placeholder","Search camps at "+i.title),o(2),a("name",i.isGrid?"list-outline":"grid-outline")}}function Ti(t,e){if(t&1&&c(0,"ion-progress-bar",9),t&2){let i=p();a("value",i.progress())}}function Pi(t,e){if(t&1&&c(0,"app-card",16),t&2){let i=p(3);a("title",i.filteredBySearch?"No Camps Found":"No Camps")("description",i.filteredBySearch?"No camps found matching that search":"There are no theme camps registered for "+i.festivalTitle)}}function Ii(t,e){if(t&1&&l(0,Pi,1,2,"app-card",16),t&2){let i=p(2);d(i.camps.length===0?0:-1)}}function wi(t,e){if(t&1&&(r(0,"app-card",17),c(1,"app-img",19),r(2,"ion-button",20),m(3," Register Camp "),s()()),t&2){let i=p(3);a("description","Camp registration for "+i.festivalTitle+" is open."),o(),a("width","100px")("height","100px")("src",i.imageUrl),o(),a("routerLink",i.newRoute())}}function ki(t,e){if(t&1&&c(0,"app-card",18),t&2){let i=p(3);a("description",i.camps.length===0?"Registration for camps at "+i.festivalTitle+" have been disabled. You cannot register a camp at this time.":"Changes to camps at "+i.festivalTitle+" have been disabled. You cannot make any changes at this time.")}}function Li(t,e){if(t&1&&l(0,wi,4,5,"app-card",17)(1,ki,1,1,"app-card",18),t&2){let i=p(2);d(i.camps.length===0&&i.api.campRegistration()?0:!i.api.campRegistration()&&!i.api.campEditing()?1:-1)}}function Ai(t,e){t&1&&(r(0,"ion-button",26),c(1,"ion-icon",30),s())}function Ri(t,e){if(t&1&&(r(0,"div",22)(1,"ion-card",23),c(2,"app-img",24),r(3,"ion-card-header",25)(4,"ion-card-title"),m(5),l(6,Ai,2,0,"ion-button",26),s()(),r(7,"ion-card-content"),m(8),r(9,"div",27)(10,"ion-button",28),m(11,"Edit"),s(),r(12,"ion-button",29),m(13,"Events"),s(),r(14,"ion-button",29),m(15,"Music"),s()()()()()),t&2){let i=e.$implicit,n=p(4);o(2),a("routerLink",n.editRoute(i))("src",n.image(i)),o(),a("routerLink",n.editRoute(i)),o(2),x("",i.name," "),o(),d(i.pin?6:-1),o(2),x(" ",i.description," "),o(2),a("disabled",!n.canEditCamp)("routerLink","../camp/"+f(14,bi,i.id)),o(2),a("disabled",!n.canEditEvent)("routerLink","../events")("queryParams",f(16,E,i.id)),o(2),a("disabled",!n.canEditEvent)("routerLink","../music")("queryParams",f(18,E,i.id))}}function Mi(t,e){if(t&1&&(r(0,"div",21),I(1,Ri,16,20,"div",22,xi),s()),t&2){let i=p(3);a("ngClass",i.camps.length>1?"grid":"grid1"),o(),w(i.camps)}}function Vi(t,e){t&1&&c(0,"ion-icon",30)}function Bi(t,e){if(t&1&&(r(0,"ion-item"),c(1,"app-img",33),r(2,"ion-text",34),m(3),l(4,Vi,1,0,"ion-icon",30),s(),r(5,"div",3)(6,"ion-button",29),m(7,"Events"),s(),r(8,"ion-button",29),m(9,"Music"),s()()()),t&2){let i=e.$implicit,n=p(4);o(),a("width","45px")("height","45px")("routerLink",n.editRoute(i))("src",n.image(i)),o(),a("routerLink",n.editRoute(i)),o(),x(" ",i.name," "),o(),d(i.pin?4:-1),o(2),a("disabled",!n.canEditEvent)("routerLink","../events")("queryParams",f(13,E,i.id)),o(2),a("disabled",!n.canEditEvent)("routerLink","../music")("queryParams",f(15,E,i.id))}}function Fi(t,e){if(t&1&&(r(0,"div",31)(1,"ion-card")(2,"ion-list"),I(3,Bi,10,17,"ion-item",null,xi),s()()(),c(5,"div",32)(6,"div",32)),t&2){let i=p(3);o(3),w(i.camps)}}function Oi(t,e){if(t&1&&l(0,Mi,3,1,"div",21)(1,Fi,7,0),t&2){let i=p(2);d(i.isGrid?0:1)}}function Ni(t,e){if(t&1&&(r(0,"div",10)(1,"div",15),l(2,Ii,1,1)(3,Li,2,1),s(),l(4,Oi,2,1),s()),t&2){let i=p();o(),a("ngClass",i.camps.length>0?"":"pad-vertical"),o(),d(i.isAdmin?2:3),o(2),d(i.camps.length>0?4:-1)}}function Gi(t,e){t&1&&c(0,"app-spinner")}function Ui(t,e){if(t&1&&c(0,"app-footer",11),t&2){let i=p();a("routeTo",i.newRoute())}}var v=class v{constructor(){this.api=h(y);this.router=h(N);this.campService=h(b);this.store=h(ri);this.inviteEmailService=h(_i);this.vanity=B();this.camps=[];this.busy=!0;this.isAdmin=!1;this.title="";this.festivalTitle="";this.canRegister=!1;this.canEditCamp=!1;this.canAddCamp=!1;this.canEditEvent=!1;this.filteredBySearch=!1;this.imageUrl="";this.isGrid=!1;this.buttons=[];this.progress=P(0);this.overlayTitle=P("");mi({add:si,locationSharp:li,listOutline:ci,gridOutline:pi})}message(e){setTimeout(()=>{this.api.sendMessage(e)},1)}importCSV(){return()=>g(this,null,function*(){if(!this.isAdmin){this.message("You do not have access rights to this feature.");return}this.router.navigateByUrl("./import")})}importKML(){return()=>g(this,null,function*(){if(!this.isAdmin){this.message("You do not have access rights to this feature.");return}this.router.navigateByUrl(`${this.vanity()}/import-kml/camps`)})}exportCSV(){return()=>g(this,null,function*(){if(!this.isAdmin){this.message("You do not have access rights to this feature.");return}this.exportToCSV()})}toggleGrid(){this.isGrid=!this.isGrid,this.store.set("isGrid",`${!this.isGrid}`)}ngOnInit(){return g(this,null,function*(){var e;yield this.api.setFestivalByVanity(this.vanity(),!0),this.title=`${this.api.festivalTitle()}`,this.festivalTitle=this.api.festivalTitle(),this.isAdmin=this.api.isAdmin(this.api.festivalId),this.imageUrl=(e=this.api.imageURL(this.api.festivalImage()))!=null?e:"",this.canAddCamp=this.api.campRegistration()||this.isAdmin,this.canEditCamp=this.api.campRegistration()||this.api.campEditing()||this.isAdmin,this.canEditEvent=this.api.campRegistration()||this.api.eventEditing()||this.isAdmin,this.buttons=this.isAdmin?[{title:"Import CSV",method:this.importCSV(),icon:"cloud-upload-outline"},{title:"Export CSV",method:this.exportCSV(),icon:"cloud-download-outline"},{title:"Export Email Addresses",method:this.exportEmail(),icon:"mail-outline"},{title:"Import KML",method:this.importKML(),icon:"cloud-upload-outline"},{title:"Invite All Theme Camps",method:this.inviteAllCamps(),icon:"mail-outline"}]:[],this.isGrid=this.store.get("isGrid")!=="true"})}inviteAllCamps(){return()=>g(this,null,function*(){if(!this.isAdmin){this.message("You do not have access rights to this feature.");return}yield this.inviteEmailService.inviteAllCamps(this.camps,this.progress)})}exportEmail(){return()=>g(this,null,function*(){this.campService.exportCampsEmail(this.festivalTitle,this.camps)})}ionViewDidEnter(){return g(this,null,function*(){this.camps=yield this.api.camps({cached:!0}),this.filteredBySearch=!1,this.busy=!1})}handleSearch(e){return g(this,null,function*(){let i=e.target.value.toLowerCase(),n=yield this.api.camps({cached:!0});this.camps=n.filter(C=>C.name.toLowerCase().includes(i)),this.filteredBySearch=i.length>0})}editRoute(e){return this.canEditCamp?"../camp/"+e.id:void 0}newRoute(){return this.canEditCamp?"../camp/new":void 0}image(e){return e.imageUrl?this.api.imageURL(e.imageUrl):"./assets/camp.svg"}exportToCSV(){this.campService.exportCampsToCSV(this.festivalTitle,this.camps)}};v.\u0275fac=function(i){return new(i||v)},v.\u0275cmp=M({type:v,selectors:[["app-camps"]],inputs:{vanity:[1,"vanity"]},decls:17,vars:8,consts:[["color","primary"],["slot","start"],["routerLink","../"],["slot","end"],["routerLink","../camp/new",3,"hidden"],["name","add"],[3,"buttons"],[3,"fullscreen"],[3,"title","progress"],[3,"value"],[1,"large-border"],["title","Add Camp",3,"routeTo"],["mode","ios","search-icon","none","show-clear-button","always",3,"ionInput","debounce","placeholder"],["color","dark","fill","clear","slot","end",3,"click"],[3,"name"],[1,"ion-text-center",3,"ngClass"],[3,"title","description"],["title","Registration",3,"description"],["title","Camp Registration",3,"description"],["logo","",1,"logo","ion-padding",3,"width","height","src"],["shape","round",3,"routerLink"],[1,"pad-below",3,"ngClass"],[1,"grid-item"],[1,"clickable"],[3,"routerLink","src"],[3,"routerLink"],["fill","clear","color","light",2,"position","absolute","margin-top","-3px"],[1,"dim",2,"text-align","center","padding-top","0.5rem"],["color","secondary",3,"disabled","routerLink"],["color","secondary",3,"disabled","routerLink","queryParams"],["size","small","name","location-sharp",1,"pin"],[1,"border"],[1,"ion-padding"],[1,"clickable",2,"min-width","45px",3,"width","height","routerLink","src"],[1,"clickable",2,"width","100%","padding","1rem",3,"routerLink"]],template:function(i,n){i&1&&(r(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),c(3,"ion-back-button"),s(),r(4,"ion-title",2),m(5,"Camps"),s(),r(6,"ion-buttons",3)(7,"ion-button",4),c(8,"ion-icon",5),s(),c(9,"app-side",6),s()()(),r(10,"ion-content",7),l(11,Ei,1,2,"app-progress-overlay",8),l(12,Si,4,3,"ion-toolbar"),l(13,Ti,1,1,"ion-progress-bar",9),l(14,Ni,5,3,"div",10)(15,Gi,1,0,"app-spinner"),l(16,Ui,1,1,"app-footer",11),s()),i&2&&(o(7),a("hidden",!n.canAddCamp),o(2),a("buttons",n.buttons),o(),a("fullscreen",!0),o(),d(n.progress()>0?11:-1),o(),d(n.camps.length>1||n.filteredBySearch?12:-1),o(),d(n.progress()>0?13:-1),o(),d(n.busy?15:14),o(2),d(n.isAdmin?16:-1))},dependencies:[ii,oi,Z,ui,O,F,$,U,G,J,ei,q,D,ti,Y,Q,ni,j,H,K,z,hi,X,W,di,gi,Ci,fi],styles:["ion-card-title[_ngcontent-%COMP%]{font-size:1.5rem!important}ion-card-content[_ngcontent-%COMP%]{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-size:var(--fs4)}h1[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.pin[_ngcontent-%COMP%]{color:var(--ion-color-primary);opacity:.5}.logo[_ngcontent-%COMP%]{--app-background-color: transparent;--border-radius: .5rem}app-img[_ngcontent-%COMP%]{--border-radius: 5px}ion-text[_ngcontent-%COMP%]{font-size:var(--fs4)}"]});var vi=v;export{vi as CampsPage};
