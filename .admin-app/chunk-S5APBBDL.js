import{b as P}from"./chunk-QTBNLBDF.js";import{C as E,F as T,a as y,n as _,y as b}from"./chunk-BM3VZSH3.js";import{s as O,w}from"./chunk-6CV35SS5.js";import{h as S}from"./chunk-LNJ3S2LQ.js";var l=class l{constructor(){this.api=w(T)}exportEventsToCSV(g,p,c,a){return S(this,null,function*(){var u,v;let m=[],d=yield this.api.camps({cached:!1});for(let i of p){let t=JSON.parse(i.occurrence_set),e=d.find(n=>n.id==i.hosted_by_camp),f=e?e.name:"";for(let n of t){let o=new Date(n.start_time),s=new Date(n.end_time),h=(u=y(o,s,void 0,c))==null?void 0:u.long,J=o.toLocaleDateString([],{weekday:"short",month:"short",day:"numeric"}),N=(v=y(o,s,void 0,c))==null?void 0:v.short,U=b(o,c),x=b(s,c);m.push({id:i.id,title:i.title,description:i.description,type:i.event_type,location:f,startTime:n.start_time,endTime:n.end_time,time:h,shortDay:J,shortTime:N,start24:U,end24:x})}}m.sort((i,t)=>new Date(i.startTime).getTime()-new Date(t.startTime).getTime());let r=E(g.toLowerCase()," ","-");P(`${r}-${a}.csv`,m)})}getPrintableEvents(g,p,c,a){return S(this,null,function*(){var v,i;let m=yield this.api.camps({cached:!1}),d=a?a.split(","):[],r=[];for(let t of p){let e=JSON.parse(t.occurrence_set);for(let f of e){let n=JSON.parse(JSON.stringify(t));n.occurrence_set=JSON.stringify([f]);let o=n.event_type.split(","),s=!1;for(let h of d)o.includes(h)&&(s=!0);s||r.push(n)}}for(let t of r){let e=JSON.parse(t.occurrence_set),f=_(e[0].start_time),n=_(e[0].end_time),o=this.api.currentTimeZone();t.image=void 0;let s=m.find(h=>h.id==t.hosted_by_camp);t.imageUrl?t.image=this.api.imageURL(t.imageUrl):s&&s.imageUrl&&(t.image=this.api.imageURL(s.imageUrl)),t.campUrl=s?`https://${g}.dust.events/camp/u-${s.id}`:"",t.timeString=(v=y(f,n,void 0,o))==null?void 0:v.long}r.sort((t,e)=>{let f=JSON.parse(t.occurrence_set),n=JSON.parse(e.occurrence_set),o=new Date(f[0].start_time),s=new Date(n[0].start_time);return o-s});let u;if(!c)for(let t of r){let e=(i=t.timeString)==null?void 0:i.split(" ");e&&e[0]!==u&&(u=e[0],t.heading=u)}return c?r.filter(t=>{var e;return(e=t.timeString)==null?void 0:e.startsWith(c+" ")}):r})}getEventDays(g,p){return S(this,null,function*(){var m;let c=yield this.getPrintableEvents(g,p),a=[];for(let d of c){let r=(m=d.timeString)==null?void 0:m.split(" ");r&&r[0]&&!a.includes(r[0])&&a.push(r[0])}return a})}};l.\u0275fac=function(p){return new(p||l)},l.\u0275prov=O({token:l,factory:l.\u0275fac,providedIn:"root"});var D=l;export{D as a};
