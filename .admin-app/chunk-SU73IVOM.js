import{b as T}from"./chunk-QTBNLBDF.js";import{a as S,l as y,r as _,u as w,x as E}from"./chunk-OKHR5JXS.js";import{s as b,w as O}from"./chunk-SLKJQVFW.js";import{h}from"./chunk-LNJ3S2LQ.js";var f=class f{constructor(){this.api=O(E)}exportEventsToCSV(l,c,r,u){return h(this,null,function*(){var g,v;let m=[],n=yield this.api.camps({cached:!1});for(let e of c){let t=JSON.parse(e.occurrence_set),a=n.find(i=>i.id==e.hosted_by_camp),o=a?a.name:"";for(let i of t){let s=new Date(i.start_time),p=new Date(i.end_time),D=(g=S(s,p,void 0,r))==null?void 0:g.long,J=s.toLocaleDateString([],{weekday:"short",month:"short",day:"numeric"}),N=(v=S(s,p,void 0,r))==null?void 0:v.short,x=_(s,r),U=_(p,r);m.push({id:e.id,title:e.title,description:e.description,type:e.event_type,location:o,startTime:i.start_time,endTime:i.end_time,time:D,shortDay:J,shortTime:N,start24:x,end24:U})}}m.sort((e,t)=>new Date(e.startTime).getTime()-new Date(t.startTime).getTime());let d=w(l.toLowerCase()," ","-");T(`${d}-${u}.csv`,m)})}getPrintableEvents(l,c,r){return h(this,null,function*(){var g,v;let u=yield this.api.camps({cached:!1}),m=r?r.split(","):[],n=[];for(let e of l){let t=JSON.parse(e.occurrence_set);for(let a of t){let o=JSON.parse(JSON.stringify(e));o.occurrence_set=JSON.stringify([a]);let i=o.event_type.split(","),s=!1;for(let p of m)i.includes(p)&&(s=!0);s||n.push(o)}}for(let e of n){let t=JSON.parse(e.occurrence_set),a=y(t[0].start_time),o=y(t[0].end_time),i=this.api.currentTimeZone();e.image=void 0;let s=u.find(p=>p.id==e.hosted_by_camp);e.imageUrl?e.image=this.api.imageURL(e.imageUrl):s&&s.imageUrl&&(e.image=this.api.imageURL(s.imageUrl)),e.timeString=(g=S(a,o,void 0,i))==null?void 0:g.long}n.sort((e,t)=>{let a=JSON.parse(e.occurrence_set),o=JSON.parse(t.occurrence_set),i=new Date(a[0].start_time),s=new Date(o[0].start_time);return i-s});let d;if(!c)for(let e of n){let t=(v=e.timeString)==null?void 0:v.split(" ");t&&t[0]!==d&&(d=t[0],e.heading=d)}return c?n.filter(e=>{var t;return(t=e.timeString)==null?void 0:t.startsWith(c+" ")}):n})}getEventDays(l){return h(this,null,function*(){var u;let c=yield this.getPrintableEvents(l),r=[];for(let m of c){let n=(u=m.timeString)==null?void 0:u.split(" ");n&&n[0]&&!r.includes(n[0])&&r.push(n[0])}return r})}};f.\u0275fac=function(c){return new(c||f)},f.\u0275prov=b({token:f,factory:f.\u0275fac,providedIn:"root"});var P=f;export{P as a};
