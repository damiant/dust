import{a as se}from"./chunk-FNWCYAF5.js";import{a as le}from"./chunk-TOSLD3EX.js";import"./chunk-WVEW2PMG.js";import{a as re}from"./chunk-55PDQDPP.js";import"./chunk-TUKQZ63R.js";import{E as ie,M as ne,O as oe,Q as v,a as X,h as Y,q as Z,r as ee,y as te}from"./chunk-XRDDS2KJ.js";import{w as Q}from"./chunk-A5NTSXZY.js";import{$ as f,A as L,Aa as g,B as b,Ba as R,I as y,Ka as V,Lb as B,O as P,Pa as _,Qb as G,Rb as N,S as a,Sb as $,T,Tb as j,X as d,Xa as C,Yb as W,cb as A,cc as z,da as p,db as O,dc as U,fc as q,ga as k,gb as D,ia as w,ja as E,ka as l,la as r,ma as s,nc as J,oa as M,oc as K,pa as S,qa as c,sb as H,uc as x}from"./chunk-SLKJQVFW.js";import"./chunk-35XJAIHY.js";import"./chunk-7KGURMOZ.js";import"./chunk-W5R2B4OG.js";import"./chunk-SDKY465T.js";import"./chunk-45ASMX5N.js";import"./chunk-KM5AR3OJ.js";import"./chunk-XCRBEL2Y.js";import"./chunk-4U6PRYVA.js";import"./chunk-HJX2WMCX.js";import"./chunk-Z4V4M3ZT.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{h as F}from"./chunk-LNJ3S2LQ.js";function fe(i,t){if(i&1){let e=M();l(0,"ion-item",2),S("click",function(){L(e);let o=c();return b(o.link(o.url()))}),s(1,"ion-icon",3),g(2),r()}if(i&2){let e=c();a(),p("name",e.icon()),a(),R(e.text())}}function ke(i,t){if(i&1){let e=M();l(0,"div",4),S("click",function(){L(e);let o=c();return b(o.link(o.url()))}),r()}if(i&2){let e=c();p("innerHTML",e.html(),P)}}var m=class m{constructor(){this.text=y("");this.url=y("");this.icon=_(()=>{let t=this.url(),e=this.text();return console.log(t),t.includes("tel:")||t.includes("sms:")?"call-outline":t.includes("mailto:")?"mail-outline":t.includes("maps.")?"compass-outline":t.includes("youtu.")?"tv-outline":e.includes("ticket")?"ticket-outline":"link-outline"});this.simple=_(()=>!this.text().includes("<"));this.html=_(()=>{let t=this.text();return this.removeTagsExceptAllowed(t,["b","h1","h2","h3","h4","code","img","small","br","center","p","i","u","ul","li","ol"])});v({linkOutline:te,compass:Z,compassOutline:ee,callOutline:Y,mailOutline:ie,ticketOutline:ne,tvOutline:oe})}link(t){console.log("click",t)}removeTagsExceptAllowed(t,e){let n=e.map(ce).join("|"),o=new RegExp("</?([^>]+)(?:>)(?!</\\1>)","gi");function ce(I){return I.replace(/([\\\/<>+\-*!(){}.^$|\[\]])/g,"\\$&")}return t.replace(o,(I,me)=>n.includes(me)?I:"")}};m.\u0275fac=function(e){return new(e||m)},m.\u0275cmp=d({type:m,selectors:[["app-link"]],inputs:{text:[1,"text"],url:[1,"url"]},decls:2,vars:1,consts:[["lines","none","detail","true"],[3,"innerHTML"],["lines","none","detail","true",3,"click"],["slot","start",3,"name"],[3,"click","innerHTML"]],template:function(e,n){e&1&&f(0,fe,3,2,"ion-item",0)(1,ke,1,1,"div",1),e&2&&k(n.simple()?0:1)},dependencies:[x,U,C],encapsulation:2});var h=m;var pe=(i,t)=>t.id,ge=i=>[i];function _e(i,t){if(i&1&&s(0,"app-link",10),i&2){let e=t.$implicit;p("routerLink","../link/"+V(2,ge,e.id))("text",e.title)}}function Ce(i,t){if(i&1&&(l(0,"ion-card")(1,"ion-card-content")(2,"ion-list"),w(3,_e,1,4,"app-link",10,pe),r()()()),i&2){let e=t.$implicit;a(3),E(e.links)}}function xe(i,t){if(i&1&&(s(0,"app-image-card",9),w(1,Ce,5,0,"ion-card",null,pe)),i&2){let e=c();p("url",e.festivalImage())("title",e.title)("description",e.groups.length===0?"Links are buttons that appear in the dust app that will open a browser window, call a phone number or email.":""),a(),E(e.groups)}}function ve(i,t){i&1&&s(0,"app-spinner")}var u=class u{constructor(t,e){this.api=t;this.router=e;this.title="";this.busy=!0;this.groups=[];v({add:X})}ionViewWillEnter(){return F(this,null,function*(){this.busy=!0,yield this.api.setFestivalByVanity(this.vanity),this.title=this.api.festivalTitle(),this.groups=this.group(yield this.api.links()),console.log(this.groups),this.busy=!1})}group(t){let e=[],n={id:1,links:[]};for(let o of t)o.title.startsWith("#")&&(o.title=o.title.substring(1),n.links.length>0&&(e.push(n),n={id:n.id+1,links:[]})),n.links.push(o);return e.push(n),e}festivalImage(){return this.api.imageURL(this.api.festivalImage())}};u.\u0275fac=function(e){return new(e||u)(T(Q),T(A))},u.\u0275cmp=d({type:u,selectors:[["app-links"]],inputs:{vanity:"vanity"},decls:14,vars:2,consts:[["color","primary"],["slot","start"],["routerLink","../"],["slot","end"],["routerLink","../link/new"],["name","add"],[3,"fullscreen"],[1,"border"],["title","Add Link","routeTo","../link/new"],["routeTo","../link/new",3,"url","title","description"],[1,"clickable",3,"routerLink","text"]],template:function(e,n){e&1&&(l(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),s(3,"ion-back-button"),r(),l(4,"ion-title",2),g(5,"Links"),r(),l(6,"ion-buttons",3)(7,"ion-button",4),s(8,"ion-icon",5),r()()()(),l(9,"ion-content",6)(10,"div",7),f(11,xe,3,3)(12,ve,1,0,"app-spinner"),r(),s(13,"app-footer",8),r()),e&2&&(a(9),p("fullscreen",!0),a(2),k(n.busy?12:11))},dependencies:[C,re,H,D,O,z,K,N,B,J,G,W,x,$,se,j,q,le,h],styles:["ion-item[_ngcontent-%COMP%]{cursor:pointer}"]});var ae=u;export{ae as LinksPage};
