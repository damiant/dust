import{A as u,M as p,R as m,Ua as h,la as d,p as l}from"./chunk-FDEJMFAU.js";function v(e){if(!e.name||e.name.trim()==="")return"Field name cannot be empty";if(!["string","boolean","values"].includes(e.type))return`Invalid field type: ${e.type}`;if(e.type==="string"){if(e.maxLines!==void 0&&(e.maxLines<1||e.maxLines>1e3))return`maxLines must be between 1 and 1000, got ${e.maxLines}`;if(e.maxLength!==void 0&&(e.maxLength<1||e.maxLength>1e4))return`maxLength must be between 1 and 10000, got ${e.maxLength}`}if(e.type==="values"&&(!e.values||!Array.isArray(e.values)||e.values.length===0))return"Values field must have at least one value";if(!["user","admin","readadmin"].includes(e.scope))return`Invalid scope: ${e.scope}`;if(typeof e.required!="boolean")return"Required must be a boolean";if(e.helperText!==void 0&&e.helperText!==null){if(typeof e.helperText!="string")return"Helper text must be a string";if(e.helperText.length>500)return"Helper text cannot exceed 500 characters"}return null}function f(e,t){if(t.required){if(e==null||e==="")return`${t.name} is required`;if(typeof e=="string"&&e.trim()==="")return`${t.name} is required`}if(e==null||e==="")return null;if(t.type==="string"){if(typeof e!="string")return`${t.name} must be a string`;if(t.maxLength&&e.length>t.maxLength)return`${t.name} cannot exceed ${t.maxLength} characters`}else if(t.type==="boolean"){if(typeof e!="boolean")return`${t.name} must be a boolean`}else if(t.type==="values"&&(!t.values||!t.values.includes(e)))return`${t.name} has an invalid value`;return null}function y(e,t){let i=[],o=new Map(e.map(n=>[n.name,n.value]));for(let n of t){let r=o.get(n.name),a=f(r!=null?r:null,n);a&&i.push({fieldName:n.name,message:a})}return i}function F(e){if(!e)return[];try{let t=JSON.parse(e);return Array.isArray(t)?t:(console.error("Parsed data is not an array"),[])}catch(t){return console.error("Failed to parse field values:",t),[]}}function b(e,t){switch(e){case"user":return"This question is not shared to the public";case"admin":return`${t} is only visible to Dust admins`;case"readadmin":return`${t} was supplied by a user but is now only visible to Dust admins`;default:return""}}function g(e){return e.type==="boolean"?!1:""}function D(e,t,i){let o=e.findIndex(n=>n.name===t);if(o>=0){let n=[...e];return n[o]={name:t,value:i},n}else return[...e,{name:t,value:i}]}function E(e,t){var o;let i=new Map((o=t==null?void 0:t.map(n=>[n.name,n.value]))!=null?o:[]);return e.map(n=>{var r;return{name:n.name,value:(r=i.get(n.name))!=null?r:g(n)}})}var s=class s{constructor(){this.tooltipText=h(void 0,{alias:"appHoverTooltip"});this.tooltipElement=null;this.hideTimeout=null;this.showTimeout=null;this.el=l(u);this.renderer=l(p)}onMouseEnter(){this.scheduleShow()}onMouseLeave(){this.clearShowTimeout(),this.hideTooltip()}scheduleShow(){this.clearShowTimeout(),this.showTimeout=setTimeout(()=>{this.showTooltip(),this.scheduleHide()},2e3)}clearShowTimeout(){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=null)}showTooltip(){if(this.tooltipText()===void 0||this.tooltipText()==="")return;this.hideTooltip(),this.tooltipElement=this.renderer.createElement("div"),this.renderer.addClass(this.tooltipElement,"hover-tooltip"),this.renderer.setProperty(this.tooltipElement,"textContent",this.tooltipText()),this.renderer.setStyle(this.tooltipElement,"cursor","pointer"),this.renderer.listen(this.tooltipElement,"click",()=>{this.hideTooltip()}),this.renderer.appendChild(document.body,this.tooltipElement);let t=this.el.nativeElement.getBoundingClientRect(),o=this.el.nativeElement.tagName.toLowerCase()==="ion-checkbox"?118:58;this.renderer.setStyle(this.tooltipElement,"position","fixed"),this.renderer.setStyle(this.tooltipElement,"top",`${t.top-o}px`),this.renderer.setStyle(this.tooltipElement,"left",`${t.left}px`)}scheduleHide(){this.hideTimeout&&clearTimeout(this.hideTimeout),this.hideTimeout=setTimeout(()=>{this.hideTooltip()},5e3)}hideTooltip(){this.tooltipElement&&(this.tooltipElement.parentNode&&this.renderer.removeChild(this.tooltipElement.parentNode,this.tooltipElement),this.tooltipElement=null),this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null),this.clearShowTimeout()}ngOnDestroy(){this.hideTooltip()}};s.\u0275fac=function(i){return new(i||s)},s.\u0275dir=m({type:s,selectors:[["","appHoverTooltip",""]],hostBindings:function(i,o){i&1&&d("mouseenter",function(){return o.onMouseEnter()})("mouseleave",function(){return o.onMouseLeave()})},inputs:{tooltipText:[1,"appHoverTooltip","tooltipText"]}});var c=s;export{v as a,y as b,F as c,b as d,D as e,E as f,c as g};
