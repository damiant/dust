import{a as de}from"./chunk-TQS35TTB.js";import{a as ce}from"./chunk-FLMQE4JK.js";import{a as le}from"./chunk-4TINRQR4.js";import{a as re}from"./chunk-S6IHJUHU.js";import"./chunk-TUKQZ63R.js";import{A as oe,R as se,a as ne,w as ae}from"./chunk-OAPJ7RFL.js";import{a as ie}from"./chunk-MIGJGGKJ.js";import{d as Z,h as F,y as ee,z as te}from"./chunk-3H2U6HXL.js";import{$ as _,A as h,Aa as l,B as C,Ba as v,Ea as E,Pb as V,Qb as L,Rb as N,S as a,Sb as R,T as w,Ta as U,X as k,Xa as A,Xb as $,bc as j,cb as D,cc as H,da as c,db as O,dc as z,ec as W,fc as q,ga as d,gb as B,ha as b,ia as I,ja as S,ka as n,la as o,lc as J,ma as m,mc as K,nc as Q,oa as y,pa as x,qa as s,rb as G,tc as X,w as T,xc as Y}from"./chunk-PNZTRGP7.js";import"./chunk-35XJAIHY.js";import"./chunk-7KGURMOZ.js";import"./chunk-W5R2B4OG.js";import"./chunk-SDKY465T.js";import"./chunk-45ASMX5N.js";import"./chunk-KM5AR3OJ.js";import"./chunk-XCRBEL2Y.js";import"./chunk-4U6PRYVA.js";import"./chunk-HJX2WMCX.js";import"./chunk-Z4V4M3ZT.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{a as P,b as M,h as g}from"./chunk-LNJ3S2LQ.js";function pe(i,t){i&1&&(n(0,"ion-button",2),m(1,"ion-icon",5),o())}function _e(i,t){i&1&&m(0,"app-spinner")}function ve(i,t){if(i&1){let e=y();n(0,"ion-toolbar")(1,"ion-searchbar",10),x("ionInput",function(p){h(e);let u=s(2);return C(u.handleSearch(p))}),o(),n(2,"ion-button",11),x("click",function(){h(e);let p=s(2);return C(p.toggleGrid())}),m(3,"ion-icon",12),o()()}if(i&2){let e=s(2);a(),c("debounce",600)("placeholder","Search burns"),a(2),c("name",e.isGrid?"list-outline":"grid-outline")}}function fe(i,t){i&1&&(n(0,"div",8)(1,"h1"),l(2,"Getting Started"),o(),n(3,"h4",13),l(4," As a regional organizer you can click the button below to create a new regional burn. "),o()())}function ue(i,t){if(i&1&&m(0,"app-img",16),i&2){let e=s().$implicit;c("height","100%")("src",e.imageUrl)}}function ge(i,t){if(i&1){let e=y();n(0,"div",14)(1,"ion-card",15),x("click",function(){let p=h(e).$implicit,u=s(3);return C(u.open("/"+p.vanity))}),_(2,ue,1,2,"app-img",16),n(3,"ion-card-content",17)(4,"h1"),l(5),o()()(),n(6,"ion-text",18),l(7),o()()}if(i&2){let e=t.$implicit;a(2),d(e.imageUrl?2:-1),a(3),v(e.name),a(2),v(e.name)}}function he(i,t){if(i&1&&I(0,ge,8,3,"div",14,b),i&2){let e=s(2);S(e.festivals)}}function Ce(i,t){i&1&&(n(0,"p"),l(1,"Dates are not known"),o())}function xe(i,t){if(i&1&&(n(0,"p"),l(1),o()),i&2){let e=s().$implicit;a(),E(" ",e.start," - ",e.end," (in ",e.daysUntil," days) ")}}function ye(i,t){if(i&1){let e=y();n(0,"ion-item",20),x("click",function(){let p=h(e).$implicit,u=s(3);return C(u.open("/"+p.vanity))}),m(1,"app-img",21),n(2,"ion-label")(3,"span"),l(4),o(),_(5,Ce,2,0,"p")(6,xe,2,3,"p"),o(),n(7,"ion-note",1),l(8),o(),n(9,"ion-note",1),l(10),o()()}if(i&2){let e=t.$implicit,r=s(3);c("ngClass",r.classFor(e)),a(),c("width","45px")("height","45px")("src",e.imageUrl),a(3),v(e.name),a(),d(e.unknown_dates?5:6),a(3),v(e.note),a(2),v(e.active?"In Dust":"Hidden")}}function Fe(i,t){if(i&1&&(n(0,"div",9)(1,"ion-card")(2,"ion-list"),I(3,ye,11,8,"ion-item",19,b),o()()()),i&2){let e=s(2);c("ngClass",e.festivals.length>0?"":"pad-vertical"),a(3),S(e.festivals)}}function we(i,t){if(i&1&&(_(0,ve,4,3,"ion-toolbar"),n(1,"div",6)(2,"div",7),_(3,fe,5,0,"div",8)(4,he,2,0)(5,Fe,5,1,"div",9),o()()),i&2){let e=s();d(e.festivals.length>1||e.filteredBySearch?0:-1),a(3),d(e.noData?3:-1),a(),d(e.isGrid?4:5)}}function be(i,t){i&1&&m(0,"app-footer",4)}var f=class f{constructor(t,e){this.api=t;this.router=e;this.store=T(ee);this.publishing=!1;this.busy=!0;this.addAllowed=!1;this.noData=!1;this.isGrid=!0;this.isNative=ie.isNativePlatform();this.filteredBySearch=!1;this.festivals=[];se({add:ne,listOutline:oe,gridOutline:ae})}ngOnInit(){this.isGrid=this.store.get("isFestivalList")!=="false"}ionViewWillEnter(){return g(this,null,function*(){if(!this.api.signedIn()){this.router.navigateByUrl("/auth");return}try{this.busy=!0;let t=sessionStorage.openburn;if(!Z(t)){this.router.navigateByUrl(`/${t}`);return}yield this.getData(),this.sort();let e=this.api.getAccessInfo(void 0);this.addAllowed=!1,e.hasAdmin&&(this.addAllowed=!0),!e.hasAdmin&&!e.hasCamps&&!e.hasMusic&&!e.hasArt&&!e.hasCamps&&(this.addAllowed=!0),this.noData=this.addAllowed&&this.festivals.length==0}finally{this.busy=!1}})}handleSearch(t){return g(this,null,function*(){let e=t.target.value.toLowerCase();yield this.getData(e),this.filteredBySearch=e.length>0,this.sort()})}getData(t){return g(this,null,function*(){let e=!this.isGrid;this.festivals=this.asFestivalModels(yield this.api.getFestivals(e)),t&&(this.festivals=this.festivals.filter(r=>r.name.toLowerCase().includes(t))),this.festivals.map(r=>{r.imageUrl=this.api.imageURL(r.imageUrl)})})}toggleGrid(){return g(this,null,function*(){this.isGrid=!this.isGrid,this.store.set("isFestivalList",this.isGrid.toString()),yield this.getData(),this.sort()})}open(t){this.api.clearCache(),this.router.navigateByUrl(t)}asFestivalModels(t){return t.map(e=>M(P({},e),{daysUntil:F(e.start_time),start:this.niceFormat(e.start_time),end:this.niceFormat(e.end_time),note:F(e.start_time)>0?F(e.start_time)+" days":e.archived?"Archived":"Past"}))}niceFormat(t){return new Date(t).toLocaleDateString()}classFor(t){return t.active?"":t.daysUntil<0?"past":"hidden"}sort(){this.isGrid?this.filteredBySearch?this.festivals.sort((t,e)=>t.name.localeCompare(e.name)):this.festivals.sort((t,e)=>t.daysUntil!==e.daysUntil?e.daysUntil-t.daysUntil:t.name.localeCompare(e.name)):this.festivals.sort((t,e)=>new Date(t.start_time)>new Date(e.start_time)?-1:1)}};f.\u0275fac=function(e){return new(e||f)(w(te),w(D))},f.\u0275cmp=k({type:f,selectors:[["app-festivals"]],decls:11,vars:4,consts:[["color","primary"],["slot","end"],["routerLink","../new"],[3,"fullscreen"],["title","New Regional Burn","routeTo","../new"],["name","add"],[1,"large-border"],[1,"container"],[2,"display","flex","align-items","center","flex-direction","column","justify-content","center","height","70vh"],[1,"ion-text-center",3,"ngClass"],["mode","ios","search-icon","none","show-clear-button","always",3,"ionInput","debounce","placeholder"],["color","dark","fill","clear","slot","end",3,"click"],[3,"name"],[1,"ion-padding","ion-text-center"],[1,"ion-text-center","ion-padding"],["color","light",1,"card",3,"click"],[3,"height","src"],[1,"xcenter"],["color","medium"],[1,"clickable","hoverable",3,"ngClass"],[1,"clickable","hoverable",3,"click","ngClass"],[2,"min-width","45px",3,"width","height","src"]],template:function(e,r){e&1&&(n(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),l(3,"dust"),o(),n(4,"ion-buttons",1),_(5,pe,2,0,"ion-button",2),m(6,"app-side"),o()()(),n(7,"ion-content",3),_(8,_e,1,0,"app-spinner")(9,we,6,3)(10,be,1,0,"app-footer",4),o()),e&2&&(a(5),d(r.isNative?-1:5),a(2),c("fullscreen",!0),a(),d(r.busy?8:9),a(2),d(r.addAllowed?10:-1))},dependencies:[Y,z,q,H,W,J,A,U,ce,re,le,G,B,O,j,Q,K,L,V,$,X,N,R,de],styles:[".container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;flex-wrap:wrap}.card[_ngcontent-%COMP%]{min-width:300px;height:300px;border-radius:10px;flex-basis:40%;cursor:pointer}.hoverable[_ngcontent-%COMP%]:hover{--background: var(--ion-color-light)}.xcenter[_ngcontent-%COMP%]{text-align:center;display:flex;justify-content:center;align-items:center;height:300px}app-img[_ngcontent-%COMP%]{--border-radius: 5px;padding-right:1rem;width:60px}ion-item[_ngcontent-%COMP%]{width:600px;max-width:100vw}.hidden[_ngcontent-%COMP%]{opacity:.5}.past[_ngcontent-%COMP%]{opacity:.75}"]});var me=f;export{me as FestivalsPage};
