import{a as st}from"./chunk-WRGGOKAP.js";import{a as lt}from"./chunk-JZDWCQD5.js";import"./chunk-ISEFS2E5.js";import{a as rt}from"./chunk-ROJXBKDX.js";import"./chunk-W4BNGQYG.js";import{G as et,M as it,U as nt,W as ot,Y as v,a as X,i as Y,v as Z,w as tt}from"./chunk-IKEGAJLW.js";import{G as Q}from"./chunk-YDFKN7Z7.js";import"./chunk-XMQYHBKU.js";import{$ as c,$a as O,C as P,Ea as V,G as a,Ha as _,I as b,Ka as S,Kb as G,L as d,Rb as H,Sb as $,Tb as N,Ua as x,Ub as j,V as f,W as k,Z as T,Zb as W,_ as w,_a as A,aa as l,ba as r,ca as s,cb as D,dc as z,ea as E,ec as U,fa as M,ga as p,gc as q,oc as J,pc as K,rb as B,s as L,sa as g,t as y,ta as R,vc as C}from"./chunk-A5SCVZG7.js";import"./chunk-JORYF43P.js";import"./chunk-7KGURMOZ.js";import"./chunk-R7LHOHUY.js";import"./chunk-HUOLUIW7.js";import"./chunk-CCK7OWI7.js";import"./chunk-LIBYTRNP.js";import"./chunk-3MK77LPM.js";import"./chunk-4U6PRYVA.js";import"./chunk-CZ4AHVKD.js";import"./chunk-Z4V4M3ZT.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{h as F}from"./chunk-LNJ3S2LQ.js";function ft(i,e){if(i&1){let t=E();l(0,"ion-item",2),M("click",function(){L(t);let o=p();return y(o.link(o.url()))}),s(1,"ion-icon",3),g(2),r()}if(i&2){let t=p();a(),c("name",t.icon()),a(),R(t.text())}}function kt(i,e){if(i&1){let t=E();l(0,"div",4),M("click",function(){L(t);let o=p();return y(o.link(o.url()))}),r()}if(i&2){let t=p();c("innerHTML",t.html(),P)}}var m=class m{constructor(){this.text=S("");this.url=S("");this.icon=_(()=>{let e=this.url(),t=this.text();return console.log(e),e.includes("tel:")||e.includes("sms:")?"call-outline":e.includes("mailto:")?"mail-outline":e.includes("maps.")?"compass-outline":e.includes("youtu.")?"tv-outline":t.includes("ticket")?"ticket-outline":"link-outline"});this.simple=_(()=>!this.text().includes("<"));this.html=_(()=>{let e=this.text();return this.removeTagsExceptAllowed(e,["b","h1","h2","h3","h4","code","img","small","br","center","p","i","u","ul","li","ol"])});v({linkOutline:et,compass:Z,compassOutline:tt,callOutline:Y,mailOutline:it,ticketOutline:nt,tvOutline:ot})}link(e){console.log("click",e)}removeTagsExceptAllowed(e,t){let n=t.map(pt).join("|"),o=new RegExp("</?([^>]+)(?:>)(?!</\\1>)","gi");function pt(I){return I.replace(/([\\\/<>+\-*!(){}.^$|\[\]])/g,"\\$&")}return e.replace(o,(I,mt)=>n.includes(mt)?I:"")}};m.\u0275fac=function(t){return new(t||m)},m.\u0275cmp=d({type:m,selectors:[["app-link"]],inputs:{text:[1,"text"],url:[1,"url"]},decls:2,vars:1,consts:[["lines","none","detail","true"],[3,"innerHTML"],["lines","none","detail","true",3,"click"],["slot","start",3,"name"],[3,"click","innerHTML"]],template:function(t,n){t&1&&f(0,ft,3,2,"ion-item",0)(1,kt,1,1,"div",1),t&2&&k(n.simple()?0:1)},dependencies:[C,U,x],encapsulation:2});var h=m;var gt=i=>[i],ct=(i,e)=>e.id;function _t(i,e){if(i&1&&s(0,"app-link",10),i&2){let t=e.$implicit;c("routerLink","../link/"+V(2,gt,t.id))("text",t.title)}}function xt(i,e){if(i&1&&(l(0,"ion-card")(1,"ion-card-content")(2,"ion-list"),T(3,_t,1,4,"app-link",10,ct),r()()()),i&2){let t=e.$implicit;a(3),w(t.links)}}function Ct(i,e){if(i&1&&(s(0,"app-image-card",9),T(1,xt,5,0,"ion-card",null,ct)),i&2){let t=p();c("url",t.festivalImage())("title",t.title)("description",t.groups.length===0?"Links are buttons that appear in the dust app that will open a browser window, call a phone number or email.":""),a(),w(t.groups)}}function vt(i,e){i&1&&s(0,"app-spinner")}var u=class u{constructor(e,t){this.api=e;this.router=t;this.title="";this.busy=!0;this.groups=[];v({add:X})}ionViewWillEnter(){return F(this,null,function*(){this.busy=!0,yield this.api.setFestivalByVanity(this.vanity),this.title=this.api.festivalTitle(),this.groups=this.group(yield this.api.links()),console.log(this.groups),this.busy=!1})}group(e){let t=[],n={id:1,links:[]};for(let o of e)o.title.startsWith("#")&&(o.title=o.title.substring(1),n.links.length>0&&(t.push(n),n={id:n.id+1,links:[]})),n.links.push(o);return t.push(n),t}festivalImage(){return this.api.imageURL(this.api.festivalImage())}};u.\u0275fac=function(t){return new(t||u)(b(Q),b(A))},u.\u0275cmp=d({type:u,selectors:[["app-links"]],inputs:{vanity:"vanity"},decls:14,vars:2,consts:[["color","primary"],["slot","start"],["routerLink","../"],["slot","end"],["routerLink","../link/new"],["name","add"],[3,"fullscreen"],[1,"border"],["title","Add Link","routeTo","../link/new"],["routeTo","../link/new",3,"url","title","description"],[1,"clickable",3,"routerLink","text"]],template:function(t,n){t&1&&(l(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),s(3,"ion-back-button"),r(),l(4,"ion-title",2),g(5,"Links"),r(),l(6,"ion-buttons",3)(7,"ion-button",4),s(8,"ion-icon",5),r()()()(),l(9,"ion-content",6)(10,"div",7),f(11,Ct,3,3)(12,vt,1,0,"app-spinner"),r(),s(13,"app-footer",8),r()),t&2&&(a(9),c("fullscreen",!0),a(2),k(n.busy?12:11))},dependencies:[x,rt,B,D,O,z,K,$,G,J,H,W,C,N,st,j,q,lt,h],styles:["ion-item[_ngcontent-%COMP%]{cursor:pointer}"]});var at=u;export{at as LinksPage};
