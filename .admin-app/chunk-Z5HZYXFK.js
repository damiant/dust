import{Db as M,Fa as _,Ga as c,H as p,Ha as h,J as u,Nc as G,P as f,ca as g,da as d,ja as C,la as m,ra as w,s,sa as y,t as l,ta as b,tb as v,wb as V}from"./chunk-FDEJMFAU.js";var I=["container"],a=class a{constructor(){this.gpsChange=new u;this.latChange=new u;this.lngChange=new u;this.disabled=!1}init(){console.log("listen for paste"),this.disabled=!1,this._listener=this.listener.bind(this),addEventListener("paste",this._listener)}listener(r){let i=r.clipboardData;this.container.nativeElement.focus();let e=i==null?void 0:i.getData("Text");!e||!e.includes(",")||(document.activeElement.blur(),console.log("blur called"),setTimeout(()=>{if(this.disabled){console.log("Ignore paste");return}let n=e.split(",");this.lat=this.round(n[0]),this.lng=this.round(n[1]),console.log(`Pasted GPS: ${this.lat}, ${this.lng}`),this.gpsChange.emit({lat:this.lat,lng:this.lng})},200))}dest(){setTimeout(()=>{this.cleanup()},500)}ngOnDestroy(){this.cleanup()}applyGPS(){setTimeout(()=>{this.gpsChange.emit({lat:this.lat,lng:this.lng})},1)}filterInput(r,i){let e=r.target,n=e.value,t=n.replace(/[^0-9.-]/g,"");console.log(`Filtered ${i} input: ${n} to ${t}`),n!==t&&(e.value=t,i==="lat"?this.lat=t?Number(t):void 0:this.lng=t?Number(t):void 0)}cleanup(){console.log("unlisten for paste"),this.disabled=!0,removeEventListener("paste",this._listener)}round(r){let i=Number(r.trim());return Number(i.toFixed(7))}};a.\u0275fac=function(i){return new(i||a)},a.\u0275cmp=f({type:a,selectors:[["app-gps"]],viewQuery:function(i,e){if(i&1&&w(I,5),i&2){let n;y(n=b())&&(e.container=n.first)}},inputs:{lat:"lat",lng:"lng"},outputs:{gpsChange:"gpsChange",latChange:"latChange",lngChange:"lngChange"},decls:4,vars:2,consts:[["container",""],[2,"display","flex"],["label","latitude","labelPlacement","stacked",3,"ionFocus","ionBlur","ionInput","ngModelChange","ngModel"],["label","longitude","labelPlacement","stacked",3,"ionFocus","ionBlur","ionInput","ngModelChange","ngModel"]],template:function(i,e){if(i&1){let n=C();g(0,"div",1,0)(2,"ion-input",2),m("ionFocus",function(){return s(n),l(e.init())})("ionBlur",function(){return s(n),l(e.dest())})("ionInput",function(o){return s(n),l(e.filterInput(o,"lat"))})("ngModelChange",function(){return s(n),l(e.applyGPS())}),h("ngModelChange",function(o){return s(n),c(e.lat,o)||(e.lat=o),l(o)}),d(),g(3,"ion-input",3),m("ionFocus",function(){return s(n),l(e.init())})("ionBlur",function(){return s(n),l(e.dest())})("ionInput",function(o){return s(n),l(e.filterInput(o,"lng"))})("ngModelChange",function(){return s(n),l(e.applyGPS())}),h("ngModelChange",function(o){return s(n),c(e.lng,o)||(e.lng=o),l(o)}),d()()}i&2&&(p(2),_("ngModel",e.lat),p(),_("ngModel",e.lng))},dependencies:[G,M,v,V],encapsulation:2});var T=a;export{T as a};
