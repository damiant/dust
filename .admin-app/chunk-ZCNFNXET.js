import{a as de}from"./chunk-XCYYAUGI.js";import{a as ce}from"./chunk-WGSGKNEQ.js";import{a as le}from"./chunk-ZDD63VW5.js";import{a as re}from"./chunk-WENQGBHZ.js";import"./chunk-TUKQZ63R.js";import{E as oe,V as se,a as ne,z as ae}from"./chunk-2QPEVPNK.js";import{D as ee,E as ie,e as Z,j as w}from"./chunk-GUYT2OMO.js";import{a as te}from"./chunk-MIGJGGKJ.js";import{$b as $,A as h,B as C,Bc as Y,Ca as l,Da as f,Ga as A,S as a,T as b,Tb as L,Ub as V,Va as E,Vb as N,Wb as R,Y as k,Za as U,aa as _,ea as c,eb as D,fb as B,fc as j,gc as z,ha as d,hc as H,ia as F,ib as O,ic as W,ja as I,jc as q,ka as S,la as n,ma as o,na as m,pa as y,pc as J,qa as x,qc as K,ra as s,rc as Q,tb as G,w as T,xc as X}from"./chunk-6CV35SS5.js";import"./chunk-ATW7DGUS.js";import"./chunk-7KGURMOZ.js";import"./chunk-UXWCR2YA.js";import"./chunk-QYFQMV2H.js";import"./chunk-ORVKXEJA.js";import"./chunk-KBMMZLX2.js";import"./chunk-5J6JP6Q2.js";import"./chunk-4U6PRYVA.js";import"./chunk-CZ4AHVKD.js";import"./chunk-Z4V4M3ZT.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{a as P,b as M,h as u}from"./chunk-LNJ3S2LQ.js";function pe(i,t){i&1&&(n(0,"ion-button",2),m(1,"ion-icon",5),o())}function _e(i,t){i&1&&m(0,"app-spinner")}function fe(i,t){if(i&1){let e=y();n(0,"ion-toolbar")(1,"ion-searchbar",10),x("ionInput",function(p){h(e);let g=s(2);return C(g.handleSearch(p))}),o(),n(2,"ion-button",11),x("click",function(){h(e);let p=s(2);return C(p.toggleGrid())}),m(3,"ion-icon",12),o()()}if(i&2){let e=s(2);a(),c("debounce",600)("placeholder","Search burns"),a(2),c("name",e.isGrid?"list-outline":"grid-outline")}}function ve(i,t){i&1&&(n(0,"div",8)(1,"h1"),l(2,"Getting Started"),o(),n(3,"h4",13),l(4," As a regional organizer you can click the button below to create a new regional burn. "),o()())}function ge(i,t){if(i&1&&m(0,"app-img",16),i&2){let e=s().$implicit;c("height","100%")("src",e.imageUrl)}}function ue(i,t){if(i&1){let e=y();n(0,"div",14)(1,"ion-card",15),x("click",function(){let p=h(e).$implicit,g=s(3);return C(g.open("/"+p.vanity))}),_(2,ge,1,2,"app-img",16),n(3,"ion-card-content",17)(4,"h1"),l(5),o()()(),n(6,"ion-text",18),l(7),o()()}if(i&2){let e=t.$implicit;a(2),d(e.imageUrl?2:-1),a(3),f(e.name),a(2),f(e.name)}}function he(i,t){if(i&1&&I(0,ue,8,3,"div",14,F),i&2){let e=s(2);S(e.festivals)}}function Ce(i,t){i&1&&(n(0,"p"),l(1,"Dates are not known"),o())}function xe(i,t){if(i&1&&(n(0,"p"),l(1),o()),i&2){let e=s().$implicit;a(),A(" ",e.start," - ",e.end," (in ",e.daysUntil," days) ")}}function ye(i,t){if(i&1){let e=y();n(0,"ion-item",20),x("click",function(){let p=h(e).$implicit,g=s(3);return C(g.open("/"+p.vanity))}),m(1,"app-img",21),n(2,"ion-label")(3,"span"),l(4),o(),_(5,Ce,2,0,"p")(6,xe,2,3,"p"),o(),n(7,"ion-note",1),l(8),o(),n(9,"ion-note",1),l(10),o()()}if(i&2){let e=t.$implicit,r=s(3);c("ngClass",r.classFor(e)),a(),c("width","45px")("height","45px")("src",e.imageUrl),a(3),f(e.name),a(),d(e.unknown_dates?5:6),a(3),f(e.note),a(2),f(e.active?"In Dust":"Hidden")}}function we(i,t){if(i&1&&(n(0,"div",9)(1,"ion-card")(2,"ion-list"),I(3,ye,11,8,"ion-item",19,F),o()()()),i&2){let e=s(2);c("ngClass",e.festivals.length>0?"":"pad-vertical"),a(3),S(e.festivals)}}function be(i,t){if(i&1&&(_(0,fe,4,3,"ion-toolbar"),n(1,"div",6)(2,"div",7),_(3,ve,5,0,"div",8)(4,he,2,0)(5,we,5,1,"div",9),o()()),i&2){let e=s();d(e.festivals.length>1||e.filteredBySearch?0:-1),a(3),d(e.noData?3:-1),a(),d(e.isGrid?4:5)}}function Fe(i,t){i&1&&m(0,"app-footer",4)}var v=class v{constructor(t,e){this.api=t;this.router=e;this.store=T(ee);this.publishing=!1;this.busy=!0;this.addAllowed=!1;this.noData=!1;this.isGrid=!0;this.isNative=te.isNativePlatform();this.filteredBySearch=!1;this.festivals=[];se({add:ne,listOutline:oe,gridOutline:ae})}ngOnInit(){this.isGrid=this.store.get("isFestivalList")!=="false"}ionViewWillEnter(){return u(this,null,function*(){if(!this.api.signedIn()){this.router.navigateByUrl("/auth");return}try{this.busy=!0;let t=sessionStorage.openburn;if(!Z(t)){this.router.navigateByUrl(`/${t}`);return}let e=this.api.getAccessInfo(void 0);this.addAllowed=!1,e.hasAdmin&&(this.addAllowed=!0),!e.hasAdmin&&!e.hasCamps&&!e.hasMusic&&!e.hasArt&&!e.hasCamps&&(this.addAllowed=!0),yield this.getData(),this.sort(),this.noData=this.addAllowed&&this.festivals.length==0}finally{this.busy=!1}})}handleSearch(t){return u(this,null,function*(){let e=t.target.value.toLowerCase();yield this.getData(e),this.filteredBySearch=e.length>0,this.sort()})}getData(t){return u(this,null,function*(){let e=!this.isGrid;this.festivals=this.asFestivalModels(yield this.api.getFestivals(e)),t&&(this.festivals=this.festivals.filter(r=>r.name.toLowerCase().includes(t))),this.festivals.map(r=>{r.imageUrl=this.api.imageURL(r.imageUrl)}),this.addAllowed&&this.festivals.push({imageUrl:"assets/add.svg",daysUntil:0,camps:0,events:0,art:0,placedCamps:0,placedArt:0,imagelessCamps:0,imagelessArt:0,pendingChanges:0,distance:99999,start:"",end:"",note:"",name:"New Regional Burn",description:"",id:void 0,start_time:"",end_time:"",contact:"",admins:"",vanity:"new",timezone:"",active:!0,gpsLat:0,gpsLng:0,camp_registration:!1,event_registration:!1,camp_editing:!1,event_editing:!1,art_editing:!1,map_direction:0,event_types:"",max_event_types:0,pin:void 0,directions:void 0,mastodon_handle:"",inbox_email:"",approved:!1,archived:!1,unknown_dates:!1,region:"",website:"",volunteeripate_identifier:"",volunteeripate_domain:"",rss_feed:""})})}toggleGrid(){return u(this,null,function*(){this.isGrid=!this.isGrid,this.store.set("isFestivalList",this.isGrid.toString()),yield this.getData(),this.sort()})}open(t){if(t=="new"){this.router.navigateByUrl("../new");return}this.api.clearCache(),this.router.navigateByUrl(t)}asFestivalModels(t){return t.map(e=>M(P({},e),{daysUntil:w(e.start_time),start:this.niceFormat(e.start_time),end:this.niceFormat(e.end_time),note:w(e.start_time)>0?w(e.start_time)+" days":e.archived?"Archived":"Past"}))}niceFormat(t){return new Date(t).toLocaleDateString()}classFor(t){return t.active?"":t.daysUntil<0?"past":"hidden"}sort(){this.isGrid?this.filteredBySearch?this.festivals.sort((t,e)=>t.name.localeCompare(e.name)):(console.log(this.isGrid,this.festivals),this.festivals.sort((t,e)=>t.distance-e.distance)):this.festivals.sort((t,e)=>new Date(t.start_time)>new Date(e.start_time)?-1:1)}};v.\u0275fac=function(e){return new(e||v)(b(ie),b(D))},v.\u0275cmp=k({type:v,selectors:[["app-festivals"]],decls:11,vars:4,consts:[["color","primary"],["slot","end"],["routerLink","../new"],[3,"fullscreen"],["title","New Regional Burn","routeTo","../new"],["name","add"],[1,"large-border"],[1,"container"],[2,"display","flex","align-items","center","flex-direction","column","justify-content","center","height","70vh"],[1,"ion-text-center",3,"ngClass"],["mode","ios","search-icon","none","show-clear-button","always",3,"ionInput","debounce","placeholder"],["color","dark","fill","clear","slot","end",3,"click"],[3,"name"],[1,"ion-padding","ion-text-center"],[1,"ion-text-center","ion-padding"],["color","light",1,"card",3,"click"],[3,"height","src"],[1,"xcenter"],["color","medium"],[1,"clickable","hoverable",3,"ngClass"],[1,"clickable","hoverable",3,"click","ngClass"],[2,"min-width","45px",3,"width","height","src"]],template:function(e,r){e&1&&(n(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),l(3,"dust"),o(),n(4,"ion-buttons",1),_(5,pe,2,0,"ion-button",2),m(6,"app-side"),o()()(),n(7,"ion-content",3),_(8,_e,1,0,"app-spinner")(9,be,6,3)(10,Fe,1,0,"app-footer",4),o()),e&2&&(a(5),d(r.isNative?-1:5),a(2),c("fullscreen",!0),a(),d(r.busy?8:9),a(2),d(r.addAllowed?10:-1))},dependencies:[Y,H,q,z,W,J,U,E,ce,re,le,G,O,B,j,Q,K,V,L,$,X,N,R,de],styles:[".container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;flex-wrap:wrap}.card[_ngcontent-%COMP%]{min-width:300px;height:300px;border-radius:10px;flex-basis:40%;cursor:pointer}.hoverable[_ngcontent-%COMP%]:hover{--background: var(--ion-color-light)}.xcenter[_ngcontent-%COMP%]{text-align:center;display:flex;justify-content:center;align-items:center;height:300px}app-img[_ngcontent-%COMP%]{--border-radius: 5px;padding-right:1rem;width:60px}ion-item[_ngcontent-%COMP%]{width:600px;max-width:100vw}.hidden[_ngcontent-%COMP%]{opacity:.5}.past[_ngcontent-%COMP%]{opacity:.75}app-footer[_ngcontent-%COMP%]{--footer-width: 130px}"]});var me=v;export{me as FestivalsPage};
